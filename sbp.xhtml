<?xml version="1.0"?>
<!-- CPSA 3.6.6 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Session Binding Protocol (SBP)</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(herald &quot;Session Binding Protocol (SBP)&quot;)
(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;All input read from sbp.lsp&quot;)</pre>

<p id="t0">Tree 0.</p>

<div>
 <svg
  class='diagram' width='279.600pt' height='154.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.600 154.920' font-size='12.000'>
  <text
   x='239.640' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k5&quot;, &quot;_self&quot;)'>5</text>
  <line
   x1='189.720' y1='77.460' x2='239.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  <line
   x1='189.720' y1='77.460' x2='239.640' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  <line
   x1='139.800' y1='77.460' x2='189.720' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k2&quot;, &quot;_self&quot;)'>2</text>
  <line
   x1='89.880' y1='77.460' x2='139.800' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k1&quot;, &quot;_self&quot;)'>1</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol sbp basic
  (defrole client
    (vars (answer cookie tlskey sskey data))
    (trace (recv (enc &quot;response&quot; (enc cookie sskey) tlskey))
      (send (enc cookie sskey))
      (send (enc &quot;request&quot; (enc cookie sskey) tlskey))
      (recv (enc &quot;sensitive&quot; answer (enc cookie sskey) tlskey))))
  (defrole proxy
    (vars (answer cookie tlskey sskey data))
    (trace (send (enc &quot;response&quot; (enc cookie sskey) tlskey))
      (recv (enc &quot;request&quot; (enc cookie sskey) tlskey))
      (send (enc &quot;sensitive&quot; answer (enc cookie sskey) tlskey)))
    (non-orig sskey)
    (uniq-gen answer cookie)))</pre>

<p id="k0">Item <a href="#t0">0</a>, Child: <a href="#k1">1</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>answer</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <g><title>answer</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;sensitive&quot; answer (enc cookie-0 sskey-0) tlskey)</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; (enc cookie-0 sskey-0) tlskey)</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;response&quot; (enc cookie-0 sskey-0) tlskey)</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;sensitive&quot; answer (enc cookie sskey) tlskey)</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc &quot;request&quot; (enc cookie sskey) tlskey)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc cookie sskey)</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc &quot;response&quot; (enc cookie sskey) tlskey)</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((answer answer) (cookie cookie-0) (tlskey tlskey) (sskey sskey-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((answer answer) (cookie cookie) (tlskey tlskey) (sskey sskey))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>sbp 0</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (answer tlskey cookie sskey cookie-0 sskey-0 data))
  (defstrand client 4 (answer answer) (cookie cookie) (tlskey tlskey)
    (sskey sskey))
  (defstrand proxy 3 (answer answer) (cookie cookie-0) (tlskey tlskey)
    (sskey sskey-0))
  (deflistener answer)
  (non-orig sskey-0)
  (pen-non-orig tlskey)
  (uniq-gen answer cookie-0)
  (label 0)
  (unrealized (0 0) (0 3) (1 1) (2 0))
  (preskeleton)
  (origs)
  (comment &quot;Not a skeleton&quot;))</pre>

<p id="k1">Item <a href="#t0">1</a>, Parent: <a href="#k0">0</a>, Child: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>answer</title><circle cx='239.880' cy='339.960' r='6.000'/>
   </g>
  <g><title>answer</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.340 300.660 44.759 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;sensitive&quot; answer (enc cookie-0 sskey-0) tlskey)</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; (enc cookie-0 sskey-0) tlskey)</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;response&quot; (enc cookie-0 sskey-0) tlskey)</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;sensitive&quot; answer (enc cookie sskey) tlskey)</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc &quot;request&quot; (enc cookie sskey) tlskey)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc cookie sskey)</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc &quot;response&quot; (enc cookie sskey) tlskey)</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((answer answer) (cookie cookie-0) (tlskey tlskey) (sskey sskey-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((answer answer) (cookie cookie) (tlskey tlskey) (sskey sskey))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>sbp 1</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (answer tlskey cookie sskey cookie-0 sskey-0 data))
  (defstrand client 4 (answer answer) (cookie cookie) (tlskey tlskey)
    (sskey sskey))
  (defstrand proxy 3 (answer answer) (cookie cookie-0) (tlskey tlskey)
    (sskey sskey-0))
  (deflistener answer)
  (precedes ((1 2) (0 3)) ((1 2) (2 0)))
  (non-orig sskey-0)
  (pen-non-orig tlskey)
  (uniq-gen answer cookie-0)
  (label 1)
  (parent 0)
  (unrealized (0 0) (0 3) (1 1) (2 0))
  (origs)
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k2">Item <a href="#t0">2</a>, Parent: <a href="#k1">1</a>, Child: <a href="#k3">3</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.260 225.660 244.679 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>tlskey</title><circle cx='339.840' cy='189.960' r='6.000'/>
   </g>
  <g><title>tlskey</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <g><title>answer</title><circle cx='239.880' cy='339.960' r='6.000'/>
   </g>
  <g><title>answer</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.340 300.660 44.759 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;sensitive&quot; answer (enc cookie-0 sskey-0) tlskey)</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; (enc cookie-0 sskey-0) tlskey)</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;response&quot; (enc cookie-0 sskey-0) tlskey)</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;sensitive&quot; answer (enc cookie sskey) tlskey)</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc &quot;request&quot; (enc cookie sskey) tlskey)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc cookie sskey)</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc &quot;response&quot; (enc cookie sskey) tlskey)</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((answer answer) (cookie cookie-0) (tlskey tlskey) (sskey sskey-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((answer answer) (cookie cookie) (tlskey tlskey) (sskey sskey))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>sbp 2</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (answer tlskey cookie sskey cookie-0 sskey-0 data))
  (defstrand client 4 (answer answer) (cookie cookie) (tlskey tlskey)
    (sskey sskey))
  (defstrand proxy 3 (answer answer) (cookie cookie-0) (tlskey tlskey)
    (sskey sskey-0))
  (deflistener answer)
  (deflistener tlskey)
  (precedes ((1 2) (0 3)) ((1 2) (2 0)) ((3 1) (2 0)))
  (non-orig sskey-0)
  (pen-non-orig tlskey)
  (uniq-gen answer cookie-0)
  (operation nonce-test (added-listener tlskey) answer (2 0)
    (enc &quot;sensitive&quot; answer (enc cookie-0 sskey-0) tlskey))
  (label 2)
  (parent 1)
  (unrealized (0 0) (0 3) (1 1) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k3">Item <a href="#t0">3</a>, Parent: <a href="#k2">2</a>, Children: <a href="#k4">4</a> <a href="#k5">5</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.260 225.660 244.679 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cookie-0</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cookie-0</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <g><title>answer</title><circle cx='239.880' cy='339.960' r='6.000'/>
   </g>
  <g><title>answer</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.340 300.660 44.759 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;sensitive&quot; answer (enc cookie-0 sskey-0) cookie-0)</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; (enc cookie-0 sskey-0) cookie-0)</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;response&quot; (enc cookie-0 sskey-0) cookie-0)</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;sensitive&quot; answer (enc cookie sskey) cookie-0)</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; (enc cookie sskey) cookie-0)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc cookie sskey)</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;response&quot; (enc cookie sskey) cookie-0)</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((answer answer) (cookie cookie-0) (tlskey cookie-0) (sskey sskey-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((answer answer) (cookie cookie) (tlskey cookie-0) (sskey sskey))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>sbp 3</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (answer cookie sskey cookie-0 sskey-0 data))
  (defstrand client 4 (answer answer) (cookie cookie) (tlskey cookie-0)
    (sskey sskey))
  (defstrand proxy 3 (answer answer) (cookie cookie-0) (tlskey cookie-0)
    (sskey sskey-0))
  (deflistener answer)
  (deflistener cookie-0)
  (precedes ((1 0) (0 0)) ((1 0) (3 0)) ((1 2) (0 3)) ((1 2) (2 0))
    ((3 1) (2 0)))
  (non-orig sskey-0)
  (pen-non-orig cookie-0)
  (uniq-gen answer cookie-0)
  (operation nonce-test (displaced 4 1 proxy 1) tlskey (3 0))
  (label 3)
  (parent 2)
  (unrealized (0 0) (0 3) (1 1) (3 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k4">Item <a href="#t0">4</a>, Parent: <a href="#k3">3</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cookie</title><circle cx='339.840' cy='264.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>answer</title><circle cx='239.880' cy='339.960' r='6.000'/>
   </g>
  <g><title>answer</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.340 300.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;sensitive&quot; answer (enc cookie sskey) cookie)</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc &quot;request&quot; (enc cookie sskey) cookie)</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc &quot;response&quot; (enc cookie sskey) cookie)</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;sensitive&quot; answer (enc cookie sskey) cookie)</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc &quot;request&quot; (enc cookie sskey) cookie)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc cookie sskey)</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc &quot;response&quot; (enc cookie sskey) cookie)</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((answer answer) (cookie cookie) (tlskey cookie) (sskey sskey))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((answer answer) (cookie cookie) (tlskey cookie) (sskey sskey))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>sbp 4</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (answer cookie sskey data))
  (defstrand client 4 (answer answer) (cookie cookie) (tlskey cookie)
    (sskey sskey))
  (defstrand proxy 3 (answer answer) (cookie cookie) (tlskey cookie)
    (sskey sskey))
  (deflistener answer)
  (deflistener cookie)
  (precedes ((0 1) (3 0)) ((1 0) (0 0)) ((1 2) (0 3)) ((1 2) (2 0))
    ((3 1) (2 0)))
  (non-orig sskey)
  (pen-non-orig cookie)
  (uniq-gen answer cookie)
  (operation nonce-test (displaced 4 0 client 2) cookie-0 (3 0)
    (enc &quot;response&quot; (enc cookie-0 sskey-0) cookie-0))
  (label 4)
  (parent 3)
  (unrealized (1 1) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k5">Item <a href="#t0">5</a>, Parent: <a href="#k3">3</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc cookie-0 sskey-0)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;response&quot; (enc cookie-0 sskey-0) cookie-0)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cookie-0</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>cookie-0</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>answer</title><circle cx='239.880' cy='339.960' r='6.000'/>
   </g>
  <g><title>answer</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.340 300.660 44.759 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;sensitive&quot; answer (enc cookie-0 sskey-0) cookie-0)</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; (enc cookie-0 sskey-0) cookie-0)</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;response&quot; (enc cookie-0 sskey-0) cookie-0)</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;sensitive&quot; answer (enc cookie sskey) cookie-0)</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; (enc cookie sskey) cookie-0)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc cookie sskey)</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;response&quot; (enc cookie sskey) cookie-0)</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (tlskey cookie-0) (sskey sskey-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((answer answer) (cookie cookie-0) (tlskey cookie-0) (sskey sskey-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((answer answer) (cookie cookie) (tlskey cookie-0) (sskey sskey))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>sbp 5</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (answer cookie sskey cookie-0 sskey-0 data))
  (defstrand client 4 (answer answer) (cookie cookie) (tlskey cookie-0)
    (sskey sskey))
  (defstrand proxy 3 (answer answer) (cookie cookie-0) (tlskey cookie-0)
    (sskey sskey-0))
  (deflistener answer)
  (deflistener cookie-0)
  (defstrand client 2 (cookie cookie-0) (tlskey cookie-0)
    (sskey sskey-0))
  (precedes ((1 0) (0 0)) ((1 0) (4 0)) ((1 2) (0 3)) ((1 2) (2 0))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig sskey-0)
  (pen-non-orig cookie-0)
  (uniq-gen answer cookie-0)
  (operation nonce-test (added-strand client 2) cookie-0 (3 0)
    (enc &quot;response&quot; (enc cookie-0 sskey-0) cookie-0))
  (label 5)
  (parent 3)
  (unrealized (0 0) (0 3) (1 1) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

</body>
</html>
