<?xml version="1.0"?>
<!-- CPSA 3.6.6 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Session Binding Protocol (SBP)</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;Extracted shapes&quot;)
(herald &quot;Session Binding Protocol (SBP)&quot;)
(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;All input read from sbp.lsp&quot;)</pre>

<p id="t0">Tree 0.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 904.920' font-size='12.000'>
  <text
   x='89.880' y='851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k58&quot;, &quot;_self&quot;)'>58</text>
  <line
   x1='39.960' y1='452.460' x2='89.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k57&quot;, &quot;_self&quot;)'>57</text>
  <line
   x1='39.960' y1='452.460' x2='89.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k56&quot;, &quot;_self&quot;)'>56</text>
  <line
   x1='39.960' y1='452.460' x2='89.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k53&quot;, &quot;_self&quot;)'>53</text>
  <line
   x1='39.960' y1='452.460' x2='89.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k52&quot;, &quot;_self&quot;)'>52</text>
  <line
   x1='39.960' y1='452.460' x2='89.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k51&quot;, &quot;_self&quot;)'>51</text>
  <line
   x1='39.960' y1='452.460' x2='89.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k44&quot;, &quot;_self&quot;)'>44</text>
  <line
   x1='39.960' y1='452.460' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k43&quot;, &quot;_self&quot;)'>43</text>
  <line
   x1='39.960' y1='452.460' x2='89.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k39&quot;, &quot;_self&quot;)'>39</text>
  <line
   x1='39.960' y1='452.460' x2='89.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k38&quot;, &quot;_self&quot;)'>38</text>
  <line
   x1='39.960' y1='452.460' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k28&quot;, &quot;_self&quot;)'>28</text>
  <line
   x1='39.960' y1='452.460' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k27&quot;, &quot;_self&quot;)'>27</text>
  <line
   x1='39.960' y1='452.460' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='438.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol sbp basic
  (defrole client
    (vars (challenge id secret request answer cookie syskey data)
      (proxy name))
    (trace (send challenge) (recv id) (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (defrole proxy
    (vars (challenge id secret request answer cookie syskey data)
      (proxy name))
    (trace (recv challenge) (send id) (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer cookie))
      (send
        (cat answer
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (defrole server
    (vars (request answer cookie data))
    (trace (tran request (cat answer cookie)))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Children: <a href="#k27">27</a> <a href="#k28">28</a> <a href="#k38">38</a> <a href="#k39">39</a> <a href="#k43">43</a> <a href="#k44">44</a> <a href="#k51">51</a> <a href="#k52">52</a> <a href="#k53">53</a> <a href="#k56">56</a> <a href="#k57">57</a> <a href="#k58">58</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>sbp 0</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (challenge secret id syskey request answer cookie data)
    (proxy name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (answer answer) (cookie cookie) (syskey syskey)
    (proxy proxy))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge secret)
  (label 0)
  (unrealized (0 4) (0 6))
  (origs (challenge (0 0)) (secret (0 2)))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k27">Item <a href="#t0">27</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 192.300 825.660 144.719 861.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 186.900 789.960 233.880 789.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 88.722 224.718 137.484 334.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>sbp 27 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars (id syskey request answer request-0 answer-0 cookie data)
    (proxy proxy-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (answer answer) (cookie cookie) (syskey syskey)
    (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret request)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 5) (1 2)) ((1 6) (2 0)) ((1 8) (0 6))
    ((2 0) (1 7)))
  (leadsto ((1 6) (2 0)) ((2 0) (1 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig id request)
  (operation state-passing-test (displaced 3 1 proxy 7) request-1 (2 0))
  (label 27)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k28">Item <a href="#t0">28</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id-0))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='339.840' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 190.848 712.114 141.817 859.268'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 88.722 224.718 137.484 334.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret) (request request-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 28 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request answer request-0 answer-0 cookie challenge id-0
      secret request-1 data) (proxy proxy-0 proxy-1 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (answer answer) (cookie cookie) (syskey syskey)
    (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret request)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy-1))
  (precedes ((0 0) (1 0)) ((0 5) (1 2)) ((1 8) (0 6)) ((2 0) (1 7))
    ((3 6) (2 0)))
  (leadsto ((2 0) (1 7)) ((3 6) (2 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig id request)
  (operation state-passing-test (added-strand proxy 7) request-1 (2 0))
  (label 28)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k38">Item <a href="#t0">38</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 564.960 Q 192.300 600.660 144.719 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>sbp 38 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars (secret id syskey request answer request-0 answer-0 cookie data)
    (proxy name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (answer answer) (cookie cookie) (syskey syskey)
    (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret secret)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 6) (2 0))
    ((1 8) (0 6)) ((2 0) (1 7)))
  (leadsto ((1 6) (2 0)) ((2 0) (1 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 3 1 proxy 7) request-1 (2 0))
  (label 38)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k39">Item <a href="#t0">39</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret-0 challenge id-0))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='339.840' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.300 600.660 144.719 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret-0) (request request-1) (proxy proxy-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 39 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request answer request-0 answer-0 cookie challenge
      id-0 secret-0 request-1 data) (proxy proxy-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (answer answer) (cookie cookie) (syskey syskey)
    (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret secret)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 8) (0 6))
    ((2 0) (1 7)) ((3 6) (2 0)))
  (leadsto ((2 0) (1 7)) ((3 6) (2 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand proxy 7) request-1 (2 0))
  (label 39)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k43">Item <a href="#t0">43</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 564.960 Q 192.300 600.660 144.719 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.604 487.464 43.287 559.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>sbp 43 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request answer request-0 answer-0 cookie
      data) (proxy name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (answer answer) (cookie cookie) (syskey syskey)
    (proxy proxy))
  (defstrand proxy 9 (challenge challenge) (id id) (secret secret)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 4) (0 4))
    ((1 6) (2 0)) ((1 8) (0 6)) ((2 0) (1 7)))
  (leadsto ((1 6) (2 0)) ((2 0) (1 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 3 1 proxy 7) request-1 (2 0))
  (label 43)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k44">Item <a href="#t0">44</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='339.840' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.300 600.660 144.719 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.604 487.464 43.287 559.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 44 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request answer request-0 answer-0 cookie
      challenge-0 id-0 secret-0 request-1 data) (proxy proxy-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (answer answer) (cookie cookie) (syskey syskey)
    (proxy proxy))
  (defstrand proxy 9 (challenge challenge) (id id) (secret secret)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 4) (0 4))
    ((1 8) (0 6)) ((2 0) (1 7)) ((3 6) (2 0)))
  (leadsto ((2 0) (1 7)) ((3 6) (2 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 7) request-1 (2 0))
  (label 44)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k51">Item <a href="#t0">51</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 190.848 712.114 141.817 859.268'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>request</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>secret</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 88.722 224.718 137.484 334.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (proxy proxy-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request secret) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 51 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey answer request answer-0 cookie challenge id secret request-0
      data) (proxy proxy-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (answer answer) (cookie cookie) (syskey syskey)
    (proxy proxy-0))
  (defstrand proxy 9 (challenge challenge) (id id) (secret secret)
    (request request) (answer answer-0) (cookie cookie) (syskey syskey)
    (proxy proxy))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy-0))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 2) (3 2)) ((0 3) (3 3))
    ((0 5) (1 2)) ((1 8) (0 6)) ((2 0) (1 7)) ((3 4) (0 4))
    ((3 6) (2 0)))
  (leadsto ((2 0) (1 7)) ((3 6) (2 0)))
  (non-orig syskey (privk proxy-0))
  (pen-non-orig (pubk proxy-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 4 proxy 7) request-0 (3 0))
  (label 51)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (request secret) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k52">Item <a href="#t0">52</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='789.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 292.260 825.660 244.679 861.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 286.860 789.960 333.840 789.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 137.927 187.717 235.895 335.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 52 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request answer request-0 answer-0 cookie data)
    (proxy proxy-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (answer answer) (cookie cookie) (syskey syskey)
    (proxy proxy))
  (defstrand proxy 5 (challenge challenge) (id id) (secret request)
    (proxy proxy))
  (defstrand proxy 9 (challenge challenge) (id id) (secret request)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 2) (1 2)) ((0 3) (1 3))
    ((0 5) (2 2)) ((1 4) (0 4)) ((2 6) (3 0)) ((2 8) (0 6))
    ((3 0) (2 7)))
  (leadsto ((2 6) (3 0)) ((3 0) (2 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 4 2 proxy 7) request-1 (3 0))
  (label 52)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k53">Item <a href="#t0">53</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 564.960 Q 392.820 564.960 345.840 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='439.800' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 290.808 712.114 241.777 859.268'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 137.927 187.717 235.895 335.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (proxy proxy-1))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 53 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request answer request-0 answer-0 cookie
      challenge-0 id-0 secret request-1 data)
    (proxy proxy-0 proxy-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (answer answer) (cookie cookie) (syskey syskey)
    (proxy proxy))
  (defstrand proxy 5 (challenge challenge) (id id) (secret request)
    (proxy proxy))
  (defstrand proxy 9 (challenge challenge) (id id) (secret request)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-1))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 2) (1 2)) ((0 3) (1 3))
    ((0 5) (2 2)) ((1 4) (0 4)) ((2 8) (0 6)) ((3 0) (2 7))
    ((4 6) (3 0)))
  (leadsto ((3 0) (2 7)) ((4 6) (3 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand proxy 7) request-1 (3 0))
  (label 53)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k56">Item <a href="#t0">56</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.583 451.118 45.326 562.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.300 600.660 144.719 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (proxy proxy))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 56 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request answer request-0 answer-0 cookie challenge id secret
      request-1 data) (proxy name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (answer answer) (cookie cookie) (syskey syskey)
    (proxy proxy))
  (defstrand proxy 9 (challenge challenge) (id id) (secret secret)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge) (id id) (secret secret)
    (request request-1) (proxy proxy))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 2) (1 2)) ((0 2) (3 2))
    ((0 3) (1 3)) ((0 3) (3 3)) ((1 8) (0 6)) ((2 0) (1 7))
    ((3 4) (0 4)) ((3 6) (2 0)))
  (leadsto ((2 0) (1 7)) ((3 6) (2 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 4 proxy 7) request-1 (3 0))
  (label 56)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k57">Item <a href="#t0">57</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 292.260 600.660 244.679 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 286.860 564.960 333.840 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.604 487.464 43.287 559.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 57 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request answer request-0 answer-0 cookie
      data) (proxy name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (answer answer) (cookie cookie) (syskey syskey)
    (proxy proxy))
  (defstrand proxy 5 (challenge challenge) (id id) (secret secret)
    (proxy proxy))
  (defstrand proxy 9 (challenge challenge) (id id) (secret secret)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 2) (1 2)) ((0 2) (2 2))
    ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 6) (3 0))
    ((2 8) (0 6)) ((3 0) (2 7)))
  (leadsto ((2 6) (3 0)) ((3 0) (2 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 4 2 proxy 7) request-1 (3 0))
  (label 57)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k58">Item <a href="#t0">58</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 564.960 Q 392.820 564.960 345.840 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='439.800' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.260 600.660 244.679 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.604 487.464 43.287 559.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 58 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request answer request-0 answer-0 cookie
      challenge-0 id-0 secret-0 request-1 data) (proxy proxy-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (answer answer) (cookie cookie) (syskey syskey)
    (proxy proxy))
  (defstrand proxy 5 (challenge challenge) (id id) (secret secret)
    (proxy proxy))
  (defstrand proxy 9 (challenge challenge) (id id) (secret secret)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 2) (1 2)) ((0 2) (2 2))
    ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 8) (0 6))
    ((3 0) (2 7)) ((4 6) (3 0)))
  (leadsto ((3 0) (2 7)) ((4 6) (3 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 7) request-1 (3 0))
  (label 58)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

</body>
</html>
