<?xml version="1.0"?>
<!-- CPSA 3.6.6 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Session Binding Protocol (SBP)</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;Extracted shapes&quot;)
(herald &quot;Session Binding Protocol (SBP)&quot;)
(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;All input read from sbp.lsp&quot;)</pre>

<p id="t0">Tree 0.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='1804.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 1804.920' font-size='12.000'>
  <text
   x='89.880' y='1751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k382&quot;, &quot;_self&quot;)'>382</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='1764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k381&quot;, &quot;_self&quot;)'>381</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k380&quot;, &quot;_self&quot;)'>380</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k366&quot;, &quot;_self&quot;)'>366</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k365&quot;, &quot;_self&quot;)'>365</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k364&quot;, &quot;_self&quot;)'>364</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k284&quot;, &quot;_self&quot;)'>284</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k280&quot;, &quot;_self&quot;)'>280</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k273&quot;, &quot;_self&quot;)'>273</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k272&quot;, &quot;_self&quot;)'>272</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k271&quot;, &quot;_self&quot;)'>271</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k270&quot;, &quot;_self&quot;)'>270</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k257&quot;, &quot;_self&quot;)'>257</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k256&quot;, &quot;_self&quot;)'>256</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k255&quot;, &quot;_self&quot;)'>255</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k145&quot;, &quot;_self&quot;)'>145</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k144&quot;, &quot;_self&quot;)'>144</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k118&quot;, &quot;_self&quot;)'>118</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k117&quot;, &quot;_self&quot;)'>117</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k116&quot;, &quot;_self&quot;)'>116</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k108&quot;, &quot;_self&quot;)'>108</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k107&quot;, &quot;_self&quot;)'>107</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k55&quot;, &quot;_self&quot;)'>55</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k54&quot;, &quot;_self&quot;)'>54</text>
  <line
   x1='39.960' y1='902.460' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='888.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol sbp basic
  (defrole client
    (vars
      (challenge id secret request request2 answer answer2 cookie syskey
        data) (proxy name))
    (trace (send challenge) (recv id) (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer
          (enc cookie (hash syskey (hash secret challenge id)))))
      (send
        (cat request2
          (enc cookie (hash syskey (hash secret challenge id)))))
      (recv answer2)))
  (defrole proxy
    (vars
      (challenge id secret request request2 answer answer2 cookie syskey
        data) (proxy name))
    (trace (recv challenge) (send id) (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer cookie))
      (send
        (cat answer
          (enc cookie (hash syskey (hash secret challenge id)))))
      (recv
        (cat request2
          (enc cookie (hash syskey (hash secret challenge id)))))
      (init (cat request2 cookie)) (obsv answer2) (send answer2)))
  (defrole server
    (vars (request request2 answer answer2 cookie data))
    (trace (tran request (cat answer cookie))
      (tran (cat request2 cookie) answer2))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Children: <a href="#k54">54</a> <a href="#k55">55</a> <a href="#k107">107</a> <a href="#k108">108</a> <a href="#k116">116</a> <a href="#k117">117</a> <a href="#k118">118</a> <a href="#k144">144</a> <a href="#k145">145</a> <a href="#k255">255</a> <a href="#k256">256</a> <a href="#k257">257</a> <a href="#k270">270</a> <a href="#k271">271</a> <a href="#k272">272</a> <a href="#k273">273</a> <a href="#k280">280</a> <a href="#k284">284</a> <a href="#k364">364</a> <a href="#k365">365</a> <a href="#k366">366</a> <a href="#k380">380</a> <a href="#k381">381</a> <a href="#k382">382</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>sbp 0</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request request2 answer answer2 cookie
      data) (proxy name))
  (defstrand client 9 (challenge challenge) (id id) (secret secret)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge secret)
  (label 0)
  (unrealized (0 4) (0 6))
  (origs (challenge (0 0)) (secret (0 2)))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k54">Item <a href="#t0">54</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 192.300 825.660 144.719 861.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 186.900 789.960 233.880 789.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 88.722 224.718 137.484 334.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>sbp 54 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request request2 answer answer2 request-0 answer-0 cookie
      data) (proxy proxy-0 name))
  (defstrand client 9 (challenge id) (id id) (secret request)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret request)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 5) (1 2)) ((1 6) (2 0)) ((1 8) (0 6))
    ((2 0) (1 7)))
  (leadsto ((1 6) (2 0)) ((2 0) (1 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig id request)
  (operation state-passing-test (displaced 3 1 proxy 7) request-1 (2 0))
  (label 54)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k55">Item <a href="#t0">55</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id-0))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='339.840' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 190.848 712.114 141.817 859.268'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 88.722 224.718 137.484 334.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret) (request request-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 55 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request request2 answer answer2 request-0 answer-0 cookie
      challenge id-0 secret request-1 data)
    (proxy proxy-0 proxy-1 name))
  (defstrand client 9 (challenge id) (id id) (secret request)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret request)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy-1))
  (precedes ((0 0) (1 0)) ((0 5) (1 2)) ((1 8) (0 6)) ((2 0) (1 7))
    ((3 6) (2 0)))
  (leadsto ((2 0) (1 7)) ((3 6) (2 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig id request)
  (operation state-passing-test (added-strand proxy 7) request-1 (2 0))
  (label 55)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k107">Item <a href="#t0">107</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 564.960 Q 192.300 600.660 144.719 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>sbp 107 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request request2 answer answer2 request-0 answer-0
      cookie data) (proxy name))
  (defstrand client 9 (challenge id) (id id) (secret secret)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret secret)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 6) (2 0))
    ((1 8) (0 6)) ((2 0) (1 7)))
  (leadsto ((1 6) (2 0)) ((2 0) (1 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 3 1 proxy 7) request-1 (2 0))
  (label 107)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k108">Item <a href="#t0">108</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret-0 challenge id-0))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='339.840' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.300 600.660 144.719 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret-0) (request request-1) (proxy proxy-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 108 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request request2 answer answer2 request-0 answer-0
      cookie challenge id-0 secret-0 request-1 data)
    (proxy proxy-0 name))
  (defstrand client 9 (challenge id) (id id) (secret secret)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret secret)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 8) (0 6))
    ((2 0) (1 7)) ((3 6) (2 0)))
  (leadsto ((2 0) (1 7)) ((3 6) (2 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand proxy 7) request-1 (2 0))
  (label 108)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k116">Item <a href="#t0">116</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='789.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 291.524 717.456 243.207 644.953'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 192.900 864.960 145.920 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey-0 (hash secret challenge id-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey-0 (hash secret challenge id-0))))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge id-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 236.880 752.460 333.840 789.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 88.722 224.718 137.484 334.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret) (request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-1))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 116 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request request2 answer answer2 request-0 challenge id-0
      secret request-1 request2-0 syskey-0 answer-0 cookie data)
    (proxy proxy-0 proxy-1 name))
  (defstrand client 9 (challenge id) (id id) (secret request)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret request)
    (request request-0) (answer request2-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand proxy 11 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (request2 request2-0) (answer answer-0)
    (cookie cookie) (syskey syskey-0) (proxy proxy-1))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 5) (1 2)) ((1 6) (3 0)) ((1 8) (0 6))
    ((2 10) (1 7)) ((3 0) (2 7)))
  (leadsto ((1 6) (3 0)) ((2 10) (1 7)) ((3 0) (2 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig id request)
  (operation state-passing-test (displaced 4 1 proxy 7) request-2 (3 0))
  (label 116)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k117">Item <a href="#t0">117</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 292.260 600.660 244.679 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 192.900 864.960 145.920 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey-0 (hash secret challenge id-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey-0 (hash secret challenge id-0))))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 286.860 564.960 333.840 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge id-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 88.722 224.718 137.484 334.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret) (request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-1))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 117 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request request2 answer answer2 request-0 challenge id-0
      secret request-1 request2-0 syskey-0 answer-0 cookie data)
    (proxy proxy-0 proxy-1 name))
  (defstrand client 9 (challenge id) (id id) (secret request)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret request)
    (request request-0) (answer request2-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand proxy 11 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (request2 request2-0) (answer answer-0)
    (cookie cookie) (syskey syskey-0) (proxy proxy-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 5) (1 2)) ((1 8) (0 6)) ((2 6) (3 0))
    ((2 10) (1 7)) ((3 0) (2 7)))
  (leadsto ((2 6) (3 0)) ((2 10) (1 7)) ((3 0) (2 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig id request)
  (operation state-passing-test (displaced 4 2 proxy 7) request-2 (3 0))
  (label 117)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k118">Item <a href="#t0">118</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 564.960 Q 392.820 564.960 345.840 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-1))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-0 id-1))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-2))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>id-1</title><circle cx='439.800' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.260 600.660 244.679 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 192.900 864.960 145.920 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey-0 (hash secret challenge id-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey-0 (hash secret challenge id-0))))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge id-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 88.722 224.718 137.484 334.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-1) (secret secret-0) (request request-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret) (request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-1))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 118 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request request2 answer answer2 request-0 challenge id-0
      secret request-1 request2-0 syskey-0 answer-0 cookie challenge-0
      id-1 secret-0 request-2 data)
    (proxy proxy-0 proxy-1 proxy-2 name))
  (defstrand client 9 (challenge id) (id id) (secret request)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret request)
    (request request-0) (answer request2-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand proxy 11 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (request2 request2-0) (answer answer-0)
    (cookie cookie) (syskey syskey-0) (proxy proxy-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge-0) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-2))
  (precedes ((0 0) (1 0)) ((0 5) (1 2)) ((1 8) (0 6)) ((2 10) (1 7))
    ((3 0) (2 7)) ((4 6) (3 0)))
  (leadsto ((2 10) (1 7)) ((3 0) (2 7)) ((4 6) (3 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig id request)
  (operation state-passing-test (added-strand proxy 7) request-2 (3 0))
  (label 118)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k144">Item <a href="#t0">144</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 564.960 Q 192.300 600.660 144.719 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 186.900 564.960 233.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.604 487.464 43.287 559.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>sbp 144 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request request2 answer answer2
      request-0 answer-0 cookie data) (proxy name))
  (defstrand client 9 (challenge challenge) (id id) (secret secret)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge challenge) (id id) (secret secret)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 4) (0 4))
    ((1 6) (2 0)) ((1 8) (0 6)) ((2 0) (1 7)))
  (leadsto ((1 6) (2 0)) ((2 0) (1 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 3 1 proxy 7) request-1 (2 0))
  (label 144)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k145">Item <a href="#t0">145</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='339.840' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.300 600.660 144.719 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.604 487.464 43.287 559.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='639.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 145 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request request2 answer answer2
      request-0 answer-0 cookie challenge-0 id-0 secret-0 request-1
      data) (proxy proxy-0 name))
  (defstrand client 9 (challenge challenge) (id id) (secret secret)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge challenge) (id id) (secret secret)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 4) (0 4))
    ((1 8) (0 6)) ((2 0) (1 7)) ((3 6) (2 0)))
  (leadsto ((2 0) (1 7)) ((3 6) (2 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 7) request-1 (2 0))
  (label 145)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k255">Item <a href="#t0">255</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 292.260 600.660 244.679 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 192.900 864.960 145.920 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey-0 (hash secret-0 challenge id-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey-0 (hash secret-0 challenge id-0))))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret-0 challenge id-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge id-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 236.880 527.460 333.840 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='864.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret-0) (request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 255 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request request2 answer answer2 request-0
      challenge id-0 secret-0 request-1 request2-0 syskey-0 answer-0
      cookie data) (proxy proxy-0 name))
  (defstrand client 9 (challenge id) (id id) (secret secret)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret secret)
    (request request-0) (answer request2-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand proxy 11 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (request2 request2-0) (answer answer-0)
    (cookie cookie) (syskey syskey-0) (proxy proxy-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 6) (3 0))
    ((1 8) (0 6)) ((2 10) (1 7)) ((3 0) (2 7)))
  (leadsto ((1 6) (3 0)) ((2 10) (1 7)) ((3 0) (2 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 4 1 proxy 7) request-2 (3 0))
  (label 255)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k256">Item <a href="#t0">256</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 292.260 600.660 244.679 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 192.900 864.960 145.920 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey-0 (hash secret-0 challenge id-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey-0 (hash secret-0 challenge id-0))))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 286.860 564.960 333.840 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret-0 challenge id-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge id-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='864.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret-0) (request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 256 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request request2 answer answer2 request-0
      challenge id-0 secret-0 request-1 request2-0 syskey-0 answer-0
      cookie data) (proxy proxy-0 name))
  (defstrand client 9 (challenge id) (id id) (secret secret)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret secret)
    (request request-0) (answer request2-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand proxy 11 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (request2 request2-0) (answer answer-0)
    (cookie cookie) (syskey syskey-0) (proxy proxy-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 8) (0 6))
    ((2 6) (3 0)) ((2 10) (1 7)) ((3 0) (2 7)))
  (leadsto ((2 6) (3 0)) ((2 10) (1 7)) ((3 0) (2 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 4 2 proxy 7) request-2 (3 0))
  (label 256)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k257">Item <a href="#t0">257</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 564.960 Q 392.820 564.960 345.840 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-1 challenge-0 id-1))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-0 id-1))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>id-1</title><circle cx='439.800' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.260 600.660 244.679 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 192.900 864.960 145.920 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey-0 (hash secret-0 challenge id-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey-0 (hash secret-0 challenge id-0))))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret-0 challenge id-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge id-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='864.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-1) (secret secret-1) (request request-2) (proxy proxy-1))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret-0) (request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 257 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request request2 answer answer2 request-0
      challenge id-0 secret-0 request-1 request2-0 syskey-0 answer-0
      cookie challenge-0 id-1 secret-1 request-2 data)
    (proxy proxy-0 proxy-1 name))
  (defstrand client 9 (challenge id) (id id) (secret secret)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret secret)
    (request request-0) (answer request2-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand proxy 11 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (request2 request2-0) (answer answer-0)
    (cookie cookie) (syskey syskey-0) (proxy proxy-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge-0) (id id-1) (secret secret-1)
    (request request-2) (proxy proxy-1))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 8) (0 6))
    ((2 10) (1 7)) ((3 0) (2 7)) ((4 6) (3 0)))
  (leadsto ((2 10) (1 7)) ((3 0) (2 7)) ((4 6) (3 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand proxy 7) request-2 (3 0))
  (label 257)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k270">Item <a href="#t0">270</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1354.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1354.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='789.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 789.960 Q 391.484 717.456 343.167 644.953'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='789.960' r='6.000'/></g>
  <path
   d='M 339.840 864.960 Q 292.860 864.960 245.880 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2-1 (enc cookie (hash syskey-1 (hash secret-0 challenge-0 id-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey-1 (hash secret-0 challenge-0 id-1))))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-0 id-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-2))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id-1</title><circle cx='339.840' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 192.900 1089.960 145.920 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey-0 (hash secret challenge id-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g>
   <title>(cat request2-1 (enc cookie (hash syskey-0 (hash secret challenge id-0))))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge id-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='239.880' cy='414.960' r='6.000'/>
   </g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 1164.960 Q 92.940 1164.960 45.960 1164.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='139.920' cy='1164.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 789.960 Q 286.860 752.460 433.800 789.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 88.722 224.718 137.484 334.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-1) (secret secret-0) (request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (proxy proxy-2))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret) (request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (proxy proxy-1))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 270 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request request2 answer answer2 request-0 challenge id-0
      secret request-1 request2-0 syskey-0 challenge-0 id-1 secret-0
      request-2 request2-1 syskey-1 answer-0 cookie data)
    (proxy proxy-0 proxy-1 proxy-2 name))
  (defstrand client 9 (challenge id) (id id) (secret request)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret request)
    (request request-0) (answer request2-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand proxy 11 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (request2 request2-0) (answer request2-1)
    (cookie cookie) (syskey syskey-0) (proxy proxy-1))
  (defstrand proxy 11 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1) (proxy proxy-2))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 5) (1 2)) ((1 6) (4 0)) ((1 8) (0 6))
    ((2 10) (1 7)) ((3 10) (2 7)) ((4 0) (3 7)))
  (leadsto ((1 6) (4 0)) ((2 10) (1 7)) ((3 10) (2 7)) ((4 0) (3 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig id request)
  (operation state-passing-test (displaced 5 1 proxy 7) request-3 (4 0))
  (label 270)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k271">Item <a href="#t0">271</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1354.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1354.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 564.960 Q 392.220 600.660 344.639 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 864.960 Q 292.860 864.960 245.880 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2-1 (enc cookie (hash syskey-1 (hash secret-0 challenge-0 id-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey-1 (hash secret-0 challenge-0 id-1))))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-0 id-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-2))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id-1</title><circle cx='339.840' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 192.900 1089.960 145.920 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey-0 (hash secret challenge id-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g>
   <title>(cat request2-1 (enc cookie (hash syskey-0 (hash secret challenge id-0))))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 336.840 527.460 433.800 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge id-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1164.960 Q 92.940 1164.960 45.960 1164.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='139.920' cy='1164.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 88.722 449.718 137.484 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-1) (secret secret-0) (request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (proxy proxy-2))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret) (request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (proxy proxy-1))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 271 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request request2 answer answer2 request-0 challenge id-0
      secret request-1 request2-0 syskey-0 challenge-0 id-1 secret-0
      request-2 request2-1 syskey-1 answer-0 cookie data)
    (proxy proxy-0 proxy-1 proxy-2 name))
  (defstrand client 9 (challenge id) (id id) (secret request)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret request)
    (request request-0) (answer request2-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand proxy 11 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (request2 request2-0) (answer request2-1)
    (cookie cookie) (syskey syskey-0) (proxy proxy-1))
  (defstrand proxy 11 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1) (proxy proxy-2))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 5) (1 2)) ((1 8) (0 6)) ((2 6) (4 0))
    ((2 10) (1 7)) ((3 10) (2 7)) ((4 0) (3 7)))
  (leadsto ((2 6) (4 0)) ((2 10) (1 7)) ((3 10) (2 7)) ((4 0) (3 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig id request)
  (operation state-passing-test (displaced 5 2 proxy 7) request-3 (4 0))
  (label 271)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k272">Item <a href="#t0">272</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1354.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1354.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 564.960 Q 392.220 600.660 344.639 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 864.960 Q 292.860 864.960 245.880 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2-1 (enc cookie (hash syskey-1 (hash secret-0 challenge-0 id-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey-1 (hash secret-0 challenge-0 id-1))))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 386.820 564.960 433.800 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-0 id-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-2))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id-1</title><circle cx='339.840' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 192.900 1089.960 145.920 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey-0 (hash secret challenge id-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g>
   <title>(cat request2-1 (enc cookie (hash syskey-0 (hash secret challenge id-0))))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge id-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='239.880' cy='414.960' r='6.000'/>
   </g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 1164.960 Q 92.940 1164.960 45.960 1164.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='139.920' cy='1164.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 88.722 449.718 137.484 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-1) (secret secret-0) (request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (proxy proxy-2))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret) (request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (proxy proxy-1))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 272 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request request2 answer answer2 request-0 challenge id-0
      secret request-1 request2-0 syskey-0 challenge-0 id-1 secret-0
      request-2 request2-1 syskey-1 answer-0 cookie data)
    (proxy proxy-0 proxy-1 proxy-2 name))
  (defstrand client 9 (challenge id) (id id) (secret request)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret request)
    (request request-0) (answer request2-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand proxy 11 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (request2 request2-0) (answer request2-1)
    (cookie cookie) (syskey syskey-0) (proxy proxy-1))
  (defstrand proxy 11 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1) (proxy proxy-2))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 5) (1 2)) ((1 8) (0 6)) ((2 10) (1 7))
    ((3 6) (4 0)) ((3 10) (2 7)) ((4 0) (3 7)))
  (leadsto ((2 10) (1 7)) ((3 6) (4 0)) ((3 10) (2 7)) ((4 0) (3 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig id request)
  (operation state-passing-test (displaced 5 3 proxy 7) request-3 (4 0))
  (label 272)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k273">Item <a href="#t0">273</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='1354.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 1354.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 564.960 Q 492.780 564.960 445.800 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-2))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-2 (hash secret-1 challenge-1 id-2))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-3))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>id-2</title><circle cx='539.760' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 392.220 600.660 344.639 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 864.960 Q 292.860 864.960 245.880 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2-1 (enc cookie (hash syskey-1 (hash secret-0 challenge-0 id-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey-1 (hash secret-0 challenge-0 id-1))))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-1))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-0 id-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-2))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id-1</title><circle cx='339.840' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1089.960 Q 192.900 1089.960 145.920 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey-0 (hash secret challenge id-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g>
   <title>(cat request2-1 (enc cookie (hash syskey-0 (hash secret challenge id-0))))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id-0))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge id-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='239.880' cy='414.960' r='6.000'/>
   </g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 1164.960 Q 92.940 1164.960 45.960 1164.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='139.920' cy='1164.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='39.960' cy='1239.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 88.722 449.718 137.484 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-2) (secret secret-1) (request request-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-1) (secret secret-0) (request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (proxy proxy-2))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret) (request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (proxy proxy-1))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 273 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request request2 answer answer2 request-0 challenge id-0
      secret request-1 request2-0 syskey-0 challenge-0 id-1 secret-0
      request-2 request2-1 syskey-1 answer-0 cookie challenge-1 id-2
      secret-1 request-3 data)
    (proxy proxy-0 proxy-1 proxy-2 proxy-3 name))
  (defstrand client 9 (challenge id) (id id) (secret request)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret request)
    (request request-0) (answer request2-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand proxy 11 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (request2 request2-0) (answer request2-1)
    (cookie cookie) (syskey syskey-0) (proxy proxy-1))
  (defstrand proxy 11 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1) (proxy proxy-2))
  (defstrand server 1 (request request-3) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge-1) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-3))
  (precedes ((0 0) (1 0)) ((0 5) (1 2)) ((1 8) (0 6)) ((2 10) (1 7))
    ((3 10) (2 7)) ((4 0) (3 7)) ((5 6) (4 0)))
  (leadsto ((2 10) (1 7)) ((3 10) (2 7)) ((4 0) (3 7)) ((5 6) (4 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig id request)
  (operation state-passing-test (added-strand proxy 7) request-3 (4 0))
  (label 273)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k280">Item <a href="#t0">280</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='789.960' x2='339.840' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='864.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 864.960 Q 292.860 864.960 245.880 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 192.900 864.960 145.920 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 236.880 752.460 333.840 789.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 88.722 224.718 137.484 334.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 280 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 cookie-0 data) (proxy proxy-0 name))
  (defstrand client 9 (challenge id) (id id) (secret request)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret request)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((0 0) (1 0)) ((0 5) (1 2)) ((1 6) (3 0)) ((1 8) (0 6))
    ((2 0) (1 7)) ((3 1) (2 0)))
  (leadsto ((1 6) (3 0)) ((2 0) (1 7)) ((3 0) (3 1)) ((3 1) (2 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig id request)
  (operation state-passing-test (displaced 4 3 server 1)
    (cat answer-2 cookie-0) (3 1))
  (label 280)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k284">Item <a href="#t0">284</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='639.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 564.960 Q 392.820 564.960 345.840 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id-0))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='439.800' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 292.860 639.960 245.880 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 191.118 749.718 142.356 859.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 88.722 224.718 137.484 334.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret) (request request-1) (proxy proxy-1))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 284 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 challenge id-0 secret request-1 cookie-0 data)
    (proxy proxy-0 proxy-1 name))
  (defstrand client 9 (challenge id) (id id) (secret request)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge id) (id id) (secret request)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 7 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy-1))
  (precedes ((0 0) (1 0)) ((0 5) (1 2)) ((1 8) (0 6)) ((2 0) (1 7))
    ((3 1) (2 0)) ((4 6) (3 0)))
  (leadsto ((2 0) (1 7)) ((3 0) (3 1)) ((3 1) (2 0)) ((4 6) (3 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig id request)
  (operation state-passing-test (displaced 5 3 server 1)
    (cat answer-2 cookie-0) (3 1))
  (label 284)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k364">Item <a href="#t0">364</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 292.260 600.660 244.679 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 192.900 864.960 145.920 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey-0 (hash secret-0 challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey-0 (hash secret-0 challenge-0 id-0))))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 236.880 527.460 333.840 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 90.713 599.561 41.505 784.162'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='864.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 364 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request request2 answer answer2
      request-0 challenge-0 id-0 secret-0 request-1 request2-0 syskey-0
      answer-0 cookie data) (proxy proxy-0 name))
  (defstrand client 9 (challenge challenge) (id id) (secret secret)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge challenge) (id id) (secret secret)
    (request request-0) (answer request2-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand proxy 11 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 4) (0 4))
    ((1 6) (3 0)) ((1 8) (0 6)) ((2 10) (1 7)) ((3 0) (2 7)))
  (leadsto ((1 6) (3 0)) ((2 10) (1 7)) ((3 0) (2 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 4 1 proxy 7) request-2 (3 0))
  (label 364)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k365">Item <a href="#t0">365</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 292.260 600.660 244.679 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 192.900 864.960 145.920 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey-0 (hash secret-0 challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey-0 (hash secret-0 challenge-0 id-0))))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 286.860 564.960 333.840 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 91.604 712.464 43.287 784.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='864.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 365 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request request2 answer answer2
      request-0 challenge-0 id-0 secret-0 request-1 request2-0 syskey-0
      answer-0 cookie data) (proxy proxy-0 name))
  (defstrand client 9 (challenge challenge) (id id) (secret secret)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge challenge) (id id) (secret secret)
    (request request-0) (answer request2-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand proxy 11 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 4) (0 4))
    ((1 8) (0 6)) ((2 6) (3 0)) ((2 10) (1 7)) ((3 0) (2 7)))
  (leadsto ((2 6) (3 0)) ((2 10) (1 7)) ((3 0) (2 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 4 2 proxy 7) request-2 (3 0))
  (label 365)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k366">Item <a href="#t0">366</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 564.960 Q 392.820 564.960 345.840 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>id-1</title><circle cx='439.800' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.260 600.660 244.679 636.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 192.900 864.960 145.920 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey-0 (hash secret-0 challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey-0 (hash secret-0 challenge-0 id-0))))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat request2-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 91.604 712.464 43.287 784.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='864.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-2) (proxy proxy-1))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 366 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request request2 answer answer2
      request-0 challenge-0 id-0 secret-0 request-1 request2-0 syskey-0
      answer-0 cookie challenge-1 id-1 secret-1 request-2 data)
    (proxy proxy-0 proxy-1 name))
  (defstrand client 9 (challenge challenge) (id id) (secret secret)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 9 (challenge challenge) (id id) (secret secret)
    (request request-0) (answer request2-0) (cookie cookie)
    (syskey syskey) (proxy proxy))
  (defstrand proxy 11 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-2) (proxy proxy-1))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 4) (0 4))
    ((1 8) (0 6)) ((2 10) (1 7)) ((3 0) (2 7)) ((4 6) (3 0)))
  (leadsto ((2 10) (1 7)) ((3 0) (2 7)) ((4 6) (3 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 7) request-2 (3 0))
  (label 366)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k380">Item <a href="#t0">380</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 190.848 712.114 141.817 859.268'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 939.960 Q 92.940 939.960 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>request</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>request</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>secret</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 88.722 224.718 137.484 334.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (proxy proxy-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request secret) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 380 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request2 answer answer2 request answer-0 cookie challenge id
      secret request-0 data) (proxy proxy-0 name))
  (defstrand client 9 (challenge challenge) (id id) (secret secret)
    (request secret) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy-0))
  (defstrand proxy 9 (challenge challenge) (id id) (secret secret)
    (request request) (answer answer-0) (cookie cookie) (syskey syskey)
    (proxy proxy))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy-0))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((0 2) (3 2)) ((0 3) (3 3))
    ((0 5) (1 2)) ((1 8) (0 6)) ((2 0) (1 7)) ((3 4) (0 4))
    ((3 6) (2 0)))
  (leadsto ((2 0) (1 7)) ((3 6) (2 0)))
  (non-orig syskey (privk proxy-0))
  (pen-non-orig (pubk proxy-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 4 proxy 7) request-0 (3 0))
  (label 380)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (request secret) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k381">Item <a href="#t0">381</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='789.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 292.260 825.660 244.679 861.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 286.860 789.960 333.840 789.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 137.927 187.717 235.895 335.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 381 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request request2 answer answer2 request-0
      answer-0 cookie data) (proxy proxy-0 name))
  (defstrand client 9 (challenge challenge) (id id) (secret request)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 5 (challenge challenge) (id id) (secret request)
    (proxy proxy))
  (defstrand proxy 9 (challenge challenge) (id id) (secret request)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 2) (1 2)) ((0 3) (1 3))
    ((0 5) (2 2)) ((1 4) (0 4)) ((2 6) (3 0)) ((2 8) (0 6))
    ((3 0) (2 7)))
  (leadsto ((2 6) (3 0)) ((3 0) (2 7)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 4 2 proxy 7) request-1 (3 0))
  (label 381)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k382">Item <a href="#t0">382</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='1129.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 1129.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 564.960 Q 392.820 564.960 345.840 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>id-0</title><circle cx='439.800' cy='189.960' r='6.000'/>
   </g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 290.808 712.114 241.777 859.268'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 142.920 902.460 45.960 939.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>id</title><circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>id</title><circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>answer2</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat request2 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='39.960' cy='1014.960' r='6.000'/></g>
  <g>
   <title>(cat answer (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 114.960 Q 137.927 187.717 235.895 335.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (proxy proxy-1))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 382 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request request2 answer answer2 request-0
      answer-0 cookie challenge-0 id-0 secret request-1 data)
    (proxy proxy-0 proxy-1 name))
  (defstrand client 9 (challenge challenge) (id id) (secret request)
    (request request) (request2 request2) (answer answer)
    (answer2 answer2) (cookie cookie) (syskey syskey) (proxy proxy))
  (defstrand proxy 5 (challenge challenge) (id id) (secret request)
    (proxy proxy))
  (defstrand proxy 9 (challenge challenge) (id id) (secret request)
    (request request-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-1))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((0 2) (1 2)) ((0 3) (1 3))
    ((0 5) (2 2)) ((1 4) (0 4)) ((2 8) (0 6)) ((3 0) (2 7))
    ((4 6) (3 0)))
  (leadsto ((3 0) (2 7)) ((4 6) (3 0)))
  (non-orig syskey (privk proxy))
  (pen-non-orig (pubk proxy))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand proxy 7) request-1 (3 0))
  (label 382)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

</body>
</html>
