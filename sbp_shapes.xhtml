<?xml version="1.0"?>
<!-- CPSA 3.6.6 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Session Binding Protocol (SBP)</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;Extracted shapes&quot;)
(herald &quot;Session Binding Protocol (SBP)&quot;)
(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;All input read from sbp.lsp&quot;)</pre>

<p id="t0">Tree 0.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='13654.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 13654.920' font-size='12.000'>
  <text
   x='89.880' y='13601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k904&quot;, &quot;_self&quot;)'>904</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='13614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k903&quot;, &quot;_self&quot;)'>903</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='13539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k902&quot;, &quot;_self&quot;)'>902</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='13464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k900&quot;, &quot;_self&quot;)'>900</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='13389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k899&quot;, &quot;_self&quot;)'>899</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='13314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k898&quot;, &quot;_self&quot;)'>898</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='13239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k896&quot;, &quot;_self&quot;)'>896</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='13164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k895&quot;, &quot;_self&quot;)'>895</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='13089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k894&quot;, &quot;_self&quot;)'>894</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='13014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k892&quot;, &quot;_self&quot;)'>892</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='12939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k891&quot;, &quot;_self&quot;)'>891</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='12864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k890&quot;, &quot;_self&quot;)'>890</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='12789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k889&quot;, &quot;_self&quot;)'>889</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='12714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k888&quot;, &quot;_self&quot;)'>888</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='12639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k887&quot;, &quot;_self&quot;)'>887</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='12564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k886&quot;, &quot;_self&quot;)'>886</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='12489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k885&quot;, &quot;_self&quot;)'>885</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='12414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k884&quot;, &quot;_self&quot;)'>884</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='12339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k883&quot;, &quot;_self&quot;)'>883</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='12264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k882&quot;, &quot;_self&quot;)'>882</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='12189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k833&quot;, &quot;_self&quot;)'>833</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='12114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k832&quot;, &quot;_self&quot;)'>832</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='12039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k831&quot;, &quot;_self&quot;)'>831</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='11964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k830&quot;, &quot;_self&quot;)'>830</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='11889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k829&quot;, &quot;_self&quot;)'>829</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='11814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11726.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k828&quot;, &quot;_self&quot;)'>828</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='11739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k827&quot;, &quot;_self&quot;)'>827</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='11664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k826&quot;, &quot;_self&quot;)'>826</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='11589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k825&quot;, &quot;_self&quot;)'>825</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='11514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k735&quot;, &quot;_self&quot;)'>735</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='11439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k733&quot;, &quot;_self&quot;)'>733</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='11364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11276.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k731&quot;, &quot;_self&quot;)'>731</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='11289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k729&quot;, &quot;_self&quot;)'>729</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='11214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k727&quot;, &quot;_self&quot;)'>727</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='11139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k726&quot;, &quot;_self&quot;)'>726</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='11064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k724&quot;, &quot;_self&quot;)'>724</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='10989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k723&quot;, &quot;_self&quot;)'>723</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='10914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k712&quot;, &quot;_self&quot;)'>712</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='10839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k711&quot;, &quot;_self&quot;)'>711</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='10764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k710&quot;, &quot;_self&quot;)'>710</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='10689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k709&quot;, &quot;_self&quot;)'>709</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='10614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k683&quot;, &quot;_self&quot;)'>683</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='10539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k682&quot;, &quot;_self&quot;)'>682</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='10464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k681&quot;, &quot;_self&quot;)'>681</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='10389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k679&quot;, &quot;_self&quot;)'>679</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='10314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k678&quot;, &quot;_self&quot;)'>678</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='10239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k677&quot;, &quot;_self&quot;)'>677</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='10164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k675&quot;, &quot;_self&quot;)'>675</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='10089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k674&quot;, &quot;_self&quot;)'>674</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='10014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k673&quot;, &quot;_self&quot;)'>673</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='9939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k672&quot;, &quot;_self&quot;)'>672</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='9864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k671&quot;, &quot;_self&quot;)'>671</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='9789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k670&quot;, &quot;_self&quot;)'>670</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='9714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k669&quot;, &quot;_self&quot;)'>669</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='9639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k668&quot;, &quot;_self&quot;)'>668</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='9564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k667&quot;, &quot;_self&quot;)'>667</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='9489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k637&quot;, &quot;_self&quot;)'>637</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='9414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k636&quot;, &quot;_self&quot;)'>636</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='9339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k635&quot;, &quot;_self&quot;)'>635</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='9264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k634&quot;, &quot;_self&quot;)'>634</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='9189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k633&quot;, &quot;_self&quot;)'>633</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='9114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k632&quot;, &quot;_self&quot;)'>632</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='9039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k631&quot;, &quot;_self&quot;)'>631</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='8964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k630&quot;, &quot;_self&quot;)'>630</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='8889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k629&quot;, &quot;_self&quot;)'>629</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='8814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8726.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k628&quot;, &quot;_self&quot;)'>628</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='8739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k589&quot;, &quot;_self&quot;)'>589</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='8664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k587&quot;, &quot;_self&quot;)'>587</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='8589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k586&quot;, &quot;_self&quot;)'>586</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='8514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k585&quot;, &quot;_self&quot;)'>585</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='8439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k584&quot;, &quot;_self&quot;)'>584</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='8364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8276.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k583&quot;, &quot;_self&quot;)'>583</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='8289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k573&quot;, &quot;_self&quot;)'>573</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='8214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k572&quot;, &quot;_self&quot;)'>572</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='8139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k571&quot;, &quot;_self&quot;)'>571</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='8064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k562&quot;, &quot;_self&quot;)'>562</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='7989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k561&quot;, &quot;_self&quot;)'>561</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='7914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k560&quot;, &quot;_self&quot;)'>560</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='7839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k551&quot;, &quot;_self&quot;)'>551</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='7764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k550&quot;, &quot;_self&quot;)'>550</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='7689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k549&quot;, &quot;_self&quot;)'>549</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='7614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k542&quot;, &quot;_self&quot;)'>542</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='7539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k540&quot;, &quot;_self&quot;)'>540</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='7464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k538&quot;, &quot;_self&quot;)'>538</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='7389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k536&quot;, &quot;_self&quot;)'>536</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='7314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k535&quot;, &quot;_self&quot;)'>535</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='7239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k533&quot;, &quot;_self&quot;)'>533</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='7164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k532&quot;, &quot;_self&quot;)'>532</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='7089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k523&quot;, &quot;_self&quot;)'>523</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='7014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k522&quot;, &quot;_self&quot;)'>522</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='6939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k521&quot;, &quot;_self&quot;)'>521</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='6864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k504&quot;, &quot;_self&quot;)'>504</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='6789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k503&quot;, &quot;_self&quot;)'>503</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='6714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k501&quot;, &quot;_self&quot;)'>501</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='6639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k500&quot;, &quot;_self&quot;)'>500</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='6564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k498&quot;, &quot;_self&quot;)'>498</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='6489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k497&quot;, &quot;_self&quot;)'>497</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='6414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k496&quot;, &quot;_self&quot;)'>496</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='6339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k495&quot;, &quot;_self&quot;)'>495</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='6264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k494&quot;, &quot;_self&quot;)'>494</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='6189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k464&quot;, &quot;_self&quot;)'>464</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='6114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k463&quot;, &quot;_self&quot;)'>463</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='6039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k462&quot;, &quot;_self&quot;)'>462</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='5964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k450&quot;, &quot;_self&quot;)'>450</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='5889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k449&quot;, &quot;_self&quot;)'>449</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='5814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5726.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k448&quot;, &quot;_self&quot;)'>448</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='5739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k438&quot;, &quot;_self&quot;)'>438</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='5664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k437&quot;, &quot;_self&quot;)'>437</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='5589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k436&quot;, &quot;_self&quot;)'>436</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='5514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k427&quot;, &quot;_self&quot;)'>427</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='5439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k426&quot;, &quot;_self&quot;)'>426</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='5364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5276.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k425&quot;, &quot;_self&quot;)'>425</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='5289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k420&quot;, &quot;_self&quot;)'>420</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='5214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k418&quot;, &quot;_self&quot;)'>418</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='5139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k417&quot;, &quot;_self&quot;)'>417</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='5064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k416&quot;, &quot;_self&quot;)'>416</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='4989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k415&quot;, &quot;_self&quot;)'>415</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='4914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k405&quot;, &quot;_self&quot;)'>405</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='4839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k404&quot;, &quot;_self&quot;)'>404</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='4764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k403&quot;, &quot;_self&quot;)'>403</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='4689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k396&quot;, &quot;_self&quot;)'>396</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='4614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k395&quot;, &quot;_self&quot;)'>395</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='4539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k388&quot;, &quot;_self&quot;)'>388</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='4464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k386&quot;, &quot;_self&quot;)'>386</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='4389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k384&quot;, &quot;_self&quot;)'>384</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='4314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k382&quot;, &quot;_self&quot;)'>382</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='4239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k373&quot;, &quot;_self&quot;)'>373</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='4164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k372&quot;, &quot;_self&quot;)'>372</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='4089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k371&quot;, &quot;_self&quot;)'>371</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='4014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k339&quot;, &quot;_self&quot;)'>339</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='3939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k338&quot;, &quot;_self&quot;)'>338</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='3864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k337&quot;, &quot;_self&quot;)'>337</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='3789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k329&quot;, &quot;_self&quot;)'>329</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='3714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k328&quot;, &quot;_self&quot;)'>328</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='3639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k323&quot;, &quot;_self&quot;)'>323</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='3564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k322&quot;, &quot;_self&quot;)'>322</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='3489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k321&quot;, &quot;_self&quot;)'>321</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='3414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k309&quot;, &quot;_self&quot;)'>309</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='3339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k308&quot;, &quot;_self&quot;)'>308</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='3264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k307&quot;, &quot;_self&quot;)'>307</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='3189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k300&quot;, &quot;_self&quot;)'>300</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='3114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k299&quot;, &quot;_self&quot;)'>299</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='3039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k294&quot;, &quot;_self&quot;)'>294</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='2964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k293&quot;, &quot;_self&quot;)'>293</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='2889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k292&quot;, &quot;_self&quot;)'>292</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='2814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2726.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k291&quot;, &quot;_self&quot;)'>291</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='2739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k283&quot;, &quot;_self&quot;)'>283</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='2664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k282&quot;, &quot;_self&quot;)'>282</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='2589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k275&quot;, &quot;_self&quot;)'>275</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='2514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k274&quot;, &quot;_self&quot;)'>274</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='2439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k266&quot;, &quot;_self&quot;)'>266</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='2364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2276.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k265&quot;, &quot;_self&quot;)'>265</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='2289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k264&quot;, &quot;_self&quot;)'>264</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='2214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k237&quot;, &quot;_self&quot;)'>237</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='2139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k236&quot;, &quot;_self&quot;)'>236</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='2064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k221&quot;, &quot;_self&quot;)'>221</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='1989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k220&quot;, &quot;_self&quot;)'>220</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='1914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k212&quot;, &quot;_self&quot;)'>212</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k211&quot;, &quot;_self&quot;)'>211</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='1764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k207&quot;, &quot;_self&quot;)'>207</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k206&quot;, &quot;_self&quot;)'>206</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k196&quot;, &quot;_self&quot;)'>196</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k195&quot;, &quot;_self&quot;)'>195</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k194&quot;, &quot;_self&quot;)'>194</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k193&quot;, &quot;_self&quot;)'>193</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k192&quot;, &quot;_self&quot;)'>192</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k185&quot;, &quot;_self&quot;)'>185</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k184&quot;, &quot;_self&quot;)'>184</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k178&quot;, &quot;_self&quot;)'>178</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k177&quot;, &quot;_self&quot;)'>177</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k148&quot;, &quot;_self&quot;)'>148</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k147&quot;, &quot;_self&quot;)'>147</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k132&quot;, &quot;_self&quot;)'>132</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k131&quot;, &quot;_self&quot;)'>131</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k129&quot;, &quot;_self&quot;)'>129</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k128&quot;, &quot;_self&quot;)'>128</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k119&quot;, &quot;_self&quot;)'>119</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k118&quot;, &quot;_self&quot;)'>118</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k112&quot;, &quot;_self&quot;)'>112</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k111&quot;, &quot;_self&quot;)'>111</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k82&quot;, &quot;_self&quot;)'>82</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k66&quot;, &quot;_self&quot;)'>66</text>
  <line
   x1='39.960' y1='6827.460' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='6813.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol sbp basic
  (defrole client
    (vars (challenge id secret request iv answer cookie syskey data)
      (proxy ca name))
    (trace (send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (defrole proxy
    (vars (challenge id secret request iv answer cookie syskey data)
      (proxy ca name))
    (trace (obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer cookie))
      (send
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (defrole certauth
    (vars (proxy ca name))
    (trace (init (enc proxy (pubk proxy) (privk ca)))))
  (defrole server
    (vars (request answer cookie data))
    (trace (tran request (cat answer cookie)))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Children: <a href="#k66">66</a> <a href="#k82">82</a> <a href="#k111">111</a> <a href="#k112">112</a> <a href="#k118">118</a> <a href="#k119">119</a> <a href="#k128">128</a> <a href="#k129">129</a> <a href="#k131">131</a> <a href="#k132">132</a> <a href="#k147">147</a> <a href="#k148">148</a> <a href="#k177">177</a> <a href="#k178">178</a> <a href="#k184">184</a> <a href="#k185">185</a> <a href="#k192">192</a> <a href="#k193">193</a> <a href="#k194">194</a> <a href="#k195">195</a> <a href="#k196">196</a> <a href="#k206">206</a> <a href="#k207">207</a> <a href="#k211">211</a> <a href="#k212">212</a> <a href="#k220">220</a> <a href="#k221">221</a> <a href="#k236">236</a> <a href="#k237">237</a> <a href="#k264">264</a> <a href="#k265">265</a> <a href="#k266">266</a> <a href="#k274">274</a> <a href="#k275">275</a> <a href="#k282">282</a> <a href="#k283">283</a> <a href="#k291">291</a> <a href="#k292">292</a> <a href="#k293">293</a> <a href="#k294">294</a> <a href="#k299">299</a> <a href="#k300">300</a> <a href="#k307">307</a> <a href="#k308">308</a> <a href="#k309">309</a> <a href="#k321">321</a> <a href="#k322">322</a> <a href="#k323">323</a> <a href="#k328">328</a> <a href="#k329">329</a> <a href="#k337">337</a> <a href="#k338">338</a> <a href="#k339">339</a> <a href="#k371">371</a> <a href="#k372">372</a> <a href="#k373">373</a> <a href="#k382">382</a> <a href="#k384">384</a> <a href="#k386">386</a> <a href="#k388">388</a> <a href="#k395">395</a> <a href="#k396">396</a> <a href="#k403">403</a> <a href="#k404">404</a> <a href="#k405">405</a> <a href="#k415">415</a> <a href="#k416">416</a> <a href="#k417">417</a> <a href="#k418">418</a> <a href="#k420">420</a> <a href="#k425">425</a> <a href="#k426">426</a> <a href="#k427">427</a> <a href="#k436">436</a> <a href="#k437">437</a> <a href="#k438">438</a> <a href="#k448">448</a> <a href="#k449">449</a> <a href="#k450">450</a> <a href="#k462">462</a> <a href="#k463">463</a> <a href="#k464">464</a> <a href="#k494">494</a> <a href="#k495">495</a> <a href="#k496">496</a> <a href="#k497">497</a> <a href="#k498">498</a> <a href="#k500">500</a> <a href="#k501">501</a> <a href="#k503">503</a> <a href="#k504">504</a> <a href="#k521">521</a> <a href="#k522">522</a> <a href="#k523">523</a> <a href="#k532">532</a> <a href="#k533">533</a> <a href="#k535">535</a> <a href="#k536">536</a> <a href="#k538">538</a> <a href="#k540">540</a> <a href="#k542">542</a> <a href="#k549">549</a> <a href="#k550">550</a> <a href="#k551">551</a> <a href="#k560">560</a> <a href="#k561">561</a> <a href="#k562">562</a> <a href="#k571">571</a> <a href="#k572">572</a> <a href="#k573">573</a> <a href="#k583">583</a> <a href="#k584">584</a> <a href="#k585">585</a> <a href="#k586">586</a> <a href="#k587">587</a> <a href="#k589">589</a> <a href="#k628">628</a> <a href="#k629">629</a> <a href="#k630">630</a> <a href="#k631">631</a> <a href="#k632">632</a> <a href="#k633">633</a> <a href="#k634">634</a> <a href="#k635">635</a> <a href="#k636">636</a> <a href="#k637">637</a> <a href="#k667">667</a> <a href="#k668">668</a> <a href="#k669">669</a> <a href="#k670">670</a> <a href="#k671">671</a> <a href="#k672">672</a> <a href="#k673">673</a> <a href="#k674">674</a> <a href="#k675">675</a> <a href="#k677">677</a> <a href="#k678">678</a> <a href="#k679">679</a> <a href="#k681">681</a> <a href="#k682">682</a> <a href="#k683">683</a> <a href="#k709">709</a> <a href="#k710">710</a> <a href="#k711">711</a> <a href="#k712">712</a> <a href="#k723">723</a> <a href="#k724">724</a> <a href="#k726">726</a> <a href="#k727">727</a> <a href="#k729">729</a> <a href="#k731">731</a> <a href="#k733">733</a> <a href="#k735">735</a> <a href="#k825">825</a> <a href="#k826">826</a> <a href="#k827">827</a> <a href="#k828">828</a> <a href="#k829">829</a> <a href="#k830">830</a> <a href="#k831">831</a> <a href="#k832">832</a> <a href="#k833">833</a> <a href="#k882">882</a> <a href="#k883">883</a> <a href="#k884">884</a> <a href="#k885">885</a> <a href="#k886">886</a> <a href="#k887">887</a> <a href="#k888">888</a> <a href="#k889">889</a> <a href="#k890">890</a> <a href="#k891">891</a> <a href="#k892">892</a> <a href="#k894">894</a> <a href="#k895">895</a> <a href="#k896">896</a> <a href="#k898">898</a> <a href="#k899">899</a> <a href="#k900">900</a> <a href="#k902">902</a> <a href="#k903">903</a> <a href="#k904">904</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>sbp 0</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (challenge secret id syskey request iv answer cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (label 0)
  (unrealized (0 1) (0 4) (0 6))
  (origs (challenge (0 0)) (secret (0 2)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k66">Item <a href="#t0">66</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 639.960 Q 292.260 675.660 244.679 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 286.860 639.960 333.840 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 66 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request iv answer request-0 iv-0 answer-0 cookie
      data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 7) (3 0)) ((2 9) (0 6)) ((3 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((2 7) (3 0)) ((3 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 4 2 proxy 8) request-1 (3 0))
  (label 66)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k82">Item <a href="#t0">82</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 639.960 Q 292.260 675.660 244.679 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 286.860 639.960 333.840 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 82 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((2 7) (3 0)) ((2 9) (0 6))
    ((3 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((2 7) (3 0)) ((3 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 4 2 proxy 8) request-1 (3 0))
  (label 82)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k111">Item <a href="#t0">111</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 639.960 Q 392.820 639.960 345.840 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret-0 challenge id-0))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 292.260 675.660 244.679 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 111 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret-0 request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((1 0) (4 0)) ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8))
    ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 5 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (4 0))
  (label 111)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k112">Item <a href="#t0">112</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 114.960 Q 492.780 114.960 445.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 392.820 639.960 345.840 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret-0 challenge id-0))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 292.260 675.660 244.679 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret-0) (request request-1) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 112 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret-0 request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8)) ((4 7) (3 0))
    ((5 0) (4 0)))
  (leadsto ((1 0) (2 0)) ((3 0) (2 8)) ((4 7) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (4 0))
  (label 112)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k118">Item <a href="#t0">118</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 639.960 Q 392.820 639.960 345.840 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret-0 challenge id-0))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 292.260 675.660 244.679 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 118 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret-0 request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 8)) ((4 2) (0 1))
    ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 1 5 proxy 8) request-1 (4 0))
  (label 118)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k119">Item <a href="#t0">119</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 386.820 639.960 433.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 119 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (4 0)) ((3 9) (0 6))
    ((4 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 5 3 proxy 8) request-1 (4 0))
  (label 119)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k128">Item <a href="#t0">128</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 292.860 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 341.504 749.964 243.207 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 291.078 224.718 242.316 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1014.960 Q 142.920 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 336.840 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 137.927 262.717 235.895 410.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret) (request request-1) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 128 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 5) (2 3)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 0) (2 8)) ((5 2) (0 1)) ((5 7) (4 0)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig id request)
  (operation state-passing-test (displaced 1 6 proxy 8) request-1 (5 0))
  (label 128)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k129">Item <a href="#t0">129</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='864.960' x2='539.760' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 864.960 Q 442.609 863.906 345.458 937.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='864.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 391.038 224.718 342.276 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1014.960 Q 192.900 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <path
   d='M 339.840 864.960 Q 436.800 827.460 533.760 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 186.900 527.460 333.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 187.500 263.160 335.041 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 129 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 5) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 7) (5 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((3 7) (5 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (displaced 6 3 proxy 8) request-1 (5 0))
  (label 129)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k131">Item <a href="#t0">131</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 639.960 Q 392.820 639.960 345.840 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 292.260 675.660 244.679 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 131 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((1 0) (4 0)) ((2 2) (0 1)) ((2 5) (0 4)) ((2 9) (0 6))
    ((3 0) (2 8)) ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 5 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (4 0))
  (label 131)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k132">Item <a href="#t0">132</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 114.960 Q 492.780 114.960 445.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 392.820 639.960 345.840 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 292.260 675.660 244.679 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 132 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((2 9) (0 6)) ((3 0) (2 8))
    ((4 7) (3 0)) ((5 0) (4 0)))
  (leadsto ((1 0) (2 0)) ((3 0) (2 8)) ((4 7) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (4 0))
  (label 132)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k147">Item <a href="#t0">147</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 639.960 Q 392.820 639.960 345.840 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 292.260 675.660 244.679 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 147 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((1 0) (4 0)) ((2 5) (0 4)) ((2 9) (0 6)) ((3 0) (2 8))
    ((4 2) (0 1)) ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 5 proxy 8) request-1 (4 0))
  (label 147)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k148">Item <a href="#t0">148</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 386.820 639.960 433.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 148 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 5) (0 4)) ((3 7) (4 0))
    ((3 9) (0 6)) ((4 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 5 3 proxy 8) request-1 (4 0))
  (label 148)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k177">Item <a href="#t0">177</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-1))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-0 id-1))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 177 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie challenge-0 id-1 secret-0 request-1 data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 6 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (label 177)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k178">Item <a href="#t0">178</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 114.960 Q 592.740 114.960 545.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-1))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-0 id-1))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-1) (secret secret-0) (request request-1) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 178 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie challenge-0 id-1 secret-0 request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0))
    ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (label 178)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k184">Item <a href="#t0">184</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret-0 challenge id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 292.860 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 342.649 638.906 245.498 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 292.860 114.960 245.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 336.840 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 184 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret-0 request-1 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (5 0))
    ((2 9) (0 6)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 2) (0 1))
    ((5 7) (4 0)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 1 6 proxy 8) request-1 (5 0))
  (label 184)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k185">Item <a href="#t0">185</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 442.609 638.906 345.458 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 436.800 602.460 533.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 185 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 7) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((3 7) (5 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 6 3 proxy 8) request-1 (5 0))
  (label 185)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k192">Item <a href="#t0">192</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-1))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret challenge-0 id-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 441.464 749.964 343.167 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 391.038 224.718 342.276 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1014.960 Q 192.900 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 436.800 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 186.900 527.460 333.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 187.500 263.160 335.041 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-1) (secret secret) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 192 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 5) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (displaced 7 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (label 192)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k193">Item <a href="#t0">193</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-1))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret challenge-0 id-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 441.464 749.964 343.167 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 391.038 224.718 342.276 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 536.760 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1014.960 Q 192.900 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 186.900 527.460 333.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 187.500 263.160 335.041 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-1) (secret secret) (request request-1) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 193 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 5) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (displaced 7 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (label 193)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k194">Item <a href="#t0">194</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 114.960 Q 692.700 114.960 645.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-1))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret challenge-0 id-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 441.464 749.964 343.167 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 391.038 224.718 342.276 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1014.960 Q 192.900 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request id id))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 186.900 527.460 333.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash request id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 187.500 263.160 335.041 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-1) (secret secret) (request request-1) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 194 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 5) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (label 194)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))</pre>

<p id="k195">Item <a href="#t0">195</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 639.960 Q 392.820 639.960 345.840 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 242.689 526.406 45.578 637.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 292.260 675.660 244.679 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 195 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 answer-0 cookie challenge
      id secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0))
    ((2 9) (0 6)) ((3 0) (2 8)) ((4 2) (0 1)) ((4 5) (0 4))
    ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 2 5 proxy 8) request-1 (4 0))
  (label 195)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k196">Item <a href="#t0">196</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 386.820 639.960 433.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 196 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 7) (4 0)) ((3 9) (0 6))
    ((4 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 5 3 proxy 8) request-1 (4 0))
  (label 196)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k206">Item <a href="#t0">206</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 292.860 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 292.860 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 341.504 749.964 243.207 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 291.078 224.718 242.316 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1014.960 Q 142.920 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>request</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 336.840 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>secret</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 137.927 262.717 235.895 410.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request secret) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 206 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((0 5) (2 3)) ((1 0) (5 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 0) (2 8)) ((5 2) (0 1)) ((5 5) (0 4)) ((5 7) (4 0)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 2 6 proxy 8) request-0 (5 0))
  (label 206)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request secret) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k207">Item <a href="#t0">207</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='864.960' x2='539.760' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 864.960 Q 442.609 863.906 345.458 937.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='864.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 391.038 224.718 342.276 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1014.960 Q 192.900 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <path
   d='M 339.840 864.960 Q 436.800 827.460 533.760 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 186.900 527.460 333.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 187.500 263.160 335.041 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 207 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 3) (2 4))
    ((0 5) (3 3)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 7) (5 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((3 7) (5 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 6 3 proxy 8) request-1 (5 0))
  (label 207)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k211">Item <a href="#t0">211</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 639.960 Q 392.820 639.960 345.840 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 242.689 526.406 45.578 637.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 292.260 675.660 244.679 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 211 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 answer-0 cookie challenge
      id secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8)) ((4 5) (0 4))
    ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 2 5 proxy 8) request-1 (4 0))
  (label 211)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k212">Item <a href="#t0">212</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 386.820 639.960 433.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 212 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 7) (4 0)) ((3 9) (0 6))
    ((4 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 5 3 proxy 8) request-1 (4 0))
  (label 212)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k220">Item <a href="#t0">220</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 220 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((3 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (label 220)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k221">Item <a href="#t0">221</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 114.960 Q 592.740 114.960 545.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 221 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 5) (0 4)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0))
    ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (label 221)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k236">Item <a href="#t0">236</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 292.860 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 336.840 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 236 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 0) (5 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 2) (0 1)) ((5 7) (4 0)))
  (leadsto ((1 0) (5 0)) ((2 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 6 proxy 8) request-1 (5 0))
  (label 236)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k237">Item <a href="#t0">237</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 486.780 639.960 533.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 242.689 526.406 45.578 637.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 386.820 114.960 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 237 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 0) (4 0)) ((4 5) (0 4)) ((4 7) (5 0))
    ((4 9) (0 6)) ((5 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((4 7) (5 0)) ((5 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 4 proxy 8) request-1 (5 0))
  (label 237)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k264">Item <a href="#t0">264</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-1))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-0 id-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 442.609 638.906 345.458 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 436.800 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 264 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie challenge-0 id-1 secret-0 request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (6 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 7 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (label 264)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k265">Item <a href="#t0">265</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-1))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-0 id-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 442.609 638.906 345.458 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 536.760 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 265 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie challenge-0 id-1 secret-0 request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (6 0))
    ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 7 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (label 265)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k266">Item <a href="#t0">266</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 114.960 Q 692.700 114.960 645.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-1))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-0 id-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 442.609 638.906 345.458 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret id id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret id id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc id (hash secret id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret id id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>id</title><circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-1) (secret secret-0) (request request-1) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge id) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 266 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie challenge-0 id-1 secret-0 request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (label 266)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))</pre>

<p id="k274">Item <a href="#t0">274</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 336.840 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 274 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (5 0)) ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (label 274)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k275">Item <a href="#t0">275</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 114.960 Q 592.740 114.960 545.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 275 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0))
    ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (label 275)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k282">Item <a href="#t0">282</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 292.733 526.598 45.707 638.235'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 292.860 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 342.649 638.906 245.498 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 292.860 114.960 245.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 336.840 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 282 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 answer-0 cookie challenge
      id secret request-1 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (2 4)) ((0 3) (5 4)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 0) (2 8)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 7) (4 0)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 2 6 proxy 8) request-1 (5 0))
  (label 282)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k283">Item <a href="#t0">283</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 442.609 638.906 345.458 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 436.800 602.460 533.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 283 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 7) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((3 7) (5 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 3 proxy 8) request-1 (5 0))
  (label 283)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k291">Item <a href="#t0">291</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 441.464 749.964 343.167 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 391.038 224.718 342.276 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1014.960 Q 192.900 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 186.900 527.460 333.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 187.500 263.160 335.041 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 291 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 3) (2 4))
    ((0 5) (3 3)) ((1 0) (2 0)) ((1 0) (6 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 7 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (label 291)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k292">Item <a href="#t0">292</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 441.464 749.964 343.167 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 391.038 224.718 342.276 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 536.760 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1014.960 Q 192.900 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 186.900 527.460 333.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 187.500 263.160 335.041 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 292 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 3) (2 4))
    ((0 5) (3 3)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((4 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 7 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (label 292)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k293">Item <a href="#t0">293</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 114.960 Q 692.700 114.960 645.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 441.464 749.964 343.167 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 391.038 224.718 342.276 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1014.960 Q 192.900 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 186.900 527.460 333.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 187.500 263.160 335.041 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 293 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 3) (2 4))
    ((0 5) (3 3)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (label 293)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k294">Item <a href="#t0">294</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 391.308 862.355 242.856 1159.750'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 486.780 639.960 533.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 294 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 3)) ((5 0) (2 8))
    ((5 0) (4 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (5 0)) ((5 0) (2 8))
    ((5 0) (4 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 5 server 1)
    (cat answer-1 cookie-0) (2 8))
  (label 294)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k299">Item <a href="#t0">299</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 336.840 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 299 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (5 0)) ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (label 299)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k300">Item <a href="#t0">300</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 114.960 Q 592.740 114.960 545.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 300 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0))
    ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (label 300)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k307">Item <a href="#t0">307</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 292.860 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 336.840 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 307 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (5 0)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 2) (0 1)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 6 proxy 8) request-1 (5 0))
  (label 307)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k308">Item <a href="#t0">308</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 292.733 526.598 45.707 638.235'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 308 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 5) (0 4)) ((5 7) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 6 proxy 8) request-1 (5 0))
  (label 308)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k309">Item <a href="#t0">309</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 486.780 639.960 533.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 336.840 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 309 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 7) (5 0))
    ((4 9) (0 6)) ((5 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((4 7) (5 0))
    ((5 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 4 proxy 8) request-1 (5 0))
  (label 309)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k321">Item <a href="#t0">321</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 342.840 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 441.464 749.964 343.167 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 391.038 224.718 342.276 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1014.960 Q 192.900 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 186.900 527.460 333.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 187.500 263.160 335.041 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 321 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 3) (2 4))
    ((0 5) (3 3)) ((1 0) (2 0)) ((1 0) (6 0)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 2) (0 1))
    ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 1 7 proxy 8) request-1 (6 0))
  (label 321)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k322">Item <a href="#t0">322</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 342.840 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 441.464 749.964 343.167 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 391.038 224.718 342.276 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1014.960 Q 192.900 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>request</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>request</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 436.800 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 186.900 527.460 333.840 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>secret</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 187.500 263.160 335.041 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request secret) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 322 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((0 5) (3 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (6 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 5) (0 4))
    ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 7 proxy 8) request-0 (6 0))
  (label 322)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request secret) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k323">Item <a href="#t0">323</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='864.960' x2='639.720' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 864.960 Q 542.569 863.906 445.418 937.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='864.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.998 224.718 442.236 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1014.960 Q 242.880 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='439.800' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <path
   d='M 439.800 864.960 Q 536.760 827.460 633.720 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 236.880 527.460 433.800 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 237.266 263.489 434.571 412.018'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 323 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (4 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 7) (6 0)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 7) (6 0)) ((5 0) (4 0))
    ((6 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 7 4 proxy 8) request-1 (6 0))
  (label 323)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k328">Item <a href="#t0">328</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='639.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 492.780 639.960 445.800 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 292.733 526.598 45.707 638.235'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 392.220 675.660 344.639 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 328 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 answer-0 cookie challenge
      id secret request-1 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 0) (3 0)) ((2 0) (5 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 0) (3 8)) ((5 5) (0 4))
    ((5 7) (4 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (5 0)) ((4 0) (3 8)) ((5 7) (4 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 2 6 proxy 8) request-1 (5 0))
  (label 328)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k329">Item <a href="#t0">329</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 486.780 639.960 533.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 292.860 114.960 245.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 329 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 7) (5 0)) ((4 9) (0 6))
    ((5 0) (4 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (5 0)) ((5 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 4 proxy 8) request-1 (5 0))
  (label 329)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k337">Item <a href="#t0">337</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 242.689 526.406 45.578 637.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 386.820 114.960 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 436.800 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 337 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (6 0)) ((3 0) (4 0)) ((4 5) (0 4))
    ((4 9) (0 6)) ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (6 0)) ((3 0) (4 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (label 337)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k338">Item <a href="#t0">338</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 242.689 526.406 45.578 637.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 386.820 114.960 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 338 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (6 0)) ((4 5) (0 4))
    ((4 9) (0 6)) ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 3 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (label 338)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k339">Item <a href="#t0">339</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 114.960 Q 692.700 114.960 645.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 242.689 526.406 45.578 637.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 386.820 114.960 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 339 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 0) (4 0)) ((4 5) (0 4)) ((4 9) (0 6))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (label 339)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k371">Item <a href="#t0">371</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 442.609 638.906 345.458 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 371 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (6 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (label 371)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k372">Item <a href="#t0">372</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 442.609 638.906 345.458 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 536.760 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 372 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (6 0))
    ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((4 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (label 372)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k373">Item <a href="#t0">373</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 114.960 Q 692.700 114.960 645.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 442.609 638.906 345.458 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 373 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (label 373)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k382">Item <a href="#t0">382</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='1089.960' x2='639.720' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 1089.960 Q 442.749 1089.407 245.777 1163.854'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 486.780 639.960 533.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1089.960 Q 436.800 1052.460 633.720 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 382 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 7) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((2 7) (6 0)) ((3 0) (2 0)) ((4 7) (5 0))
    ((5 0) (4 8)) ((6 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 2 proxy 8) request-2 (6 0))
  (label 382)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k384">Item <a href="#t0">384</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 391.308 862.355 242.856 1159.750'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 384 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (2 8))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (2 8))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 5 server 1)
    (cat answer-1 cookie-0) (2 8))
  (label 384)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k386">Item <a href="#t0">386</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 391.308 862.355 242.856 1159.750'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 386 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((3 0) (6 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (2 8))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (6 0)) ((5 0) (2 8))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 5 server 1)
    (cat answer-1 cookie-0) (2 8))
  (label 386)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k388">Item <a href="#t0">388</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 114.960 Q 692.700 114.960 645.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 391.308 862.355 242.856 1159.750'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 388 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (2 8)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (2 8)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 5 server 1)
    (cat answer-1 cookie-0) (2 8))
  (label 388)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k395">Item <a href="#t0">395</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 336.840 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 436.800 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 395 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((2 0) (6 0)) ((3 5) (0 4))
    ((4 9) (0 6)) ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((2 0) (6 0))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (label 395)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k396">Item <a href="#t0">396</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 114.960 Q 692.700 114.960 645.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 336.840 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 396 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (label 396)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k403">Item <a href="#t0">403</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 342.840 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 442.609 638.906 345.458 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 403 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (6 0))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 2) (0 1)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 7 proxy 8) request-1 (6 0))
  (label 403)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k404">Item <a href="#t0">404</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 342.750 526.732 45.781 638.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 442.609 638.906 345.458 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 436.800 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 404 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (3 4)) ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 5) (0 4)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 7 proxy 8) request-1 (6 0))
  (label 404)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k405">Item <a href="#t0">405</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 542.569 638.906 445.418 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 492.780 114.960 445.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 536.760 602.460 633.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 405 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 7) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 7) (6 0)) ((5 0) (4 0))
    ((6 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 4 proxy 8) request-1 (6 0))
  (label 405)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k415">Item <a href="#t0">415</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 541.424 749.964 443.127 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.998 224.718 442.236 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1014.960 Q 242.880 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='439.800' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 486.780 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 236.880 527.460 433.800 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 237.266 263.489 434.571 412.018'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 415 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (4 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (7 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 0) (4 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (7 0)) ((5 0) (4 0))
    ((6 0) (4 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (7 0))
  (label 415)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k416">Item <a href="#t0">416</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 541.424 749.964 443.127 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.998 224.718 442.236 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 539.760 114.960 Q 636.720 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1014.960 Q 242.880 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='439.800' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 236.880 527.460 433.800 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 237.266 263.489 434.571 412.018'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret) (request request-1) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 416 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (4 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)) ((5 0) (7 0))
    ((6 0) (4 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((5 0) (7 0))
    ((6 0) (4 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 8 5 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (7 0))
  (label 416)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k417">Item <a href="#t0">417</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 114.960 Q 792.660 114.960 745.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 541.424 749.964 443.127 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.998 224.718 442.236 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1014.960 Q 242.880 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='439.800' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 236.880 527.460 433.800 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 237.266 263.489 434.571 412.018'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret) (request request-1) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 417 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (4 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (7 0))
  (label 417)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k418">Item <a href="#t0">418</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 342.840 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 391.308 862.355 242.856 1159.750'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 418 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (2 8)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (2 8))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 5 server 1)
    (cat answer-1 cookie-0) (2 8))
  (label 418)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k420">Item <a href="#t0">420</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 491.268 862.355 342.816 1159.750'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 586.740 639.960 633.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 420 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 7) (6 0)) ((5 9) (3 3))
    ((6 0) (3 8)) ((6 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (6 0))
    ((6 0) (3 8)) ((6 0) (5 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 7 6 server 1)
    (cat answer-1 cookie-0) (3 8))
  (label 420)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k425">Item <a href="#t0">425</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 292.860 114.960 245.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 425 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (4 0)) ((1 0) (6 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (label 425)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k426">Item <a href="#t0">426</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 292.860 114.960 245.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 426 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((3 0) (6 0)) ((4 2) (0 1)) ((4 9) (0 6))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 3 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (label 426)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k427">Item <a href="#t0">427</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 114.960 Q 692.700 114.960 645.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 292.860 114.960 245.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 427 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (label 427)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k436">Item <a href="#t0">436</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 342.840 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 292.860 114.960 245.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 436 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (4 0)) ((1 0) (6 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 7 proxy 8) request-1 (6 0))
  (label 436)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k437">Item <a href="#t0">437</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 342.750 526.732 45.781 638.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 336.840 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 437 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (4 3)) ((0 2) (6 3))
    ((0 3) (4 4)) ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (4 0)) ((3 0) (6 0)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 5) (0 4)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 7 proxy 8) request-1 (6 0))
  (label 437)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k438">Item <a href="#t0">438</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 292.860 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 586.740 639.960 633.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 438 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 7) (6 0))
    ((5 9) (0 6)) ((6 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (6 0))
    ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 5 proxy 8) request-1 (6 0))
  (label 438)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k448">Item <a href="#t0">448</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 342.840 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 292.860 114.960 245.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 386.820 114.960 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 448 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (6 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((3 0) (4 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 7 proxy 8) request-1 (6 0))
  (label 448)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k449">Item <a href="#t0">449</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 342.750 526.732 45.781 638.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 386.820 114.960 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 449 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (4 3)) ((0 2) (6 3))
    ((0 3) (4 4)) ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 0) (4 0)) ((3 0) (6 0)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 5) (0 4)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 7 proxy 8) request-1 (6 0))
  (label 449)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k450">Item <a href="#t0">450</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 292.860 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 586.740 639.960 633.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 486.780 114.960 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 450 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 7) (6 0))
    ((5 9) (0 6)) ((6 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 7) (6 0))
    ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 5 proxy 8) request-1 (6 0))
  (label 450)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k462">Item <a href="#t0">462</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <path
   d='M 739.680 264.960 Q 392.820 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 541.424 749.964 443.127 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.998 224.718 442.236 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1014.960 Q 242.880 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='439.800' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 292.860 114.960 245.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 236.880 527.460 433.800 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 237.266 263.489 434.571 412.018'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 462 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 3) (2 4))
    ((0 5) (4 3)) ((1 0) (7 0)) ((2 5) (0 4)) ((3 0) (2 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 0) (4 8)) ((7 2) (0 1))
    ((7 7) (6 0)))
  (leadsto ((1 0) (7 0)) ((3 0) (2 0)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 1 8 proxy 8) request-1 (7 0))
  (label 462)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k463">Item <a href="#t0">463</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <path
   d='M 739.680 489.960 Q 392.820 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 541.424 749.964 443.127 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.998 224.718 442.236 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1014.960 Q 242.880 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>request</title>
   <circle style='fill: gray;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>request</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 536.760 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 236.880 527.460 433.800 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>secret</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 386.820 377.460 733.680 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 386.820 302.460 733.680 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.266 263.489 434.571 412.018'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request secret) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 463 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (7 3)) ((0 3) (7 4))
    ((0 5) (4 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (7 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 0) (4 8)) ((7 5) (0 4))
    ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (7 0)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 8 proxy 8) request-0 (7 0))
  (label 463)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request secret) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k464">Item <a href="#t0">464</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='864.960' x2='739.680' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 864.960 Q 642.529 863.906 545.378 937.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='864.960' r='6.000'/></g>
  <path
   d='M 639.720 114.960 Q 590.958 224.718 542.196 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 1014.960 Q 292.860 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='539.760' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='939.960' r='6.000'/></g>
  <path
   d='M 539.760 864.960 Q 636.720 827.460 733.680 864.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 286.860 527.460 533.760 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 287.124 263.728 534.289 412.497'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 464 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (5 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 7) (7 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((5 7) (7 0)) ((6 0) (5 0))
    ((7 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 8 5 proxy 8) request-1 (7 0))
  (label 464)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k494">Item <a href="#t0">494</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 441.618 862.573 243.515 1160.187'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 486.780 639.960 533.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 494 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (7 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 0) (2 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (7 0)) ((3 0) (2 0)) ((4 7) (5 0))
    ((5 0) (4 8)) ((6 0) (2 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (7 0))
  (label 494)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k495">Item <a href="#t0">495</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 441.618 862.573 243.515 1160.187'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 486.780 639.960 533.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 536.760 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 495 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((3 0) (7 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 0) (2 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (7 0)) ((4 7) (5 0))
    ((5 0) (4 8)) ((6 0) (2 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 3 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (7 0))
  (label 495)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k496">Item <a href="#t0">496</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 114.960 Q 792.660 114.960 745.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 441.618 862.573 243.515 1160.187'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 486.780 639.960 533.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 496 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 0) (2 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (5 0)) ((5 0) (4 8))
    ((6 0) (2 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (7 0))
  (label 496)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k497">Item <a href="#t0">497</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='1089.960' x2='739.680' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 1089.960 Q 492.747 1089.515 245.814 1164.070'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1089.960 Q 486.780 1052.460 733.680 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 497 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 7) (7 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((2 7) (7 0)) ((3 0) (2 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 proxy 8) request-3 (7 0))
  (label 497)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k498">Item <a href="#t0">498</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 491.848 862.787 244.017 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 586.740 602.460 733.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 498 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 7) (7 0)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((4 7) (7 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 proxy 8) request-3 (7 0))
  (label 498)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k500">Item <a href="#t0">500</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='1089.960' x2='739.680' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 1089.960 Q 492.747 1089.515 245.814 1164.070'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1089.960 Q 486.780 1052.460 733.680 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 500 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 7) (7 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (6 0)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((2 7) (7 0)) ((3 0) (2 0)) ((3 0) (6 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 proxy 8) request-3 (7 0))
  (label 500)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k501">Item <a href="#t0">501</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 491.848 862.787 244.017 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 586.740 602.460 733.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 501 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((3 0) (6 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 7) (7 0)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (6 0)) ((4 7) (7 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 proxy 8) request-3 (7 0))
  (label 501)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k503">Item <a href="#t0">503</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='1089.960' x2='839.640' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 1089.960 Q 542.737 1089.588 245.834 1164.216'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 739.680 114.960 Q 692.700 114.960 645.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1089.960 Q 536.760 1052.460 833.640 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 503 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 7) (8 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((2 7) (8 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 2 proxy 8) request-3 (8 0))
  (label 503)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k504">Item <a href="#t0">504</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 542.017 862.984 244.395 1161.008'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 114.960 Q 692.700 114.960 645.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 636.720 602.460 833.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 504 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 7) (8 0)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (8 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 4 proxy 8) request-3 (8 0))
  (label 504)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k521">Item <a href="#t0">521</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 542.569 638.906 445.418 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 492.780 114.960 445.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 486.780 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 521 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (7 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 0) (4 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (7 0)) ((5 0) (4 0))
    ((6 0) (4 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (label 521)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k522">Item <a href="#t0">522</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 542.569 638.906 445.418 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 492.780 114.960 445.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 539.760 114.960 Q 636.720 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 522 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((5 0) (7 0)) ((6 0) (4 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((5 0) (7 0))
    ((6 0) (4 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 5 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (label 522)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k523">Item <a href="#t0">523</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 114.960 Q 792.660 114.960 745.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 542.569 638.906 445.418 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 492.780 114.960 445.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 286.860 114.960 333.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 523 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 0) (4 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (label 523)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k532">Item <a href="#t0">532</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='1089.960' x2='739.680' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 1089.960 Q 492.747 1089.515 245.814 1164.070'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 342.840 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1089.960 Q 486.780 1052.460 733.680 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 532 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 7) (7 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)) ((7 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((2 7) (7 0)) ((3 0) (2 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 proxy 8) request-3 (7 0))
  (label 532)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k533">Item <a href="#t0">533</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 491.848 862.787 244.017 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 342.840 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 586.740 602.460 733.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 533 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 5) (0 4)) ((4 7) (7 0)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)) ((7 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((4 7) (7 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 proxy 8) request-3 (7 0))
  (label 533)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k535">Item <a href="#t0">535</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <path
   d='M 739.680 264.960 Q 392.820 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 441.618 862.573 243.515 1160.187'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 486.780 639.960 533.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 535 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (7 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 0) (2 8)) ((7 2) (0 1)) ((7 7) (6 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (7 0)) ((3 0) (2 0)) ((4 7) (5 0))
    ((5 0) (4 8)) ((6 0) (2 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 8 proxy 8) request-2 (7 0))
  (label 535)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k536">Item <a href="#t0">536</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='1089.960' x2='739.680' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 1089.960 Q 542.709 1089.407 345.737 1163.854'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 586.740 639.960 633.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 1089.960 Q 536.760 1052.460 733.680 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 536 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 7) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 7) (6 0))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((3 7) (7 0)) ((4 0) (3 0))
    ((5 7) (6 0)) ((6 0) (5 8)) ((7 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 8 3 proxy 8) request-2 (7 0))
  (label 536)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k538">Item <a href="#t0">538</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 491.268 862.355 342.816 1159.750'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 486.780 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 538 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (3 8)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((4 0) (3 0))
    ((6 0) (3 8)) ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-1 cookie-0) (3 8))
  (label 538)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k540">Item <a href="#t0">540</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 491.268 862.355 342.816 1159.750'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 586.740 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 540 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((4 0) (7 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (3 8)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (7 0))
    ((6 0) (3 8)) ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-1 cookie-0) (3 8))
  (label 540)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k542">Item <a href="#t0">542</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 114.960 Q 792.660 114.960 745.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 491.268 862.355 342.816 1159.750'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 542 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (3 8))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (3 8))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 6 server 1)
    (cat answer-1 cookie-0) (3 8))
  (label 542)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k549">Item <a href="#t0">549</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 292.860 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 486.780 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 549 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((2 0) (7 0)) ((3 5) (0 4)) ((4 0) (3 0))
    ((5 9) (0 6)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (label 549)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k550">Item <a href="#t0">550</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 292.860 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 586.740 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 550 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (7 0))
    ((5 9) (0 6)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (7 0))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (label 550)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k551">Item <a href="#t0">551</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 114.960 Q 792.660 114.960 745.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 292.860 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 551 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (label 551)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k560">Item <a href="#t0">560</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 292.860 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 486.780 114.960 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 486.780 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 560 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (7 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0))
    ((5 9) (0 6)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((4 0) (5 0))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (label 560)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k561">Item <a href="#t0">561</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 292.860 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 486.780 114.960 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 586.740 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 561 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((4 0) (7 0))
    ((5 9) (0 6)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((4 0) (7 0))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (label 561)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k562">Item <a href="#t0">562</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 114.960 Q 792.660 114.960 745.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 292.860 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 486.780 114.960 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 562 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (label 562)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k571">Item <a href="#t0">571</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <path
   d='M 739.680 264.960 Q 392.820 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 542.569 638.906 445.418 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 492.780 114.960 445.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 292.860 114.960 245.880 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.320 525.660 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-1))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-1) (proxy proxy) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-1))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 571 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca ca-0 proxy ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (7 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 2) (0 1)) ((7 7) (6 0)))
  (leadsto ((1 0) (7 0)) ((3 0) (2 0)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 8 proxy 8) request-1 (7 0))
  (label 571)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k572">Item <a href="#t0">572</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <path
   d='M 739.680 489.960 Q 392.753 526.831 45.827 638.702'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 542.569 638.906 445.418 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 492.780 114.960 445.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 242.880 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 536.760 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 386.820 377.460 733.680 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 386.820 302.460 733.680 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (proxy proxy) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 572 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca ca-0 proxy ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (4 4)) ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 5) (0 4)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (7 0)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 8 proxy 8) request-1 (7 0))
  (label 572)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k573">Item <a href="#t0">573</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 642.529 638.906 545.378 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 114.960 Q 592.740 114.960 545.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 292.860 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 636.720 602.460 733.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-1))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 573 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 7) (7 0)) ((5 9) (0 6))
    ((6 0) (5 0)) ((7 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((5 7) (7 0)) ((6 0) (5 0))
    ((7 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 5 proxy 8) request-1 (7 0))
  (label 573)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k583">Item <a href="#t0">583</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 641.384 749.964 543.087 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 114.960 Q 590.958 224.718 542.196 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 1014.960 Q 292.860 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='539.760' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 536.760 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 286.860 527.460 533.760 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 287.124 263.728 534.289 412.497'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 583 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (5 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (8 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((4 0) (3 0)) ((6 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (8 0))
  (label 583)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k584">Item <a href="#t0">584</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 641.384 749.964 543.087 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 114.960 Q 590.958 224.718 542.196 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 1014.960 Q 292.860 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='539.760' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 636.720 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 286.860 527.460 533.760 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 287.124 263.728 534.289 412.497'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 584 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (5 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((4 0) (8 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (8 0)) ((6 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 9 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (8 0))
  (label 584)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k585">Item <a href="#t0">585</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 641.384 749.964 543.087 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 114.960 Q 590.958 224.718 542.196 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 639.720 114.960 Q 736.680 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 1014.960 Q 292.860 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='539.760' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 286.860 527.460 533.760 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 287.124 263.728 534.289 412.497'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret) (request request-1) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 585 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (5 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)) ((6 0) (8 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((6 0) (8 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 9 6 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (8 0))
  (label 585)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k586">Item <a href="#t0">586</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1054.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1054.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 114.960 Q 892.620 114.960 845.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-2))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-2)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-2))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 641.384 749.964 543.087 934.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 114.960 Q 590.958 224.718 542.196 334.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 1014.960 Q 292.860 977.460 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle cx='539.760' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='864.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash request challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc request (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash request challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 286.860 527.460 533.760 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>request</title><circle cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash request challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash request challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc request (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 287.124 263.728 534.289 412.497'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-2))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret) (request request-1) (proxy proxy-1) (ca ca-2))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret request) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 586 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (5 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)) ((7 0) (5 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((7 0) (5 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (8 0))
  (label 586)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))</pre>

<p id="k587">Item <a href="#t0">587</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <path
   d='M 739.680 264.960 Q 392.820 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 491.268 862.355 342.816 1159.750'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 587 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (3 8)) ((6 0) (5 8))
    ((7 2) (0 1)) ((7 7) (6 0)))
  (leadsto ((1 0) (7 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (3 8))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-1 cookie-0) (3 8))
  (label 587)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k589">Item <a href="#t0">589</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 639.960 Q 591.228 862.355 442.776 1159.750'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 686.700 639.960 733.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 589 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (4 3))
    ((7 0) (4 8)) ((7 0) (6 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((6 7) (7 0))
    ((7 0) (4 8)) ((7 0) (6 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 8 7 server 1)
    (cat answer-1 cookie-0) (4 8))
  (label 589)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k628">Item <a href="#t0">628</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 491.848 862.787 244.017 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 486.780 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 628 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (label 628)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k629">Item <a href="#t0">629</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 491.848 862.787 244.017 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 586.740 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy) (ca ca))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 629 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (8 0)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((3 0) (8 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 3 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (label 629)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k630">Item <a href="#t0">630</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 114.960 Q 892.620 114.960 845.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 491.848 862.787 244.017 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 630 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (label 630)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k631">Item <a href="#t0">631</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 491.848 862.787 244.017 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 486.780 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 631 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (8 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (6 0)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((3 0) (6 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (label 631)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k632">Item <a href="#t0">632</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 491.848 862.787 244.017 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 586.740 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy) (ca ca))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 632 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((3 0) (6 0))
    ((3 0) (8 0)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (6 0)) ((3 0) (8 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 3 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (label 632)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k633">Item <a href="#t0">633</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 114.960 Q 892.620 114.960 845.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 491.848 862.787 244.017 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 633 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((3 0) (6 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (label 633)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k634">Item <a href="#t0">634</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 542.017 862.984 244.395 1161.008'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 114.960 Q 692.700 114.960 645.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 536.760 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 634 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (9 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (9 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 1 certauth 1)
    (enc proxy-2 (pubk proxy-2) (privk ca-2)) (9 0))
  (label 634)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k635">Item <a href="#t0">635</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 542.017 862.984 244.395 1161.008'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 114.960 Q 692.700 114.960 645.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 636.720 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy) (ca ca))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 635 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((3 0) (9 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (9 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 3 certauth 1)
    (enc proxy-2 (pubk proxy-2) (privk ca-2)) (9 0))
  (label 635)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k636">Item <a href="#t0">636</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 542.017 862.984 244.395 1161.008'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 114.960 Q 692.700 114.960 645.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 739.680 114.960 Q 836.640 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 636 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)) ((7 0) (9 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)) ((7 0) (9 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 7 certauth 1)
    (enc proxy-2 (pubk proxy-2) (privk ca-2)) (9 0))
  (label 636)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k637">Item <a href="#t0">637</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='1079.520pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 1079.520 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='1039.560' y1='114.960' x2='1039.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 1039.560 114.960 Q 992.580 114.960 945.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-2 (pubk proxy-2) (privk ca-2))</title>
   <circle style='fill: gray;' cx='1039.560' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-2))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-2) (enc proxy-2 (pubk proxy-2) (privk ca-2)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-2 (pubk proxy-2) (privk ca-2))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 542.017 862.984 244.395 1161.008'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 114.960 Q 692.700 114.960 645.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-2) (ca ca-2))</title>
   <text
    x='1039.560' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-2) (ca ca-2))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='539.760' y='39.960'
   style='text-anchor: middle;'>sbp 637 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 proxy-2 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-2) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-2) (ca ca-2))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-2 (pubk proxy-2) (privk ca-2)) (9 0))
  (label 637)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k667">Item <a href="#t0">667</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 491.848 862.787 244.017 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 342.840 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 486.780 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 667 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (label 667)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k668">Item <a href="#t0">668</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 491.848 862.787 244.017 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 342.840 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 586.740 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy) (ca ca))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 668 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (8 0)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((3 0) (8 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 3 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (label 668)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k669">Item <a href="#t0">669</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 114.960 Q 892.620 114.960 845.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 491.848 862.787 244.017 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 342.840 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 669 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)) ((6 2) (0 1))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (label 669)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k670">Item <a href="#t0">670</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 541.578 862.573 343.475 1160.187'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 586.740 639.960 633.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 536.760 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 670 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (8 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 7) (6 0))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (8 0)) ((4 0) (3 0))
    ((5 7) (6 0)) ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (label 670)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k671">Item <a href="#t0">671</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 541.578 862.573 343.475 1160.187'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 586.740 639.960 633.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 636.720 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 671 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((4 0) (8 0)) ((5 5) (0 4)) ((5 7) (6 0))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (8 0))
    ((5 7) (6 0)) ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (label 671)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k672">Item <a href="#t0">672</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 114.960 Q 892.620 114.960 845.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 541.578 862.573 343.475 1160.187'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 586.740 639.960 633.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 672 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 7) (6 0)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (6 0))
    ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (label 672)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k673">Item <a href="#t0">673</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <path
   d='M 839.640 264.960 Q 442.800 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 491.848 862.787 244.017 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 386.820 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 486.780 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 673 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 2) (0 1)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 9 proxy 8) request-3 (8 0))
  (label 673)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k674">Item <a href="#t0">674</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='1089.960' x2='839.640' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 1089.960 Q 592.707 1089.515 345.774 1164.070'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 1089.960 Q 586.740 1052.460 833.640 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 486.780 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 674 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((3 7) (8 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((3 7) (8 0))
    ((4 0) (3 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 3 proxy 8) request-3 (8 0))
  (label 674)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k675">Item <a href="#t0">675</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 686.700 602.460 833.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 486.780 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 675 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 7) (8 0))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((4 0) (3 0))
    ((5 7) (8 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 5 proxy 8) request-3 (8 0))
  (label 675)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k677">Item <a href="#t0">677</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <path
   d='M 839.640 264.960 Q 442.800 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 491.848 862.787 244.017 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 486.780 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 677 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (8 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (6 0)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 2) (0 1)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((3 0) (6 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 9 proxy 8) request-3 (8 0))
  (label 677)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k678">Item <a href="#t0">678</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='1089.960' x2='839.640' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 1089.960 Q 592.707 1089.515 345.774 1164.070'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 586.740 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 1089.960 Q 586.740 1052.460 833.640 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 678 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 7) (8 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (7 0)) ((5 5) (0 4))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((3 7) (8 0)) ((4 0) (3 0))
    ((4 0) (7 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 3 proxy 8) request-3 (8 0))
  (label 678)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k679">Item <a href="#t0">679</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 686.700 602.460 833.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 586.740 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 679 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((4 0) (7 0)) ((5 5) (0 4)) ((5 7) (8 0))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (7 0))
    ((5 7) (8 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 5 proxy 8) request-3 (8 0))
  (label 679)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k681">Item <a href="#t0">681</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='639.960' x2='539.760' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <path
   d='M 939.600 264.960 Q 492.780 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 542.017 862.984 244.395 1161.008'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 114.960 Q 692.700 114.960 645.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.740 639.960 545.760 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 492.180 675.660 444.599 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <path
   d='M 439.800 789.960 Q 342.840 752.460 245.880 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 241.544 749.964 43.287 1084.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 290.511 337.031 241.181 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1239.960 Q 142.920 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 286.860 77.460 433.800 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 536.760 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 236.880 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 138.702 374.718 237.444 634.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 681 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (9 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)) ((8 0) (2 8)) ((9 2) (0 1)) ((9 7) (8 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (9 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-1) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 10 proxy 8) request-3
    (9 0))
  (label 681)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-1) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k682">Item <a href="#t0">682</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='1089.960' x2='939.600' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 1089.960 Q 642.697 1089.588 345.794 1164.216'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 839.640 114.960 Q 792.660 114.960 745.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 1089.960 Q 636.720 1052.460 933.600 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 682 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 7) (9 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((3 7) (9 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 3 proxy 8) request-3
    (9 0))
  (label 682)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k683">Item <a href="#t0">683</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='639.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 641.977 862.984 344.355 1161.008'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <path
   d='M 839.640 114.960 Q 792.660 114.960 745.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 736.680 602.460 933.600 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 683 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 7) (9 0)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (9 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 5 proxy 8) request-3
    (9 0))
  (label 683)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k709">Item <a href="#t0">709</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 642.529 638.906 545.378 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 114.960 Q 592.740 114.960 545.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 292.860 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-1))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 536.760 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 709 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (8 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 0) (5 0)) ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((4 0) (3 0)) ((6 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (8 0))
  (label 709)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k710">Item <a href="#t0">710</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 642.529 638.906 545.378 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 114.960 Q 592.740 114.960 545.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 292.860 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-1))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 636.720 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 710 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (8 0)) ((5 9) (0 6))
    ((6 0) (5 0)) ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (8 0)) ((6 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (8 0))
  (label 710)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k711">Item <a href="#t0">711</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 642.529 638.906 545.378 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 114.960 Q 592.740 114.960 545.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 639.720 114.960 Q 736.680 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 292.860 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-1))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 711 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((6 0) (8 0)) ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((6 0) (8 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 6 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (8 0))
  (label 711)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k712">Item <a href="#t0">712</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 114.960 Q 892.620 114.960 845.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-2))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-2)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-2))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 642.529 638.906 545.378 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 114.960 Q 592.740 114.960 545.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 292.860 752.460 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-1))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 392.820 114.960 345.840 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.583 526.118 45.326 637.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='714.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-0) (ca ca-2))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-1) (proxy proxy-0) (ca ca-2))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (proxy proxy) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (proxy proxy) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 712 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 ca-1 proxy-0 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((7 0) (5 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (8 0))
  (label 712)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k723">Item <a href="#t0">723</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='1089.960' x2='839.640' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 1089.960 Q 592.707 1089.515 345.774 1164.070'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <path
   d='M 739.680 264.960 Q 392.820 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 1089.960 Q 586.740 1052.460 833.640 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 723 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((2 0) (5 0)) ((3 7) (8 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 2) (0 1)) ((7 7) (6 0)) ((8 0) (3 8)))
  (leadsto ((1 0) (7 0)) ((2 0) (5 0)) ((3 7) (8 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 3 proxy 8) request-3 (8 0))
  (label 723)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k724">Item <a href="#t0">724</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <path
   d='M 739.680 264.960 Q 392.820 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 686.700 602.460 833.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 724 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 5) (0 4)) ((5 7) (8 0)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 2) (0 1)) ((7 7) (6 0)) ((8 0) (3 8)))
  (leadsto ((1 0) (7 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (8 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 5 proxy 8) request-3 (8 0))
  (label 724)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k726">Item <a href="#t0">726</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <path
   d='M 839.640 264.960 Q 442.800 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 541.578 862.573 343.475 1160.187'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 639.960 Q 586.740 639.960 633.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 486.780 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 726 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (8 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 5) (0 4)) ((5 7) (6 0)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 0) (3 8)) ((8 2) (0 1)) ((8 7) (7 0)))
  (leadsto ((1 0) (8 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (6 0))
    ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 9 proxy 8) request-2 (8 0))
  (label 726)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k727">Item <a href="#t0">727</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='1089.960' x2='839.640' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 1089.960 Q 642.669 1089.407 445.697 1163.854'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 686.700 639.960 733.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 439.800 1089.960 Q 636.720 1052.460 833.640 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 727 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 7) (8 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (7 0))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((4 7) (8 0)) ((5 0) (4 0))
    ((6 7) (7 0)) ((7 0) (6 8)) ((8 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 4 proxy 8) request-2 (8 0))
  (label 727)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k729">Item <a href="#t0">729</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 591.228 862.355 442.776 1159.750'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 536.760 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 729 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (4 8)) ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0)) ((5 0) (4 0))
    ((7 0) (4 8)) ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 7 server 1)
    (cat answer-1 cookie-0) (4 8))
  (label 729)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k731">Item <a href="#t0">731</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 591.228 862.355 442.776 1159.750'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 586.740 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 731 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (4 8)) ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0)) ((5 0) (4 0))
    ((7 0) (4 8)) ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 7 server 1)
    (cat answer-1 cookie-0) (4 8))
  (label 731)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k733">Item <a href="#t0">733</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 591.228 862.355 442.776 1159.750'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 539.760 114.960 Q 686.700 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy) (ca ca-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 733 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((5 0) (8 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (4 8)) ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((5 0) (8 0))
    ((7 0) (4 8)) ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 7 server 1)
    (cat answer-1 cookie-0) (4 8))
  (label 733)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k735">Item <a href="#t0">735</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 114.960 Q 892.620 114.960 845.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-2))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-2)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-2))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 591.228 862.355 442.776 1159.750'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 iv-0 (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-2))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-2))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-0) (cookie cookie) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 735 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3)) ((7 0) (4 8))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((7 0) (4 8))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 7 server 1)
    (cat answer-1 cookie-0) (4 8))
  (label 735)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k825">Item <a href="#t0">825</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-2 (hash secret-1 challenge-2 id-2))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-2 (hash secret-1 challenge-2 id-2))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-2 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-2</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 486.780 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 586.740 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-2) (id id-2) (secret secret-1) (request request-3) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 825 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((2 0) (9 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((2 0) (9 0))
    ((4 0) (3 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (9 0))
  (label 825)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k826">Item <a href="#t0">826</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-2 (hash secret-1 challenge-2 id-2))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-2 (hash secret-1 challenge-2 id-2))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-2 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-2</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 686.700 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 486.780 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-2) (id id-2) (secret secret-1) (request request-3) (proxy proxy) (ca ca))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 826 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (9 0)) ((5 5) (0 4))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((4 0) (3 0))
    ((4 0) (9 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (9 0))
  (label 826)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k827">Item <a href="#t0">827</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='1079.520pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 1079.520 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='1039.560' y1='114.960' x2='1039.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 1039.560 114.960 Q 992.580 114.960 945.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='1039.560' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-2 (hash secret-1 challenge-2 id-2))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-2 (hash secret-1 challenge-2 id-2))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-2 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-2</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 486.780 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='1039.560' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-2) (id id-2) (secret secret-1) (request request-3) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='539.760' y='39.960'
   style='text-anchor: middle;'>sbp 827 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0))
    ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0))
    ((10 0) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (9 0))
  (label 827)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k828">Item <a href="#t0">828</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-2 (hash secret-1 challenge-2 id-2))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-2 (hash secret-1 challenge-2 id-2))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-2 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-2</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 586.740 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 586.740 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-2) (id id-2) (secret secret-1) (request request-3) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 828 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (9 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (7 0)) ((5 5) (0 4))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (9 0)) ((4 0) (3 0))
    ((4 0) (7 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (9 0))
  (label 828)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k829">Item <a href="#t0">829</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-2 (hash secret-1 challenge-2 id-2))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-2 (hash secret-1 challenge-2 id-2))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-2 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-2</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 586.740 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 686.700 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-2) (id id-2) (secret secret-1) (request request-3) (proxy proxy) (ca ca))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 829 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((4 0) (7 0)) ((4 0) (9 0)) ((5 5) (0 4))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (7 0))
    ((4 0) (9 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (9 0))
  (label 829)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k830">Item <a href="#t0">830</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='1079.520pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 1079.520 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='1039.560' y1='114.960' x2='1039.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 1039.560 114.960 Q 992.580 114.960 945.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='1039.560' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-2 (hash secret-1 challenge-2 id-2))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-2 (hash secret-1 challenge-2 id-2))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-2 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-2</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 586.740 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='1039.560' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-2) (id id-2) (secret secret-1) (request request-3) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='539.760' y='39.960'
   style='text-anchor: middle;'>sbp 830 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((4 0) (7 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0))
    ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (7 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0))
    ((10 0) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (9 0))
  (label 830)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k831">Item <a href="#t0">831</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='1079.520pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 1079.520 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='1039.560' y1='114.960' x2='1039.560' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='939.600' y1='639.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 1039.560 639.960 Q 992.580 639.960 945.600 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='1039.560' cy='639.960' r='6.000'/>
   </g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='1039.560' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-2 (hash secret-1 challenge-2 id-2))</title>
   <circle cx='1039.560' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-2 (hash secret-1 challenge-2 id-2))</title>
   <circle style='fill: blue;' cx='1039.560' cy='414.960' r='6.000'/>
   </g>
  <g><title>(enc secret-1 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='1039.560' cy='339.960' r='6.000'/>
   </g>
  <g>
   <title>(cat id-2 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='1039.560' cy='264.960' r='6.000'/></g>
  <g><title>challenge-2</title>
   <circle style='fill: blue;' cx='1039.560' cy='189.960' r='6.000'/>
   </g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='1039.560' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 939.600 639.960 Q 641.977 862.984 344.355 1161.008'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <path
   d='M 839.640 114.960 Q 792.660 114.960 745.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 636.720 77.460 1033.560 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-2) (id id-2) (secret secret-1) (request request-3) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='1039.560' y='77.460' style='text-anchor: middle;'>proxy</text>
   </g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='539.760' y='39.960'
   style='text-anchor: middle;'>sbp 831 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (10 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8))
    ((10 7) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (10 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8))
    ((10 7) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 11 2 certauth 1)
    (enc proxy-2 (pubk proxy-2) (privk ca-2)) (10 0))
  (label 831)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k832">Item <a href="#t0">832</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='1079.520pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 1079.520 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='1039.560' y1='114.960' x2='1039.560' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='939.600' y1='639.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 1039.560 639.960 Q 992.580 639.960 945.600 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='1039.560' cy='639.960' r='6.000'/>
   </g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='1039.560' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-2 (hash secret-1 challenge-2 id-2))</title>
   <circle cx='1039.560' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-2 (hash secret-1 challenge-2 id-2))</title>
   <circle style='fill: blue;' cx='1039.560' cy='414.960' r='6.000'/>
   </g>
  <g><title>(enc secret-1 (pubk proxy))</title>
   <circle style='fill: blue;' cx='1039.560' cy='339.960' r='6.000'/>
   </g>
  <g>
   <title>(cat id-2 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='1039.560' cy='264.960' r='6.000'/></g>
  <g><title>challenge-2</title>
   <circle style='fill: blue;' cx='1039.560' cy='189.960' r='6.000'/>
   </g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='1039.560' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 939.600 639.960 Q 641.977 862.984 344.355 1161.008'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <path
   d='M 839.640 114.960 Q 792.660 114.960 745.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 736.680 77.460 1033.560 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-2) (id id-2) (secret secret-1) (request request-3) (proxy proxy) (ca ca))</title>
   <text
    x='1039.560' y='77.460' style='text-anchor: middle;'>proxy</text>
   </g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='539.760' y='39.960'
   style='text-anchor: middle;'>sbp 832 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((4 0) (10 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8))
    ((10 7) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (10 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8))
    ((10 7) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 11 4 certauth 1)
    (enc proxy-2 (pubk proxy-2) (privk ca-2)) (10 0))
  (label 832)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k833">Item <a href="#t0">833</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='1079.520pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 1079.520 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='1039.560' y1='114.960' x2='1039.560' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='939.600' y1='639.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 1039.560 639.960 Q 992.580 639.960 945.600 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='1039.560' cy='639.960' r='6.000'/>
   </g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='1039.560' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-2 (hash secret-1 challenge-2 id-2))</title>
   <circle cx='1039.560' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-2 (hash secret-1 challenge-2 id-2))</title>
   <circle style='fill: blue;' cx='1039.560' cy='414.960' r='6.000'/>
   </g>
  <g><title>(enc secret-1 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='1039.560' cy='339.960' r='6.000'/>
   </g>
  <g>
   <title>(cat id-2 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='1039.560' cy='264.960' r='6.000'/></g>
  <g><title>challenge-2</title>
   <circle style='fill: blue;' cx='1039.560' cy='189.960' r='6.000'/>
   </g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='1039.560' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 939.600 639.960 Q 641.977 862.984 344.355 1161.008'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <path
   d='M 839.640 114.960 Q 792.660 114.960 745.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 839.640 114.960 Q 936.600 77.460 1033.560 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-2) (id id-2) (secret secret-1) (request request-3) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='1039.560' y='77.460' style='text-anchor: middle;'>proxy</text>
   </g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-1) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='539.760' y='39.960'
   style='text-anchor: middle;'>sbp 833 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((8 0) (10 0)) ((9 0) (3 8))
    ((10 7) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((8 0) (10 0)) ((9 0) (3 8))
    ((10 7) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 11 8 certauth 1)
    (enc proxy-2 (pubk proxy-2) (privk ca-2)) (10 0))
  (label 833)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k882">Item <a href="#t0">882</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <path
   d='M 739.680 264.960 Q 392.820 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 536.760 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 882 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((1 0) (9 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 2) (0 1)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (7 0)) ((1 0) (9 0)) ((2 0) (5 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (label 882)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k883">Item <a href="#t0">883</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <path
   d='M 739.680 264.960 Q 392.820 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 586.740 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 883 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((2 0) (5 0)) ((2 0) (9 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 2) (0 1)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (7 0)) ((2 0) (5 0)) ((2 0) (9 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (label 883)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k884">Item <a href="#t0">884</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <path
   d='M 739.680 264.960 Q 392.820 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 686.700 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy) (ca ca))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 884 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((4 0) (9 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 2) (0 1)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (7 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (9 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (label 884)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k885">Item <a href="#t0">885</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='1079.520pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 1079.520 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='1039.560' y1='114.960' x2='1039.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 1039.560 114.960 Q 992.580 114.960 945.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-2))</title>
   <circle style='fill: gray;' cx='1039.560' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-2)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-2))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <path
   d='M 739.680 264.960 Q 392.820 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-2))</title>
   <text
    x='1039.560' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-1) (ca ca-2))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='539.760' y='39.960'
   style='text-anchor: middle;'>sbp 885 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8)) ((7 2) (0 1))
    ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (leadsto ((1 0) (7 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (label 885)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k886">Item <a href="#t0">886</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 641.538 862.573 443.435 1160.187'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 686.700 639.960 733.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 586.740 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 886 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (9 0)) ((3 0) (6 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (7 0))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (9 0)) ((3 0) (6 0)) ((5 0) (4 0))
    ((6 7) (7 0)) ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (label 886)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k887">Item <a href="#t0">887</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 641.538 862.573 443.435 1160.187'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 686.700 639.960 733.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 636.720 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 887 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (9 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (7 0))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (9 0)) ((5 0) (4 0))
    ((6 7) (7 0)) ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 3 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (label 887)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k888">Item <a href="#t0">888</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 641.538 862.573 443.435 1160.187'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 686.700 639.960 733.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 539.760 114.960 Q 736.680 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy) (ca ca-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 888 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((5 0) (9 0)) ((6 5) (0 4)) ((6 7) (7 0))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((5 0) (9 0))
    ((6 7) (7 0)) ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 5 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (label 888)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k889">Item <a href="#t0">889</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='1079.520pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 1079.520 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='1039.560' y1='114.960' x2='1039.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 1039.560 114.960 Q 992.580 114.960 945.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-2))</title>
   <circle style='fill: gray;' cx='1039.560' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-2)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-2))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 641.538 862.573 443.435 1160.187'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 686.700 639.960 733.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((proxy proxy-1) (ca ca-2))</title>
   <text
    x='1039.560' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-2))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='539.760' y='39.960'
   style='text-anchor: middle;'>sbp 889 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((6 7) (7 0))
    ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (label 889)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k890">Item <a href="#t0">890</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <path
   d='M 939.600 264.960 Q 492.780 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 536.760 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 890 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((1 0) (9 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (3 8)) ((9 2) (0 1)) ((9 7) (8 0)))
  (leadsto ((1 0) (7 0)) ((1 0) (9 0)) ((2 0) (5 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 10 proxy 8) request-3
    (9 0))
  (label 890)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k891">Item <a href="#t0">891</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='1089.960' x2='939.600' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 1089.960 Q 692.667 1089.515 445.734 1164.070'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 439.800 1089.960 Q 686.700 1052.460 933.600 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 536.760 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 891 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0))
    ((4 7) (9 0)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0)) ((4 7) (9 0))
    ((5 0) (4 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 4 proxy 8) request-3
    (9 0))
  (label 891)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k892">Item <a href="#t0">892</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='639.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 691.769 862.787 443.937 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 786.660 602.460 933.600 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 536.760 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 892 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (9 0))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0)) ((5 0) (4 0))
    ((6 7) (9 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 6 proxy 8) request-3
    (9 0))
  (label 892)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k894">Item <a href="#t0">894</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <path
   d='M 939.600 264.960 Q 492.780 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 486.780 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 536.760 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 894 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (9 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (3 8)) ((9 2) (0 1)) ((9 7) (8 0)))
  (leadsto ((1 0) (9 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 10 proxy 8) request-3
    (9 0))
  (label 894)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k895">Item <a href="#t0">895</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='1089.960' x2='939.600' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 1089.960 Q 692.667 1089.515 445.734 1164.070'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 439.800 1089.960 Q 686.700 1052.460 933.600 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 586.740 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 895 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0))
    ((4 7) (9 0)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0)) ((4 7) (9 0))
    ((5 0) (4 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 4 proxy 8) request-3
    (9 0))
  (label 895)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k896">Item <a href="#t0">896</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='639.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 691.769 862.787 443.937 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 786.660 602.460 933.600 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 114.960 Q 586.740 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 896 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (9 0))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0)) ((5 0) (4 0))
    ((6 7) (9 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 6 proxy 8) request-3
    (9 0))
  (label 896)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k898">Item <a href="#t0">898</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='639.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 892.620 639.960 845.640 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='939.600' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='939.600' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='939.600' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-1 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='939.600' cy='339.960' r='6.000'/></g>
  <path
   d='M 939.600 264.960 Q 492.780 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-1 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 591.809 862.787 343.977 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 114.960 Q 586.740 77.460 733.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 536.760 77.460 933.600 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy) (ca ca))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 898 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (9 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((4 0) (7 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (3 8)) ((9 2) (0 1)) ((9 7) (8 0)))
  (leadsto ((1 0) (9 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (7 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 10 proxy 8) request-3
    (9 0))
  (label 898)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k899">Item <a href="#t0">899</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='1089.960' x2='939.600' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 1089.960 Q 692.667 1089.515 445.734 1164.070'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 539.760 114.960 Q 686.700 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 439.800 1089.960 Q 686.700 1052.460 933.600 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy) (ca ca-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 899 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 7) (9 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((5 0) (8 0)) ((6 5) (0 4))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((4 7) (9 0)) ((5 0) (4 0))
    ((5 0) (8 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 4 proxy 8) request-3
    (9 0))
  (label 899)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k900">Item <a href="#t0">900</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='639.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 639.960 Q 691.769 862.787 443.937 1160.614'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 786.660 602.460 933.600 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 539.760 114.960 Q 686.700 77.460 833.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy) (ca ca-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 900 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((5 0) (8 0)) ((6 5) (0 4)) ((6 7) (9 0))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((5 0) (8 0))
    ((6 7) (9 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 6 proxy 8) request-3
    (9 0))
  (label 900)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k902">Item <a href="#t0">902</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='1079.520pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 1079.520 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='1039.560' y1='114.960' x2='1039.560' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='939.600' y1='639.960' x2='939.600' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='639.960' x2='639.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 1039.560 639.960 Q 992.580 639.960 945.600 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='1039.560' cy='639.960' r='6.000'/>
   </g>
  <g><title>request-3</title>
   <circle style='fill: blue;' cx='1039.560' cy='564.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-1 (hash secret-1 challenge-1 id-1))</title>
   <circle cx='1039.560' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-1 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='1039.560' cy='414.960' r='6.000'/>
   </g>
  <g><title>(enc secret-1 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='1039.560' cy='339.960' r='6.000'/>
   </g>
  <path
   d='M 1039.560 264.960 Q 542.760 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-2)))</title>
   <circle cx='1039.560' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='1039.560' cy='189.960' r='6.000'/>
   </g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-2))</title>
   <circle style='fill: gray;' cx='1039.560' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 939.600 639.960 Q 641.977 862.984 344.355 1161.008'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='939.600' cy='639.960' r='6.000'/></g>
  <path
   d='M 839.640 114.960 Q 792.660 114.960 745.680 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.700 639.960 645.720 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='739.680' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-0 (hash secret-0 challenge-0 id-0))</title>
   <circle cx='739.680' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret-0 challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 592.140 675.660 544.559 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <path
   d='M 539.760 789.960 Q 442.800 752.460 345.840 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge id))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 291.780 750.155 43.800 1085.350'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 114.960 Q 390.471 337.031 341.141 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1239.960 Q 192.900 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))</title>
   <circle cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 386.820 77.460 533.760 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 586.740 77.460 1033.560 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-2))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge id))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge (hash secret challenge id))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 286.860 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id (hash secret challenge id))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-1))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-2)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 188.236 374.964 336.513 634.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-1) (request request-3) (proxy proxy-1) (ca ca-2))</title>
   <text
    x='1039.560' y='77.460' style='text-anchor: middle;'>proxy</text>
   </g>
  <g>
   <title>((request request-3) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret-0) (request request-2) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-1) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-1) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-1) (ca ca-2))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-1) (ca ca-2))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='539.760' y='39.960'
   style='text-anchor: middle;'>sbp 902 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-1) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (10 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)) ((9 0) (3 8)) ((10 2) (0 1)) ((10 7) (9 0)))
  (leadsto ((1 0) (10 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy-1) (privk ca-2))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 11 proxy 8) request-3
    (10 0))
  (label 902)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-1) (ca ca-2) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))</pre>

<p id="k903">Item <a href="#t0">903</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='1079.520pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 1079.520 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='1039.560' y1='1089.960' x2='1039.560' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 1039.560 1089.960 Q 742.657 1089.588 445.754 1164.216'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='1039.560' cy='1089.960' r='6.000'/>
   </g>
  <path
   d='M 939.600 114.960 Q 892.620 114.960 845.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-2))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-2)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-2))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 439.800 1089.960 Q 736.680 1052.460 1033.560 1089.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='1039.560' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-1) (ca ca-2))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-2))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='539.760' y='39.960'
   style='text-anchor: middle;'>sbp 903 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 7) (10 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((4 7) (10 0)) ((5 0) (4 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 11 4 proxy 8) request-3
    (10 0))
  (label 903)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

<p id="k904">Item <a href="#t0">904</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='1079.520pt' height='1279.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 1079.520 1279.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='1039.560' y1='639.960' x2='1039.560' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='639.960' x2='739.680' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 1039.560 639.960 Q 741.937 862.984 444.315 1161.008'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='1039.560' cy='639.960' r='6.000'/>
   </g>
  <path
   d='M 939.600 114.960 Q 892.620 114.960 845.640 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-2))</title>
   <circle style='fill: gray;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 639.960 Q 792.660 639.960 745.680 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='839.640' cy='639.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: blue;' cx='839.640' cy='564.960' r='6.000'/></g>
  <g><title>(enc challenge-1 (hash secret-0 challenge-1 id-1))</title>
   <circle cx='839.640' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-1 (hash secret-0 challenge-1 id-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret-0 (pubk proxy-1))</title>
   <circle style='fill: blue;' cx='839.640' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-1 (pubk proxy-1) (enc proxy-1 (pubk proxy-1) (privk ca-2)))</title>
   <circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>challenge-1</title>
   <circle style='fill: blue;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-1 (pubk proxy-1) (privk ca-2))</title>
   <circle style='fill: gray;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 639.960 Q 692.100 675.660 644.519 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='639.960' r='6.000'/></g>
  <path
   d='M 639.720 789.960 Q 542.760 752.460 445.800 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-0 secret (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))</title>
   <circle cx='639.720' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <path
   d='M 639.720 639.960 Q 836.640 602.460 1033.560 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: blue;' cx='639.720' cy='564.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 341.961 750.338 44.202 1085.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 490.431 337.031 441.101 559.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1239.960 Q 242.880 1202.460 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat answer-1 iv-0 (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle cx='439.800' cy='1239.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: blue;' cx='439.800' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(enc secret (pubk proxy))</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))</title>
   <circle cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>challenge-0</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(enc proxy (pubk proxy) (privk ca-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 114.960 Q 486.780 77.460 633.720 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 192.900 114.960 145.920 114.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>challenge</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc proxy-0 (pubk proxy-0) (privk ca))</title>
   <circle style='fill: gray;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(cat answer iv (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>request</title><circle cx='39.960' cy='1164.960' r='6.000'/>
   </g>
  <g><title>(enc challenge-0 (hash secret challenge-0 id-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='1089.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 336.840 377.460 633.720 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc id-0 (hash secret challenge-0 id-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc secret (pubk proxy-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat id-0 (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 237.887 375.217 435.815 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>challenge-0</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-1) (cookie cookie-0))</title>
   <text
    x='1039.560' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((proxy proxy-1) (ca ca-2))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-1) (id id-1) (secret secret-0) (request request-2) (proxy proxy-1) (ca ca-2))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-1) (iv secret) (answer answer-0) (cookie cookie) (syskey syskey-0) (proxy proxy-0) (ca ca-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy) (ca ca-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0) (syskey syskey) (proxy proxy) (ca ca-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((proxy proxy-0) (ca ca-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g><title>((proxy proxy-0) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>certauth</text>
   </g>
  <g>
   <title>((challenge challenge) (id id) (proxy proxy-0) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((challenge challenge-0) (id id-0) (secret secret) (request request) (iv iv) (answer answer) (cookie cookie-0) (syskey syskey) (proxy proxy-0) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='539.760' y='39.960'
   style='text-anchor: middle;'>sbp 904 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (10 0)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((6 7) (10 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 11 6 proxy 8) request-3
    (10 0))
  (label 904)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))</pre>

</body>
</html>
