<?xml version="1.0"?>
<!-- CPSA 3.6.6 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Session Binding Protocol (SBP)</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;Extracted shapes&quot;)
(herald &quot;Session Binding Protocol (SBP)&quot;)
(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;All input read from sbp.lsp&quot;)</pre>

<p id="t0">Tree 0.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='15829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 15829.920' font-size='12.000'>
  <text
   x='89.880' y='15776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k715&quot;, &quot;_self&quot;)'>715</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='15789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k714&quot;, &quot;_self&quot;)'>714</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='15714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k713&quot;, &quot;_self&quot;)'>713</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='15639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k712&quot;, &quot;_self&quot;)'>712</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='15564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k710&quot;, &quot;_self&quot;)'>710</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='15489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k703&quot;, &quot;_self&quot;)'>703</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='15414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k702&quot;, &quot;_self&quot;)'>702</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='15339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k701&quot;, &quot;_self&quot;)'>701</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='15264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k700&quot;, &quot;_self&quot;)'>700</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='15189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k698&quot;, &quot;_self&quot;)'>698</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='15114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='15026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k691&quot;, &quot;_self&quot;)'>691</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='15039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k690&quot;, &quot;_self&quot;)'>690</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='14964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k689&quot;, &quot;_self&quot;)'>689</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='14889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k688&quot;, &quot;_self&quot;)'>688</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='14814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14726.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k686&quot;, &quot;_self&quot;)'>686</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='14739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k661&quot;, &quot;_self&quot;)'>661</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='14664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k660&quot;, &quot;_self&quot;)'>660</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='14589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k659&quot;, &quot;_self&quot;)'>659</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='14514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k658&quot;, &quot;_self&quot;)'>658</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='14439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k657&quot;, &quot;_self&quot;)'>657</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='14364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14276.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k655&quot;, &quot;_self&quot;)'>655</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='14289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k651&quot;, &quot;_self&quot;)'>651</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='14214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k648&quot;, &quot;_self&quot;)'>648</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='14139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='14051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k647&quot;, &quot;_self&quot;)'>647</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='14064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k646&quot;, &quot;_self&quot;)'>646</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='13989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k645&quot;, &quot;_self&quot;)'>645</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='13914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k643&quot;, &quot;_self&quot;)'>643</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='13839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k640&quot;, &quot;_self&quot;)'>640</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='13764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k639&quot;, &quot;_self&quot;)'>639</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='13689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k638&quot;, &quot;_self&quot;)'>638</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='13614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k637&quot;, &quot;_self&quot;)'>637</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='13539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k635&quot;, &quot;_self&quot;)'>635</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='13464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k632&quot;, &quot;_self&quot;)'>632</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='13389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k631&quot;, &quot;_self&quot;)'>631</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='13314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k630&quot;, &quot;_self&quot;)'>630</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='13239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k629&quot;, &quot;_self&quot;)'>629</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='13164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k627&quot;, &quot;_self&quot;)'>627</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='13089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='13001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k624&quot;, &quot;_self&quot;)'>624</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='13014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k623&quot;, &quot;_self&quot;)'>623</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='12939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k622&quot;, &quot;_self&quot;)'>622</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='12864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k621&quot;, &quot;_self&quot;)'>621</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='12789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k619&quot;, &quot;_self&quot;)'>619</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='12714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k609&quot;, &quot;_self&quot;)'>609</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='12639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k605&quot;, &quot;_self&quot;)'>605</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='12564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k602&quot;, &quot;_self&quot;)'>602</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='12489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k599&quot;, &quot;_self&quot;)'>599</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='12414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k596&quot;, &quot;_self&quot;)'>596</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='12339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k593&quot;, &quot;_self&quot;)'>593</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='12264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k582&quot;, &quot;_self&quot;)'>582</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='12189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k581&quot;, &quot;_self&quot;)'>581</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='12114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='12026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k580&quot;, &quot;_self&quot;)'>580</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='12039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k579&quot;, &quot;_self&quot;)'>579</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='11964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k578&quot;, &quot;_self&quot;)'>578</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='11889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k577&quot;, &quot;_self&quot;)'>577</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='11814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11726.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k576&quot;, &quot;_self&quot;)'>576</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='11739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k575&quot;, &quot;_self&quot;)'>575</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='11664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k536&quot;, &quot;_self&quot;)'>536</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='11589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k535&quot;, &quot;_self&quot;)'>535</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='11514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k530&quot;, &quot;_self&quot;)'>530</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='11439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k529&quot;, &quot;_self&quot;)'>529</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='11364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11276.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k525&quot;, &quot;_self&quot;)'>525</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='11289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k524&quot;, &quot;_self&quot;)'>524</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='11214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k522&quot;, &quot;_self&quot;)'>522</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='11139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='11051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k521&quot;, &quot;_self&quot;)'>521</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='11064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k517&quot;, &quot;_self&quot;)'>517</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='10989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k516&quot;, &quot;_self&quot;)'>516</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='10914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k509&quot;, &quot;_self&quot;)'>509</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='10839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k508&quot;, &quot;_self&quot;)'>508</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='10764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k494&quot;, &quot;_self&quot;)'>494</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='10689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k493&quot;, &quot;_self&quot;)'>493</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='10614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k485&quot;, &quot;_self&quot;)'>485</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='10539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k484&quot;, &quot;_self&quot;)'>484</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='10464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k480&quot;, &quot;_self&quot;)'>480</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='10389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k478&quot;, &quot;_self&quot;)'>478</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='10314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k477&quot;, &quot;_self&quot;)'>477</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='10239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k471&quot;, &quot;_self&quot;)'>471</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='10164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k470&quot;, &quot;_self&quot;)'>470</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='10089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='10001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k461&quot;, &quot;_self&quot;)'>461</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='10014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k460&quot;, &quot;_self&quot;)'>460</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='9939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k455&quot;, &quot;_self&quot;)'>455</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='9864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k454&quot;, &quot;_self&quot;)'>454</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='9789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k446&quot;, &quot;_self&quot;)'>446</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='9714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k445&quot;, &quot;_self&quot;)'>445</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='9639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k444&quot;, &quot;_self&quot;)'>444</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='9564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k443&quot;, &quot;_self&quot;)'>443</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='9489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k441&quot;, &quot;_self&quot;)'>441</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='9414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k437&quot;, &quot;_self&quot;)'>437</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='9339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k434&quot;, &quot;_self&quot;)'>434</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='9264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k433&quot;, &quot;_self&quot;)'>433</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='9189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k432&quot;, &quot;_self&quot;)'>432</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='9114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='9026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k430&quot;, &quot;_self&quot;)'>430</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='9039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k424&quot;, &quot;_self&quot;)'>424</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='8964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k423&quot;, &quot;_self&quot;)'>423</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='8889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k422&quot;, &quot;_self&quot;)'>422</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='8814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8726.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k420&quot;, &quot;_self&quot;)'>420</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='8739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k415&quot;, &quot;_self&quot;)'>415</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='8664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k414&quot;, &quot;_self&quot;)'>414</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='8589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k407&quot;, &quot;_self&quot;)'>407</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='8514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k406&quot;, &quot;_self&quot;)'>406</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='8439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k405&quot;, &quot;_self&quot;)'>405</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='8364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8276.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k403&quot;, &quot;_self&quot;)'>403</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='8289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k382&quot;, &quot;_self&quot;)'>382</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='8214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k368&quot;, &quot;_self&quot;)'>368</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='8139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='8051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k359&quot;, &quot;_self&quot;)'>359</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='8064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k349&quot;, &quot;_self&quot;)'>349</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='7989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k348&quot;, &quot;_self&quot;)'>348</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='7914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k347&quot;, &quot;_self&quot;)'>347</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='7839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k346&quot;, &quot;_self&quot;)'>346</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='7764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k344&quot;, &quot;_self&quot;)'>344</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='7689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k340&quot;, &quot;_self&quot;)'>340</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='7614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k337&quot;, &quot;_self&quot;)'>337</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='7539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k336&quot;, &quot;_self&quot;)'>336</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='7464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k335&quot;, &quot;_self&quot;)'>335</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='7389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k333&quot;, &quot;_self&quot;)'>333</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='7314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k327&quot;, &quot;_self&quot;)'>327</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='7239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k326&quot;, &quot;_self&quot;)'>326</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='7164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k325&quot;, &quot;_self&quot;)'>325</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='7089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='7001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k323&quot;, &quot;_self&quot;)'>323</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='7014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k317&quot;, &quot;_self&quot;)'>317</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='6939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k316&quot;, &quot;_self&quot;)'>316</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='6864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k315&quot;, &quot;_self&quot;)'>315</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='6789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k313&quot;, &quot;_self&quot;)'>313</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='6714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k292&quot;, &quot;_self&quot;)'>292</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='6639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k291&quot;, &quot;_self&quot;)'>291</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='6564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k290&quot;, &quot;_self&quot;)'>290</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='6489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k289&quot;, &quot;_self&quot;)'>289</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='6414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k287&quot;, &quot;_self&quot;)'>287</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='6339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k283&quot;, &quot;_self&quot;)'>283</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='6264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k280&quot;, &quot;_self&quot;)'>280</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='6189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k279&quot;, &quot;_self&quot;)'>279</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='6114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='6026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k278&quot;, &quot;_self&quot;)'>278</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='6039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k276&quot;, &quot;_self&quot;)'>276</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='5964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k273&quot;, &quot;_self&quot;)'>273</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='5889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k272&quot;, &quot;_self&quot;)'>272</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='5814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5726.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k271&quot;, &quot;_self&quot;)'>271</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='5739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k269&quot;, &quot;_self&quot;)'>269</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='5664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k266&quot;, &quot;_self&quot;)'>266</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='5589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k265&quot;, &quot;_self&quot;)'>265</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='5514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k264&quot;, &quot;_self&quot;)'>264</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='5439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k262&quot;, &quot;_self&quot;)'>262</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='5364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5276.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k253&quot;, &quot;_self&quot;)'>253</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='5289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k249&quot;, &quot;_self&quot;)'>249</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='5214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k246&quot;, &quot;_self&quot;)'>246</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='5139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='5051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k243&quot;, &quot;_self&quot;)'>243</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='5064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k240&quot;, &quot;_self&quot;)'>240</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='4989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k230&quot;, &quot;_self&quot;)'>230</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='4914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k229&quot;, &quot;_self&quot;)'>229</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='4839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k228&quot;, &quot;_self&quot;)'>228</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='4764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k227&quot;, &quot;_self&quot;)'>227</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='4689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k226&quot;, &quot;_self&quot;)'>226</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='4614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k225&quot;, &quot;_self&quot;)'>225</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='4539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k224&quot;, &quot;_self&quot;)'>224</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='4464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k207&quot;, &quot;_self&quot;)'>207</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='4389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k194&quot;, &quot;_self&quot;)'>194</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='4314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k185&quot;, &quot;_self&quot;)'>185</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='4239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k184&quot;, &quot;_self&quot;)'>184</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='4164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k183&quot;, &quot;_self&quot;)'>183</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='4089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='4001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k181&quot;, &quot;_self&quot;)'>181</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='4014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k177&quot;, &quot;_self&quot;)'>177</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='3939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k174&quot;, &quot;_self&quot;)'>174</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='3864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k173&quot;, &quot;_self&quot;)'>173</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='3789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k171&quot;, &quot;_self&quot;)'>171</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='3714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k166&quot;, &quot;_self&quot;)'>166</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='3639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k165&quot;, &quot;_self&quot;)'>165</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='3564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k163&quot;, &quot;_self&quot;)'>163</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='3489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k146&quot;, &quot;_self&quot;)'>146</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='3414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k145&quot;, &quot;_self&quot;)'>145</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='3339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k144&quot;, &quot;_self&quot;)'>144</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='3264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k142&quot;, &quot;_self&quot;)'>142</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='3189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k138&quot;, &quot;_self&quot;)'>138</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='3114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='3026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k135&quot;, &quot;_self&quot;)'>135</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='3039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k134&quot;, &quot;_self&quot;)'>134</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='2964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k132&quot;, &quot;_self&quot;)'>132</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='2889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k129&quot;, &quot;_self&quot;)'>129</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='2814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2726.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k128&quot;, &quot;_self&quot;)'>128</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='2739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k126&quot;, &quot;_self&quot;)'>126</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='2664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k118&quot;, &quot;_self&quot;)'>118</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='2589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k114&quot;, &quot;_self&quot;)'>114</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='2514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k111&quot;, &quot;_self&quot;)'>111</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='2439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k108&quot;, &quot;_self&quot;)'>108</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='2364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2276.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k99&quot;, &quot;_self&quot;)'>99</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='2289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k98&quot;, &quot;_self&quot;)'>98</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='2214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k97&quot;, &quot;_self&quot;)'>97</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='2139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k96&quot;, &quot;_self&quot;)'>96</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='2064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k95&quot;, &quot;_self&quot;)'>95</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='1989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k94&quot;, &quot;_self&quot;)'>94</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='1914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1826.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k80&quot;, &quot;_self&quot;)'>80</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k79&quot;, &quot;_self&quot;)'>79</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='1764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k77&quot;, &quot;_self&quot;)'>77</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k73&quot;, &quot;_self&quot;)'>73</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k70&quot;, &quot;_self&quot;)'>70</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k68&quot;, &quot;_self&quot;)'>68</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k61&quot;, &quot;_self&quot;)'>61</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k57&quot;, &quot;_self&quot;)'>57</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k54&quot;, &quot;_self&quot;)'>54</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k46&quot;, &quot;_self&quot;)'>46</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k45&quot;, &quot;_self&quot;)'>45</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k44&quot;, &quot;_self&quot;)'>44</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k43&quot;, &quot;_self&quot;)'>43</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k42&quot;, &quot;_self&quot;)'>42</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k35&quot;, &quot;_self&quot;)'>35</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k31&quot;, &quot;_self&quot;)'>31</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k24&quot;, &quot;_self&quot;)'>24</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k23&quot;, &quot;_self&quot;)'>23</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k22&quot;, &quot;_self&quot;)'>22</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k21&quot;, &quot;_self&quot;)'>21</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k14&quot;, &quot;_self&quot;)'>14</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k13&quot;, &quot;_self&quot;)'>13</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k12&quot;, &quot;_self&quot;)'>12</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8&quot;, &quot;_self&quot;)'>8</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7&quot;, &quot;_self&quot;)'>7</text>
  <line
   x1='39.960' y1='7914.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='7901.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol sbp basic
  (defrole client
    (vars (request request2 answer answer2 cookie syskey data)
      (client proxy name))
    (trace (send (cat client request))
      (recv
        (cat client answer
          (enc cookie (hash syskey (ltk client proxy)))))
      (send
        (cat client request2
          (enc cookie (hash syskey (ltk client proxy)))))
      (recv (cat client answer2))))
  (defrole proxy
    (vars (request request2 answer answer2 cookie syskey data)
      (client proxy name))
    (trace (recv (cat client request)) (init request)
      (obsv (cat answer cookie))
      (send
        (cat client answer
          (enc cookie (hash syskey (ltk client proxy)))))
      (recv
        (cat client request2
          (enc cookie (hash syskey (ltk client proxy)))))
      (init (cat request2 cookie)) (obsv answer2)
      (send (cat client answer2))))
  (defrole server
    (vars (request request2 answer answer2 cookie data))
    (trace (tran request (cat answer cookie))
      (tran (cat request2 cookie) answer2))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Children: <a href="#k7">7</a> <a href="#k8">8</a> <a href="#k12">12</a> <a href="#k13">13</a> <a href="#k14">14</a> <a href="#k21">21</a> <a href="#k22">22</a> <a href="#k23">23</a> <a href="#k24">24</a> <a href="#k31">31</a> <a href="#k35">35</a> <a href="#k42">42</a> <a href="#k43">43</a> <a href="#k44">44</a> <a href="#k45">45</a> <a href="#k46">46</a> <a href="#k54">54</a> <a href="#k57">57</a> <a href="#k61">61</a> <a href="#k68">68</a> <a href="#k70">70</a> <a href="#k73">73</a> <a href="#k77">77</a> <a href="#k79">79</a> <a href="#k80">80</a> <a href="#k94">94</a> <a href="#k95">95</a> <a href="#k96">96</a> <a href="#k97">97</a> <a href="#k98">98</a> <a href="#k99">99</a> <a href="#k108">108</a> <a href="#k111">111</a> <a href="#k114">114</a> <a href="#k118">118</a> <a href="#k126">126</a> <a href="#k128">128</a> <a href="#k129">129</a> <a href="#k132">132</a> <a href="#k134">134</a> <a href="#k135">135</a> <a href="#k138">138</a> <a href="#k142">142</a> <a href="#k144">144</a> <a href="#k145">145</a> <a href="#k146">146</a> <a href="#k163">163</a> <a href="#k165">165</a> <a href="#k166">166</a> <a href="#k171">171</a> <a href="#k173">173</a> <a href="#k174">174</a> <a href="#k177">177</a> <a href="#k181">181</a> <a href="#k183">183</a> <a href="#k184">184</a> <a href="#k185">185</a> <a href="#k194">194</a> <a href="#k207">207</a> <a href="#k224">224</a> <a href="#k225">225</a> <a href="#k226">226</a> <a href="#k227">227</a> <a href="#k228">228</a> <a href="#k229">229</a> <a href="#k230">230</a> <a href="#k240">240</a> <a href="#k243">243</a> <a href="#k246">246</a> <a href="#k249">249</a> <a href="#k253">253</a> <a href="#k262">262</a> <a href="#k264">264</a> <a href="#k265">265</a> <a href="#k266">266</a> <a href="#k269">269</a> <a href="#k271">271</a> <a href="#k272">272</a> <a href="#k273">273</a> <a href="#k276">276</a> <a href="#k278">278</a> <a href="#k279">279</a> <a href="#k280">280</a> <a href="#k283">283</a> <a href="#k287">287</a> <a href="#k289">289</a> <a href="#k290">290</a> <a href="#k291">291</a> <a href="#k292">292</a> <a href="#k313">313</a> <a href="#k315">315</a> <a href="#k316">316</a> <a href="#k317">317</a> <a href="#k323">323</a> <a href="#k325">325</a> <a href="#k326">326</a> <a href="#k327">327</a> <a href="#k333">333</a> <a href="#k335">335</a> <a href="#k336">336</a> <a href="#k337">337</a> <a href="#k340">340</a> <a href="#k344">344</a> <a href="#k346">346</a> <a href="#k347">347</a> <a href="#k348">348</a> <a href="#k349">349</a> <a href="#k359">359</a> <a href="#k368">368</a> <a href="#k382">382</a> <a href="#k403">403</a> <a href="#k405">405</a> <a href="#k406">406</a> <a href="#k407">407</a> <a href="#k414">414</a> <a href="#k415">415</a> <a href="#k420">420</a> <a href="#k422">422</a> <a href="#k423">423</a> <a href="#k424">424</a> <a href="#k430">430</a> <a href="#k432">432</a> <a href="#k433">433</a> <a href="#k434">434</a> <a href="#k437">437</a> <a href="#k441">441</a> <a href="#k443">443</a> <a href="#k444">444</a> <a href="#k445">445</a> <a href="#k446">446</a> <a href="#k454">454</a> <a href="#k455">455</a> <a href="#k460">460</a> <a href="#k461">461</a> <a href="#k470">470</a> <a href="#k471">471</a> <a href="#k477">477</a> <a href="#k478">478</a> <a href="#k480">480</a> <a href="#k484">484</a> <a href="#k485">485</a> <a href="#k493">493</a> <a href="#k494">494</a> <a href="#k508">508</a> <a href="#k509">509</a> <a href="#k516">516</a> <a href="#k517">517</a> <a href="#k521">521</a> <a href="#k522">522</a> <a href="#k524">524</a> <a href="#k525">525</a> <a href="#k529">529</a> <a href="#k530">530</a> <a href="#k535">535</a> <a href="#k536">536</a> <a href="#k575">575</a> <a href="#k576">576</a> <a href="#k577">577</a> <a href="#k578">578</a> <a href="#k579">579</a> <a href="#k580">580</a> <a href="#k581">581</a> <a href="#k582">582</a> <a href="#k593">593</a> <a href="#k596">596</a> <a href="#k599">599</a> <a href="#k602">602</a> <a href="#k605">605</a> <a href="#k609">609</a> <a href="#k619">619</a> <a href="#k621">621</a> <a href="#k622">622</a> <a href="#k623">623</a> <a href="#k624">624</a> <a href="#k627">627</a> <a href="#k629">629</a> <a href="#k630">630</a> <a href="#k631">631</a> <a href="#k632">632</a> <a href="#k635">635</a> <a href="#k637">637</a> <a href="#k638">638</a> <a href="#k639">639</a> <a href="#k640">640</a> <a href="#k643">643</a> <a href="#k645">645</a> <a href="#k646">646</a> <a href="#k647">647</a> <a href="#k648">648</a> <a href="#k651">651</a> <a href="#k655">655</a> <a href="#k657">657</a> <a href="#k658">658</a> <a href="#k659">659</a> <a href="#k660">660</a> <a href="#k661">661</a> <a href="#k686">686</a> <a href="#k688">688</a> <a href="#k689">689</a> <a href="#k690">690</a> <a href="#k691">691</a> <a href="#k698">698</a> <a href="#k700">700</a> <a href="#k701">701</a> <a href="#k702">702</a> <a href="#k703">703</a> <a href="#k710">710</a> <a href="#k712">712</a> <a href="#k713">713</a> <a href="#k714">714</a> <a href="#k715">715</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>sbp 0</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (syskey request request2 answer answer2 cookie data)
    (client proxy name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (non-orig syskey)
  (label 0)
  (unrealized (0 1))
  (origs)
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k7">Item <a href="#t0">7</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 192.300 225.660 144.719 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>sbp 7 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      data) (client proxy name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((1 1) (2 0)) ((1 3) (0 1)) ((2 0) (1 2)))
  (leadsto ((1 1) (2 0)) ((2 0) (1 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 3 1 proxy 2) request-1 (2 0))
  (label 7)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k8">Item <a href="#t0">8</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.300 225.660 144.719 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 8 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      request-1 data) (client proxy client-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-1) (client client-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-1 (2 0))
  (label 8)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k12">Item <a href="#t0">12</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.260 225.660 244.679 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 12 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie data)
    (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((1 1) (3 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2)))
  (leadsto ((1 1) (3 0)) ((2 5) (1 2)) ((3 0) (2 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 4 1 proxy 2) request-2 (3 0))
  (label 12)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k13">Item <a href="#t0">13</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.260 225.660 244.679 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 13 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie data)
    (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 1) (3 0)) ((2 5) (1 2)) ((3 0) (2 2)))
  (leadsto ((2 1) (3 0)) ((2 5) (1 2)) ((3 0) (2 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 4 2 proxy 2) request-2 (3 0))
  (label 13)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k14">Item <a href="#t0">14</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.260 225.660 244.679 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 14 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie request-2 data)
    (client proxy client-0 proxy-0 client-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-2) (client client-1))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0)))
  (leadsto ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (3 0))
  (label 14)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k21">Item <a href="#t0">21</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.220 225.660 344.639 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 21 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      data) (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)))
  (leadsto ((1 1) (4 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 5 1 proxy 2) request-3 (4 0))
  (label 21)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k22">Item <a href="#t0">22</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.220 225.660 344.639 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 22 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      data) (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 1) (4 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)))
  (leadsto ((2 1) (4 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 5 2 proxy 2) request-3 (4 0))
  (label 22)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k23">Item <a href="#t0">23</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.220 225.660 344.639 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 386.820 189.960 433.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 23 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      data) (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (4 0)) ((3 5) (2 2))
    ((4 0) (3 2)))
  (leadsto ((2 5) (1 2)) ((3 1) (4 0)) ((3 5) (2 2)) ((4 0) (3 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 5 3 proxy 2) request-3 (4 0))
  (label 23)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k24">Item <a href="#t0">24</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.220 225.660 344.639 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 24 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      request-3 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-3) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-3) (client client-2))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2)) ((5 1) (4 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (4 0))
  (label 24)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k31">Item <a href="#t0">31</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>sbp 31 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 cookie-0 data) (client proxy name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((1 1) (3 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)))
  (leadsto ((1 1) (3 0)) ((2 0) (1 2)) ((3 0) (3 1)) ((3 1) (2 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 4 3 server 1)
    (cat answer-2 cookie-0) (3 1))
  (label 31)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k35">Item <a href="#t0">35</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 35 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 cookie-0 data)
    (client proxy client-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (leadsto ((2 0) (1 2)) ((3 0) (3 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 5 3 server 1)
    (cat answer-2 cookie-0) (3 1))
  (label 35)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k42">Item <a href="#t0">42</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 42 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((1 1) (5 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)))
  (leadsto ((1 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 1 proxy 2) request-4 (5 0))
  (label 42)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k43">Item <a href="#t0">43</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 43 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)))
  (leadsto ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 2 proxy 2) request-4 (5 0))
  (label 43)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k44">Item <a href="#t0">44</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 436.800 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 44 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)))
  (leadsto ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 3 proxy 2) request-4 (5 0))
  (label 44)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k45">Item <a href="#t0">45</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 486.780 189.960 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 45 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-3) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (5 0))
    ((4 5) (3 2)) ((5 0) (4 2)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (5 0)) ((4 5) (3 2))
    ((5 0) (4 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 4 proxy 2) request-4 (5 0))
  (label 45)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k46">Item <a href="#t0">46</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 46 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie request-4 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-4) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-4) (client client-3))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 1) (5 0)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 0) (4 2))
    ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-4 (5 0))
  (label 46)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k54">Item <a href="#t0">54</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 54 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 cookie-0
      data) (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)))
  (leadsto ((1 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (4 1))
    ((4 1) (3 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 5 4 server 1)
    (cat answer-2 cookie-0) (4 1))
  (label 54)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k57">Item <a href="#t0">57</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 57 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 cookie-0
      data) (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)))
  (leadsto ((2 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (4 1))
    ((4 1) (3 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 5 4 server 1)
    (cat answer-2 cookie-0) (4 1))
  (label 57)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k61">Item <a href="#t0">61</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 61 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      cookie-0 data) (client proxy client-0 proxy-0 client-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (leadsto ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (4 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 4 server 1)
    (cat answer-2 cookie-0) (4 1))
  (label 61)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k68">Item <a href="#t0">68</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 68 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 cookie-0 data)
    (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (precedes ((1 1) (3 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (4 2))
    ((3 1) (2 0)) ((4 5) (3 1)))
  (leadsto ((1 1) (3 0)) ((2 0) (1 2)) ((3 0) (4 2)) ((3 1) (2 0))
    ((4 5) (3 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 5 3 server 1)
    (cat answer-2 cookie-0) (4 2))
  (label 68)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k70">Item <a href="#t0">70</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.220 225.660 344.639 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 70 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 cookie-0 request-1 data)
    (client proxy client-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (precedes ((1 1) (3 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 0) (3 1)) ((5 1) (4 0)))
  (leadsto ((1 1) (3 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (3 1))
    ((5 1) (4 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-1 (4 0))
  (label 70)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k73">Item <a href="#t0">73</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.220 225.660 344.639 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 73 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 cookie-0 data)
    (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (4 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((4 5) (3 1)))
  (leadsto ((2 0) (1 2)) ((3 0) (4 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((4 5) (3 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 5 3 server 1)
    (cat answer-2 cookie-0) (4 2))
  (label 73)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k77">Item <a href="#t0">77</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 442.800 452.460 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-1 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.220 225.660 344.639 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer answer-1) (cookie cookie-0) (syskey syskey-0) (client client-1) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 77 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request-2 request2-0 syskey-0
      cookie-0 data) (client proxy client-0 client-1 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand proxy 6 (request request-2) (request2 request2-0)
    (answer answer-1) (cookie cookie-0) (syskey syskey-0)
    (client client-1) (proxy proxy-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (5 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 5) (3 1)))
  (leadsto ((2 0) (1 2)) ((3 0) (5 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 5) (3 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 3 server 1)
    (cat answer-2 cookie-0) (5 2))
  (label 77)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k79">Item <a href="#t0">79</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 442.609 188.906 345.458 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 79 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 answer-2 cookie-0 data)
    (client proxy client-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (5 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 0) (3 1)))
  (leadsto ((1 1) (5 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 0) (3 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 1 proxy 2) request-2 (5 0))
  (label 79)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k80">Item <a href="#t0">80</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 442.609 188.906 345.458 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 80 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 answer-2 cookie-0 request-2 data)
    (client proxy client-0 client-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 0) (3 1)) ((6 1) (5 0)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (3 1))
    ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (5 0))
  (label 80)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k94">Item <a href="#t0">94</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-0 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-0) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 94 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 answer-0 cookie
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-0) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 0) (5 2)))
  (leadsto ((1 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 1 proxy 2) request-5 (6 0))
  (label 94)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k95">Item <a href="#t0">95</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-0 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-0) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 95 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 answer-0 cookie
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-0) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 0) (5 2)))
  (leadsto ((2 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 2 proxy 2) request-5 (6 0))
  (label 95)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k96">Item <a href="#t0">96</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-0 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 486.780 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-0) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 96 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 answer-0 cookie
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-0) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (6 0)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 0) (5 2)))
  (leadsto ((2 5) (1 2)) ((3 1) (6 0)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 3 proxy 2) request-5 (6 0))
  (label 96)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k97">Item <a href="#t0">97</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-0 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 536.760 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-0) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 97 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 answer-0 cookie
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-0) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand server 1 (request request-3) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (6 0))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 0) (5 2)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (6 0)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 4 proxy 2) request-5 (6 0))
  (label 97)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k98">Item <a href="#t0">98</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-0 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 586.740 189.960 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-4) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-0) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 98 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 answer-0 cookie
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-0) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand server 1 (request request-4) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 1) (6 0)) ((5 5) (4 2)) ((6 0) (5 2)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 1) (6 0))
    ((5 5) (4 2)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 5 proxy 2) request-5 (6 0))
  (label 98)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k99">Item <a href="#t0">99</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-5 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-0 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>((request request-5) (client client-4))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-5) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-0) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 99 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 answer-0 cookie
      request-5 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-0) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand server 1 (request request-5) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-5) (client client-4))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 0) (5 2)) ((7 1) (6 0)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 5) (4 2))
    ((6 0) (5 2)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-5 (6 0))
  (label 99)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k108">Item <a href="#t0">108</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 108 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((1 1) (5 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)))
  (leadsto ((1 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 0) (5 1)) ((5 1) (4 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 5 server 1)
    (cat answer-2 cookie-0) (5 1))
  (label 108)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k111">Item <a href="#t0">111</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 111 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)))
  (leadsto ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 0) (5 1)) ((5 1) (4 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 5 server 1)
    (cat answer-2 cookie-0) (5 1))
  (label 111)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k114">Item <a href="#t0">114</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 436.800 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 114 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)))
  (leadsto ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 0) (5 1)) ((5 1) (4 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 5 server 1)
    (cat answer-2 cookie-0) (5 1))
  (label 114)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k118">Item <a href="#t0">118</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 118 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2)) ((5 0) (5 1))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 5 server 1)
    (cat answer-2 cookie-0) (5 1))
  (label 118)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k126">Item <a href="#t0">126</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 126 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-1) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 0) (5 2)) ((4 1) (3 0)) ((5 5) (4 1)))
  (leadsto ((1 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (5 2))
    ((4 1) (3 0)) ((5 5) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 4 server 1)
    (cat answer-2 cookie-0) (5 2))
  (label 126)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k128">Item <a href="#t0">128</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 128 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 data) (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 1) (5 0)) ((2 5) (1 2))
    ((3 0) (2 2)) ((4 1) (3 0)) ((5 0) (4 1)))
  (leadsto ((1 1) (4 0)) ((2 1) (5 0)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 0) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 2 proxy 2) request-2 (5 0))
  (label 128)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k129">Item <a href="#t0">129</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 129 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 request-2 data)
    (client proxy client-0 proxy-0 client-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 0) (4 1)) ((6 1) (5 0)))
  (leadsto ((1 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 0) (4 1)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (5 0))
  (label 129)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k132">Item <a href="#t0">132</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 132 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-1) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (precedes ((1 3) (0 1)) ((2 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 0) (5 2)) ((4 1) (3 0)) ((5 5) (4 1)))
  (leadsto ((2 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (5 2))
    ((4 1) (3 0)) ((5 5) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 4 server 1)
    (cat answer-2 cookie-0) (5 2))
  (label 132)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k134">Item <a href="#t0">134</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 134 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 data) (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (5 0)) ((1 3) (0 1)) ((2 1) (4 0)) ((2 5) (1 2))
    ((3 0) (2 2)) ((4 1) (3 0)) ((5 0) (4 1)))
  (leadsto ((1 1) (5 0)) ((2 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 0) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 1 proxy 2) request-2 (5 0))
  (label 134)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k135">Item <a href="#t0">135</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 135 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 request-2 data)
    (client proxy client-0 proxy-0 client-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (precedes ((1 3) (0 1)) ((2 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 0) (4 1)) ((6 1) (5 0)))
  (leadsto ((2 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 0) (4 1)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (5 0))
  (label 135)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k138">Item <a href="#t0">138</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 138 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-1) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (5 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((5 5) (4 1)))
  (leadsto ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (5 2)) ((4 1) (3 0))
    ((5 1) (4 0)) ((5 5) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 4 server 1)
    (cat answer-2 cookie-0) (5 2))
  (label 138)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k142">Item <a href="#t0">142</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 542.760 452.460 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-1 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 536.760 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 request2-1) (answer answer-1) (cookie cookie-0) (syskey syskey-1) (client client-2) (proxy proxy-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 142 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request-3 request2-1 syskey-1 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 client-2 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (defstrand proxy 6 (request request-3) (request2 request2-1)
    (answer answer-1) (cookie cookie-0) (syskey syskey-1)
    (client client-2) (proxy proxy-1))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (6 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 5) (4 1)))
  (leadsto ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (6 2)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 5) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 4 server 1)
    (cat answer-2 cookie-0) (6 2))
  (label 142)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k144">Item <a href="#t0">144</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 542.569 188.906 445.418 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 144 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 0) (4 1)))
  (leadsto ((1 1) (6 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 0) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 1 proxy 2) request-3 (6 0))
  (label 144)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k145">Item <a href="#t0">145</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 542.569 188.906 445.418 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 145 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (6 0)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 0) (4 1)))
  (leadsto ((2 1) (6 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 0) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 2 proxy 2) request-3 (6 0))
  (label 145)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k146">Item <a href="#t0">146</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 542.569 188.906 445.418 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 146 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      answer-2 cookie-0 request-3 data)
    (client proxy client-0 proxy-0 client-1 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 0) (4 1)) ((7 1) (6 0)))
  (leadsto ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 0) (4 1)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (6 0))
  (label 146)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k163">Item <a href="#t0">163</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 163 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-1) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (precedes ((1 1) (3 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (5 2))
    ((3 1) (2 0)) ((4 5) (3 1)) ((5 5) (4 2)))
  (leadsto ((1 1) (3 0)) ((2 0) (1 2)) ((3 0) (5 2)) ((3 1) (2 0))
    ((4 5) (3 1)) ((5 5) (4 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 3 server 1)
    (cat answer-2 cookie-0) (5 2))
  (label 163)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k165">Item <a href="#t0">165</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 486.780 189.960 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 236.880 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 165 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 answer-2 cookie-0
      data) (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (3 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 1) (5 0)) ((4 5) (3 1)) ((5 0) (4 2)))
  (leadsto ((1 1) (3 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (5 0))
    ((4 5) (3 1)) ((5 0) (4 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 4 proxy 2) request-2 (5 0))
  (label 165)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k166">Item <a href="#t0">166</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 236.880 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 166 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 answer-2 cookie-0
      request-2 data) (client proxy client-0 proxy-0 client-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (precedes ((1 1) (3 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 5) (3 1)) ((5 0) (4 2)) ((6 1) (5 0)))
  (leadsto ((1 1) (3 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 5) (3 1))
    ((5 0) (4 2)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (5 0))
  (label 166)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k171">Item <a href="#t0">171</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 171 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-1) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (5 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((4 5) (3 1)) ((5 5) (4 2)))
  (leadsto ((2 0) (1 2)) ((3 0) (5 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((4 5) (3 1)) ((5 5) (4 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 3 server 1)
    (cat answer-2 cookie-0) (5 2))
  (label 171)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k173">Item <a href="#t0">173</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 391.038 299.718 342.276 409.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 173 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 answer-2 cookie-0
      data) (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (5 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((4 5) (3 1)) ((5 0) (4 2)))
  (leadsto ((1 1) (5 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((4 5) (3 1)) ((5 0) (4 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 1 proxy 2) request-2 (5 0))
  (label 173)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k174">Item <a href="#t0">174</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 391.038 299.718 342.276 409.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 174 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 answer-2 cookie-0
      request-2 data) (client proxy client-0 proxy-0 client-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((4 5) (3 1)) ((5 0) (4 2)) ((6 1) (5 0)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)) ((4 5) (3 1))
    ((5 0) (4 2)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (5 0))
  (label 174)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k177">Item <a href="#t0">177</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 442.609 188.906 345.458 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 177 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-1) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (5 2)) ((3 1) (2 0))
    ((4 5) (3 1)) ((5 1) (3 0)) ((5 5) (4 2)))
  (leadsto ((2 0) (1 2)) ((3 0) (5 2)) ((3 1) (2 0)) ((4 5) (3 1))
    ((5 1) (3 0)) ((5 5) (4 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 3 server 1)
    (cat answer-2 cookie-0) (5 2))
  (label 177)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k181">Item <a href="#t0">181</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-1 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 442.800 677.460 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.220 225.660 344.639 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 486.780 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 request2-1) (answer answer-1) (cookie cookie-0) (syskey syskey-1) (client client-2) (proxy proxy-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-1) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 181 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request-2 request2-0 syskey-0
      request-3 request2-1 syskey-1 cookie-0 data)
    (client proxy client-0 client-1 proxy-0 client-2 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand proxy 6 (request request-2) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-1) (proxy proxy-0))
  (defstrand proxy 6 (request request-3) (request2 request2-1)
    (answer answer-1) (cookie cookie-0) (syskey syskey-1)
    (client client-2) (proxy proxy-1))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (6 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 5) (3 1)) ((6 5) (5 2)))
  (leadsto ((2 0) (1 2)) ((3 0) (6 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 5) (3 1)) ((6 5) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 3 server 1)
    (cat answer-2 cookie-0) (6 2))
  (label 181)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k183">Item <a href="#t0">183</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 442.800 452.460 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 391.038 299.718 342.276 409.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-1) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 183 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request-2 request2-0 syskey-0
      answer-2 cookie-0 data)
    (client proxy client-0 client-1 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand proxy 6 (request request-2) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-1) (proxy proxy-0))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 5) (3 1)) ((6 0) (5 2)))
  (leadsto ((1 1) (6 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 5) (3 1)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 1 proxy 2) request-3 (6 0))
  (label 183)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k184">Item <a href="#t0">184</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 442.800 452.460 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 586.740 189.960 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 391.038 299.718 342.276 409.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-1) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 184 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request-2 request2-0 syskey-0
      answer-2 cookie-0 data)
    (client proxy client-0 client-1 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand proxy 6 (request request-2) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-1) (proxy proxy-0))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (6 0)) ((5 5) (3 1)) ((6 0) (5 2)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (6 0))
    ((5 5) (3 1)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 5 proxy 2) request-3 (6 0))
  (label 184)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k185">Item <a href="#t0">185</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 442.800 452.460 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 391.038 299.718 342.276 409.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-1) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 185 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request-2 request2-0 syskey-0
      answer-2 cookie-0 request-3 data)
    (client proxy client-0 client-1 proxy-0 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand proxy 6 (request request-2) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-1) (proxy proxy-0))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 5) (3 1)) ((6 0) (5 2)) ((7 1) (6 0)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 5) (3 1))
    ((6 0) (5 2)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (6 0))
  (label 185)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k194">Item <a href="#t0">194</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>sbp 194 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 cookie-0 cookie-1 data)
    (client proxy name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (leadsto ((1 1) (4 0)) ((2 0) (1 2)) ((3 0) (3 1)) ((3 1) (2 0))
    ((4 0) (4 1)) ((4 1) (3 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 5 3 server 1)
    (cat answer-3 cookie-1) (3 1))
  (label 194)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k207">Item <a href="#t0">207</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 207 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 request-1 cookie-0 cookie-1
      data) (client proxy client-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (leadsto ((2 0) (1 2)) ((3 0) (3 1)) ((3 1) (2 0)) ((4 0) (4 1))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 3 server 1)
    (cat answer-3 cookie-1) (3 1))
  (label 207)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k224">Item <a href="#t0">224</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1654.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1654.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='789.960' x2='339.840' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='1014.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1389.960' x2='39.960' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-4 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 answer-0 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-4 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 939.960 Q 392.820 939.960 345.840 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 1164.960 Q 292.860 1164.960 245.880 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 1389.960 Q 192.900 1389.960 145.920 1389.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 1464.960 Q 92.940 1464.960 45.960 1464.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1464.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1389.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 436.800 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1614.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1464.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-5) (request2 request2-4) (answer answer-0) (cookie cookie) (syskey syskey-4) (client client-4) (proxy proxy-4))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer request2-4) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 224 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 request-5
      request2-4 syskey-4 answer-0 cookie data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 proxy-4 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer request2-4) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand proxy 6 (request request-5) (request2 request2-4)
    (answer answer-0) (cookie cookie) (syskey syskey-4)
    (client client-4) (proxy proxy-4))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((1 1) (7 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 5) (5 2)) ((7 0) (6 2)))
  (leadsto ((1 1) (7 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 5) (5 2)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 1 proxy 2) request-6 (7 0))
  (label 224)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k225">Item <a href="#t0">225</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1654.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1654.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='789.960' x2='339.840' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1239.960' x2='139.920' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1389.960' x2='39.960' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-4 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 answer-0 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-4 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 939.960 Q 392.820 939.960 345.840 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 1164.960 Q 292.860 1164.960 245.880 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 1389.960 Q 192.900 1389.960 145.920 1389.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 189.960 Q 486.780 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1464.960 Q 92.940 1464.960 45.960 1464.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1464.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1389.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1239.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1614.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1464.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-5) (request2 request2-4) (answer answer-0) (cookie cookie) (syskey syskey-4) (client client-4) (proxy proxy-4))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer request2-4) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 225 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 request-5
      request2-4 syskey-4 answer-0 cookie data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 proxy-4 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer request2-4) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand proxy 6 (request request-5) (request2 request2-4)
    (answer answer-0) (cookie cookie) (syskey syskey-4)
    (client client-4) (proxy proxy-4))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 1) (7 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 5) (5 2)) ((7 0) (6 2)))
  (leadsto ((2 1) (7 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 5) (5 2)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 2 proxy 2) request-6 (7 0))
  (label 225)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k226">Item <a href="#t0">226</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1654.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1654.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='1014.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1239.960' x2='139.920' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1389.960' x2='39.960' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-4 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 answer-0 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-4 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 939.960 Q 392.820 939.960 345.840 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 1164.960 Q 292.860 1164.960 245.880 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 536.760 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1389.960 Q 192.900 1389.960 145.920 1389.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 1464.960 Q 92.940 1464.960 45.960 1464.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1464.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1389.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1239.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1614.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1464.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-5) (request2 request2-4) (answer answer-0) (cookie cookie) (syskey syskey-4) (client client-4) (proxy proxy-4))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer request2-4) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 226 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 request-5
      request2-4 syskey-4 answer-0 cookie data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 proxy-4 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer request2-4) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand proxy 6 (request request-5) (request2 request2-4)
    (answer answer-0) (cookie cookie) (syskey syskey-4)
    (client client-4) (proxy proxy-4))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (7 0)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 5) (5 2)) ((7 0) (6 2)))
  (leadsto ((2 5) (1 2)) ((3 1) (7 0)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 5) (5 2)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 3 proxy 2) request-6 (7 0))
  (label 226)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k227">Item <a href="#t0">227</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1654.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1654.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='789.960' x2='339.840' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='1014.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1239.960' x2='139.920' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1389.960' x2='39.960' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-4 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 answer-0 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-4 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 939.960 Q 392.820 939.960 345.840 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 586.740 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1164.960 Q 292.860 1164.960 245.880 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 1389.960 Q 192.900 1389.960 145.920 1389.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 1464.960 Q 92.940 1464.960 45.960 1464.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1464.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1389.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1239.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1614.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1464.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-5) (request2 request2-4) (answer answer-0) (cookie cookie) (syskey syskey-4) (client client-4) (proxy proxy-4))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer request2-4) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 227 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 request-5
      request2-4 syskey-4 answer-0 cookie data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 proxy-4 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer request2-4) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand proxy 6 (request request-5) (request2 request2-4)
    (answer answer-0) (cookie cookie) (syskey syskey-4)
    (client client-4) (proxy proxy-4))
  (defstrand server 1 (request request-3) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (7 0))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 5) (5 2)) ((7 0) (6 2)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (7 0)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 5) (5 2)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 4 proxy 2) request-6 (7 0))
  (label 227)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k228">Item <a href="#t0">228</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1654.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1654.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='789.960' x2='339.840' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='1014.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1239.960' x2='139.920' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1389.960' x2='39.960' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-4 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 answer-0 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-4 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 636.720 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 939.960 Q 392.820 939.960 345.840 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 1164.960 Q 292.860 1164.960 245.880 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 1389.960 Q 192.900 1389.960 145.920 1389.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 1464.960 Q 92.940 1464.960 45.960 1464.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1464.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1389.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1239.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1614.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1464.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>((request request-4) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-5) (request2 request2-4) (answer answer-0) (cookie cookie) (syskey syskey-4) (client client-4) (proxy proxy-4))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer request2-4) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 228 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 request-5
      request2-4 syskey-4 answer-0 cookie data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 proxy-4 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer request2-4) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand proxy 6 (request request-5) (request2 request2-4)
    (answer answer-0) (cookie cookie) (syskey syskey-4)
    (client client-4) (proxy proxy-4))
  (defstrand server 1 (request request-4) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 1) (7 0)) ((5 5) (4 2)) ((6 5) (5 2)) ((7 0) (6 2)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 1) (7 0))
    ((5 5) (4 2)) ((6 5) (5 2)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 5 proxy 2) request-6 (7 0))
  (label 228)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k229">Item <a href="#t0">229</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1654.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1654.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='789.960' x2='339.840' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='1014.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1239.960' x2='139.920' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1389.960' x2='39.960' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-5 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-4 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 answer-0 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 686.700 189.960 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-4 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 939.960 Q 392.820 939.960 345.840 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 1164.960 Q 292.860 1164.960 245.880 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 1389.960 Q 192.900 1389.960 145.920 1389.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 1464.960 Q 92.940 1464.960 45.960 1464.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1464.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1389.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1239.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1614.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1464.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>((request request-5) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-5) (request2 request2-4) (answer answer-0) (cookie cookie) (syskey syskey-4) (client client-4) (proxy proxy-4))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer request2-4) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 229 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 request-5
      request2-4 syskey-4 answer-0 cookie data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 proxy-4 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer request2-4) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand proxy 6 (request request-5) (request2 request2-4)
    (answer answer-0) (cookie cookie) (syskey syskey-4)
    (client client-4) (proxy proxy-4))
  (defstrand server 1 (request request-5) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 1) (7 0)) ((6 5) (5 2)) ((7 0) (6 2)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 5) (4 2))
    ((6 1) (7 0)) ((6 5) (5 2)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 6 proxy 2) request-6 (7 0))
  (label 229)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k230">Item <a href="#t0">230</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1654.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1654.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='789.960' x2='339.840' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='1014.960' x2='239.880' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1239.960' x2='139.920' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1389.960' x2='39.960' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.660 189.960 745.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-6</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-5 request-6)</title>
   <circle style='fill: blue;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-6 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-4 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 answer-0 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-4 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 939.960 Q 392.820 939.960 345.840 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 1164.960 Q 292.860 1164.960 245.880 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <path
   d='M 239.880 1389.960 Q 192.900 1389.960 145.920 1389.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 1464.960 Q 92.940 1464.960 45.960 1464.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1464.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1389.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1239.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1614.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1539.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1464.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1389.960' r='6.000'/></g>
  <g><title>((request request-6) (client client-5))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-6) (answer answer-0) (cookie cookie))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-5) (request2 request2-4) (answer answer-0) (cookie cookie) (syskey syskey-4) (client client-4) (proxy proxy-4))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer request2-4) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 230 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 request-5
      request2-4 syskey-4 answer-0 cookie request-6 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 proxy-4 client-5 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer request2-4) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand proxy 6 (request request-5) (request2 request2-4)
    (answer answer-0) (cookie cookie) (syskey syskey-4)
    (client client-4) (proxy proxy-4))
  (defstrand server 1 (request request-6) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-6) (client client-5))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 5) (5 2)) ((7 0) (6 2)) ((8 1) (7 0)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 5) (4 2))
    ((6 5) (5 2)) ((7 0) (6 2)) ((8 1) (7 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-6 (7 0))
  (label 230)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k240">Item <a href="#t0">240</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 240 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 cookie-0
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)))
  (leadsto ((1 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 0) (6 1)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 6 server 1)
    (cat answer-2 cookie-0) (6 1))
  (label 240)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k243">Item <a href="#t0">243</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 243 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 cookie-0
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)))
  (leadsto ((2 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 0) (6 1)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 6 server 1)
    (cat answer-2 cookie-0) (6 1))
  (label 243)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k246">Item <a href="#t0">246</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 486.780 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 246 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 cookie-0
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (6 0)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)))
  (leadsto ((2 5) (1 2)) ((3 1) (6 0)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 0) (6 1)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 6 server 1)
    (cat answer-2 cookie-0) (6 1))
  (label 246)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k249">Item <a href="#t0">249</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 536.760 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 249 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 cookie-0
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (6 0))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (6 0)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 0) (6 1)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 6 server 1)
    (cat answer-2 cookie-0) (6 1))
  (label 249)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k253">Item <a href="#t0">253</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-4 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 253 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 request-4
      cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-4) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 1) (5 0)) ((7 1) (6 0)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 0) (4 2))
    ((6 0) (6 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-2 cookie-0) (6 1))
  (label 253)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k262">Item <a href="#t0">262</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-1 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 586.740 264.960 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 336.840 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-1) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 262 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-1) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (precedes ((1 1) (5 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 0) (6 2)) ((5 1) (4 0)) ((6 5) (5 1)))
  (leadsto ((1 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 0) (6 2)) ((5 1) (4 0)) ((6 5) (5 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 5 server 1)
    (cat answer-2 cookie-0) (6 2))
  (label 262)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k264">Item <a href="#t0">264</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 264 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (5 0)) ((1 3) (0 1)) ((2 1) (6 0)) ((2 5) (1 2))
    ((3 5) (2 2)) ((4 0) (3 2)) ((5 1) (4 0)) ((6 0) (5 1)))
  (leadsto ((1 1) (5 0)) ((2 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 0) (5 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 2 proxy 2) request-3 (6 0))
  (label 264)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k265">Item <a href="#t0">265</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 486.780 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 265 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (5 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (6 0))
    ((3 5) (2 2)) ((4 0) (3 2)) ((5 1) (4 0)) ((6 0) (5 1)))
  (leadsto ((1 1) (5 0)) ((2 5) (1 2)) ((3 1) (6 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 0) (5 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 3 proxy 2) request-3 (6 0))
  (label 265)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k266">Item <a href="#t0">266</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 266 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 answer-2 cookie-0 request-3 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (precedes ((1 1) (5 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 0) (5 1)) ((7 1) (6 0)))
  (leadsto ((1 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)) ((6 0) (5 1)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (6 0))
  (label 266)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k269">Item <a href="#t0">269</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-1 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 586.740 264.960 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 386.820 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-1) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 269 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-1) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (precedes ((1 3) (0 1)) ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 0) (6 2)) ((5 1) (4 0)) ((6 5) (5 1)))
  (leadsto ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 0) (6 2)) ((5 1) (4 0)) ((6 5) (5 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 5 server 1)
    (cat answer-2 cookie-0) (6 2))
  (label 269)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k271">Item <a href="#t0">271</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 271 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 1) (5 0)) ((2 5) (1 2))
    ((3 5) (2 2)) ((4 0) (3 2)) ((5 1) (4 0)) ((6 0) (5 1)))
  (leadsto ((1 1) (6 0)) ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 0) (5 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 1 proxy 2) request-3 (6 0))
  (label 271)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k272">Item <a href="#t0">272</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 486.780 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 272 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (5 0)) ((2 5) (1 2)) ((3 1) (6 0))
    ((3 5) (2 2)) ((4 0) (3 2)) ((5 1) (4 0)) ((6 0) (5 1)))
  (leadsto ((2 1) (5 0)) ((2 5) (1 2)) ((3 1) (6 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 0) (5 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 3 proxy 2) request-3 (6 0))
  (label 272)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k273">Item <a href="#t0">273</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 273 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 answer-2 cookie-0 request-3 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (precedes ((1 3) (0 1)) ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 0) (5 1)) ((7 1) (6 0)))
  (leadsto ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)) ((6 0) (5 1)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (6 0))
  (label 273)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k276">Item <a href="#t0">276</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-1 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 586.740 264.960 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-1) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 276 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-1) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 0) (6 2)) ((5 1) (4 0)) ((6 5) (5 1)))
  (leadsto ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 0) (6 2)) ((5 1) (4 0)) ((6 5) (5 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 5 server 1)
    (cat answer-2 cookie-0) (6 2))
  (label 276)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k278">Item <a href="#t0">278</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 436.800 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 278 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (5 0))
    ((3 5) (2 2)) ((4 0) (3 2)) ((5 1) (4 0)) ((6 0) (5 1)))
  (leadsto ((1 1) (6 0)) ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 0) (5 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 1 proxy 2) request-3 (6 0))
  (label 278)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k279">Item <a href="#t0">279</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 436.800 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 279 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (6 0)) ((2 5) (1 2)) ((3 1) (5 0))
    ((3 5) (2 2)) ((4 0) (3 2)) ((5 1) (4 0)) ((6 0) (5 1)))
  (leadsto ((2 1) (6 0)) ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 0) (5 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 2 proxy 2) request-3 (6 0))
  (label 279)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k280">Item <a href="#t0">280</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 436.800 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 280 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 answer-2 cookie-0 request-3 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 0) (5 1)) ((7 1) (6 0)))
  (leadsto ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)) ((6 0) (5 1)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (6 0))
  (label 280)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k283">Item <a href="#t0">283</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-1 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 586.740 264.960 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-1) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 283 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-1) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 0) (6 2)) ((5 1) (4 0)) ((6 1) (5 0)) ((6 5) (5 1)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2)) ((5 0) (6 2))
    ((5 1) (4 0)) ((6 1) (5 0)) ((6 5) (5 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 5 server 1)
    (cat answer-2 cookie-0) (6 2))
  (label 283)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k287">Item <a href="#t0">287</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 489.960 Q 642.720 452.460 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-3 proxy-2))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-1 (enc cookie-0 (hash syskey-2 (ltk client-3 proxy-2))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 636.720 227.460 733.680 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-4) (request2 request2-2) (answer answer-1) (cookie cookie-0) (syskey syskey-2) (client client-3) (proxy proxy-2))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 287 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request-4 request2-2 syskey-2
      cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 client-3
      proxy-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (defstrand proxy 6 (request request-4) (request2 request2-2)
    (answer answer-1) (cookie cookie-0) (syskey syskey-2)
    (client client-3) (proxy proxy-2))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 0) (7 2)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 5) (5 1)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2)) ((5 0) (7 2))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 5) (5 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 5 server 1)
    (cat answer-2 cookie-0) (7 2))
  (label 287)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k289">Item <a href="#t0">289</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 642.529 188.906 545.378 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 436.800 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 289 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (7 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 0) (5 1)))
  (leadsto ((1 1) (7 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 0) (5 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 1 proxy 2) request-4 (7 0))
  (label 289)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k290">Item <a href="#t0">290</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 642.529 188.906 545.378 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 486.780 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 290 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (7 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 0) (5 1)))
  (leadsto ((2 1) (7 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 0) (5 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 2 proxy 2) request-4 (7 0))
  (label 290)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k291">Item <a href="#t0">291</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 642.529 188.906 545.378 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 536.760 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 291 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (7 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 0) (5 1)))
  (leadsto ((2 5) (1 2)) ((3 1) (7 0)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 0) (5 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 3 proxy 2) request-4 (7 0))
  (label 291)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k292">Item <a href="#t0">292</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.660 189.960 745.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 642.529 188.906 545.378 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 292 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 answer-2 cookie-0 request-4 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 client-3
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (defstrand server 1 (request request-4) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 0) (5 1)) ((8 1) (7 0)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 0) (5 1)) ((8 1) (7 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-4 (7 0))
  (label 292)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k313">Item <a href="#t0">313</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='714.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-1 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 536.760 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-1) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 313 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 request-3 request2-2 syskey-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-1) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 0) (6 2)) ((4 1) (3 0)) ((5 5) (4 1)) ((6 5) (5 2)))
  (leadsto ((1 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (6 2))
    ((4 1) (3 0)) ((5 5) (4 1)) ((6 5) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 4 server 1)
    (cat answer-2 cookie-0) (6 2))
  (label 313)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k315">Item <a href="#t0">315</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 286.860 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 315 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 1) (6 0)) ((2 5) (1 2))
    ((3 0) (2 2)) ((4 1) (3 0)) ((5 5) (4 1)) ((6 0) (5 2)))
  (leadsto ((1 1) (4 0)) ((2 1) (6 0)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 5) (4 1)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 2 proxy 2) request-3 (6 0))
  (label 315)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k316">Item <a href="#t0">316</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 586.740 189.960 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 286.860 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 316 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 1) (6 0)) ((5 5) (4 1)) ((6 0) (5 2)))
  (leadsto ((1 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (6 0)) ((5 5) (4 1)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 5 proxy 2) request-3 (6 0))
  (label 316)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k317">Item <a href="#t0">317</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 286.860 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 317 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 request-3 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 5) (4 1)) ((6 0) (5 2)) ((7 1) (6 0)))
  (leadsto ((1 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 5) (4 1)) ((6 0) (5 2)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (6 0))
  (label 317)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k323">Item <a href="#t0">323</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='714.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-1 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 536.760 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-1) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 323 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 request-3 request2-2 syskey-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-1) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (precedes ((1 3) (0 1)) ((2 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 0) (6 2)) ((4 1) (3 0)) ((5 5) (4 1)) ((6 5) (5 2)))
  (leadsto ((2 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (6 2))
    ((4 1) (3 0)) ((5 5) (4 1)) ((6 5) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 4 server 1)
    (cat answer-2 cookie-0) (6 2))
  (label 323)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k325">Item <a href="#t0">325</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 336.840 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 325 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 1) (4 0)) ((2 5) (1 2))
    ((3 0) (2 2)) ((4 1) (3 0)) ((5 5) (4 1)) ((6 0) (5 2)))
  (leadsto ((1 1) (6 0)) ((2 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 5) (4 1)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 1 proxy 2) request-3 (6 0))
  (label 325)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k326">Item <a href="#t0">326</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 586.740 189.960 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 336.840 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 326 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 1) (6 0)) ((5 5) (4 1)) ((6 0) (5 2)))
  (leadsto ((2 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (6 0)) ((5 5) (4 1)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 5 proxy 2) request-3 (6 0))
  (label 326)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k327">Item <a href="#t0">327</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 336.840 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 327 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 request-3 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (precedes ((1 3) (0 1)) ((2 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 5) (4 1)) ((6 0) (5 2)) ((7 1) (6 0)))
  (leadsto ((2 1) (4 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 5) (4 1)) ((6 0) (5 2)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (6 0))
  (label 327)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k333">Item <a href="#t0">333</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='714.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-1 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 536.760 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-1) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 333 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 request-3 request2-2 syskey-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-1) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (6 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((5 5) (4 1)) ((6 5) (5 2)))
  (leadsto ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (6 2)) ((4 1) (3 0))
    ((5 1) (4 0)) ((5 5) (4 1)) ((6 5) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 4 server 1)
    (cat answer-2 cookie-0) (6 2))
  (label 333)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k335">Item <a href="#t0">335</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 490.998 299.718 442.236 409.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 335 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((5 5) (4 1)) ((6 0) (5 2)))
  (leadsto ((1 1) (6 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (4 0)) ((5 5) (4 1)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 1 proxy 2) request-3 (6 0))
  (label 335)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k336">Item <a href="#t0">336</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 490.998 299.718 442.236 409.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 336 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (6 0)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((5 5) (4 1)) ((6 0) (5 2)))
  (leadsto ((2 1) (6 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (4 0)) ((5 5) (4 1)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 2 proxy 2) request-3 (6 0))
  (label 336)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k337">Item <a href="#t0">337</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 490.998 299.718 442.236 409.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 337 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 request-3 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (4 0)) ((5 5) (4 1)) ((6 0) (5 2)) ((7 1) (6 0)))
  (leadsto ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0)) ((5 1) (4 0))
    ((5 5) (4 1)) ((6 0) (5 2)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (6 0))
  (label 337)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k340">Item <a href="#t0">340</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='714.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-1 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 542.569 188.906 445.418 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 536.760 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-1) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 340 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request2-1 syskey-1 request-3 request2-2 syskey-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-1) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (6 2))
    ((4 1) (3 0)) ((5 5) (4 1)) ((6 1) (4 0)) ((6 5) (5 2)))
  (leadsto ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (6 2)) ((4 1) (3 0))
    ((5 5) (4 1)) ((6 1) (4 0)) ((6 5) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 4 server 1)
    (cat answer-2 cookie-0) (6 2))
  (label 340)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k344">Item <a href="#t0">344</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='714.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-3 proxy-2))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-1 (enc cookie-0 (hash syskey-2 (ltk client-3 proxy-2))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 714.960 Q 542.760 677.460 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle style='fill: blue;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 586.740 227.460 733.680 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-4) (request2 request2-2) (answer answer-1) (cookie cookie-0) (syskey syskey-2) (client client-3) (proxy proxy-2))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-1) (answer request2-2) (cookie cookie-0) (syskey syskey-1) (client client-2) (proxy proxy-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 344 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request-3 request2-1 syskey-1 request-4 request2-2 syskey-2
      cookie-0 data)
    (client proxy client-0 proxy-0 client-1 client-2 proxy-1 client-3
      proxy-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (defstrand proxy 6 (request request-3) (request2 request2-1)
    (answer request2-2) (cookie cookie-0) (syskey syskey-1)
    (client client-2) (proxy proxy-1))
  (defstrand proxy 6 (request request-4) (request2 request2-2)
    (answer answer-1) (cookie cookie-0) (syskey syskey-2)
    (client client-3) (proxy proxy-2))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (7 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 5) (4 1)) ((7 5) (6 2)))
  (leadsto ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (7 2)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 5) (4 1)) ((7 5) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 4 server 1)
    (cat answer-2 cookie-0) (7 2))
  (label 344)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k346">Item <a href="#t0">346</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 542.760 452.460 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 490.998 299.718 442.236 409.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 436.800 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-2) (proxy proxy-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 346 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request-3 request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 client-2 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (defstrand proxy 6 (request request-3) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-2) (proxy proxy-1))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (7 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 5) (4 1)) ((7 0) (6 2)))
  (leadsto ((1 1) (7 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 5) (4 1)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 1 proxy 2) request-4 (7 0))
  (label 346)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k347">Item <a href="#t0">347</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 542.760 452.460 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 490.998 299.718 442.236 409.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 486.780 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-2) (proxy proxy-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 347 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request-3 request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 client-2 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (defstrand proxy 6 (request request-3) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-2) (proxy proxy-1))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (7 0)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 5) (4 1)) ((7 0) (6 2)))
  (leadsto ((2 1) (7 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 5) (4 1)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 2 proxy 2) request-4 (7 0))
  (label 347)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k348">Item <a href="#t0">348</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 542.760 452.460 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 686.700 189.960 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 490.998 299.718 442.236 409.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-2) (proxy proxy-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 348 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request-3 request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 client-2 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (defstrand proxy 6 (request request-3) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-2) (proxy proxy-1))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (7 0)) ((6 5) (4 1)) ((7 0) (6 2)))
  (leadsto ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (7 0)) ((6 5) (4 1)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 6 proxy 2) request-4 (7 0))
  (label 348)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k349">Item <a href="#t0">349</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.660 189.960 745.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 542.760 452.460 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 490.998 299.718 442.236 409.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-2) (proxy proxy-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 349 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 request-2
      request-3 request2-1 syskey-1 answer-2 cookie-0 request-4 data)
    (client proxy client-0 proxy-0 client-1 client-2 proxy-1 client-3
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (defstrand proxy 6 (request request-3) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-2) (proxy proxy-1))
  (defstrand server 1 (request request-4) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 5) (4 1)) ((7 0) (6 2)) ((8 1) (7 0)))
  (leadsto ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 5) (4 1)) ((7 0) (6 2)) ((8 1) (7 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-4 (7 0))
  (label 349)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k359">Item <a href="#t0">359</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='564.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 359 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 answer-2
      answer2-1 cookie-0 cookie-1 data)
    (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (precedes ((1 1) (5 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (leadsto ((1 1) (5 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (4 1))
    ((4 1) (3 0)) ((5 0) (5 1)) ((5 1) (4 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 4 server 1)
    (cat answer-3 cookie-1) (4 1))
  (label 359)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k368">Item <a href="#t0">368</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='414.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='564.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 368 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 answer-2
      answer2-1 cookie-0 cookie-1 data)
    (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (5 0)) ((2 5) (1 2)) ((3 0) (2 2))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (leadsto ((2 1) (5 0)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (4 1))
    ((4 1) (3 0)) ((5 0) (5 1)) ((5 1) (4 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 4 server 1)
    (cat answer-3 cookie-1) (4 1))
  (label 368)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k382">Item <a href="#t0">382</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='414.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='564.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 answer-2) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-0) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 382 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 answer-0 cookie answer-1 answer2-0 answer-2
      answer2-1 request-2 cookie-0 cookie-1 data)
    (client proxy client-0 proxy-0 client-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-2) (request2 answer-2)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (leadsto ((2 5) (1 2)) ((3 0) (2 2)) ((4 0) (4 1)) ((4 1) (3 0))
    ((5 0) (5 1)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 4 server 1)
    (cat answer-3 cookie-1) (4 1))
  (label 382)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k403">Item <a href="#t0">403</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='939.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-1 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 939.960 Q 392.820 939.960 345.840 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 486.780 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-1) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 403 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 request-3 request2-2 syskey-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-1) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (precedes ((1 1) (3 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (6 2))
    ((3 1) (2 0)) ((4 5) (3 1)) ((5 5) (4 2)) ((6 5) (5 2)))
  (leadsto ((1 1) (3 0)) ((2 0) (1 2)) ((3 0) (6 2)) ((3 1) (2 0))
    ((4 5) (3 1)) ((5 5) (4 2)) ((6 5) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 3 server 1)
    (cat answer-2 cookie-0) (6 2))
  (label 403)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k405">Item <a href="#t0">405</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 536.760 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 236.880 602.460 333.840 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 405 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (3 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 1) (6 0)) ((4 5) (3 1)) ((5 5) (4 2)) ((6 0) (5 2)))
  (leadsto ((1 1) (3 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (6 0))
    ((4 5) (3 1)) ((5 5) (4 2)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 4 proxy 2) request-3 (6 0))
  (label 405)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k406">Item <a href="#t0">406</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 586.740 189.960 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 236.880 602.460 333.840 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 406 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (3 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 5) (3 1)) ((5 1) (6 0)) ((5 5) (4 2)) ((6 0) (5 2)))
  (leadsto ((1 1) (3 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 5) (3 1))
    ((5 1) (6 0)) ((5 5) (4 2)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 5 proxy 2) request-3 (6 0))
  (label 406)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k407">Item <a href="#t0">407</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 236.880 602.460 333.840 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 407 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 request-3 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (precedes ((1 1) (3 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 5) (3 1)) ((5 5) (4 2)) ((6 0) (5 2)) ((7 1) (6 0)))
  (leadsto ((1 1) (3 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 5) (3 1))
    ((5 5) (4 2)) ((6 0) (5 2)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (6 0))
  (label 407)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k414">Item <a href="#t0">414</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-3 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 436.991 188.906 534.142 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-1) (answer answer-3) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 414 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 cookie-0 answer-3 answer2-1 request-1
      data) (client proxy client-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request answer2-1) (answer answer-2)
    (cookie cookie-0))
  (defstrand server 2 (request request-1) (request2 answer-1)
    (answer answer-3) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (precedes ((1 1) (3 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (5 1))
    ((3 1) (2 0)) ((4 0) (3 1)) ((5 1) (4 0)) ((6 1) (5 0)))
  (leadsto ((1 1) (3 0)) ((2 0) (1 2)) ((3 0) (5 1)) ((3 1) (2 0))
    ((4 0) (3 1)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 3 server 1)
    (cat answer-4 cookie-1) (5 1))
  (label 414)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k415">Item <a href="#t0">415</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-3 cookie-1) answer2-1)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-3 cookie-1))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-3) (answer answer-3) (answer2 answer2-1) (cookie cookie-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 415 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 cookie-0 answer-3 answer2-1 request-1
      cookie-1 data) (client proxy client-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request answer2-1) (answer answer-2)
    (cookie cookie-0))
  (defstrand server 2 (request request-1) (request2 answer-3)
    (answer answer-3) (answer2 answer2-1) (cookie cookie-1))
  (defstrand proxy 2 (request request-1) (client client-0))
  (precedes ((1 1) (3 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 0) (3 1)) ((5 1) (4 0)) ((6 1) (5 0)))
  (leadsto ((1 1) (3 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (3 1))
    ((5 0) (5 1)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 5 server 1)
    (cat answer-4 cookie-1) (5 1))
  (label 415)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k420">Item <a href="#t0">420</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='939.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-1 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 939.960 Q 392.820 939.960 345.840 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 486.780 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-1) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 420 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 request-3 request2-2 syskey-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-1) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (6 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((4 5) (3 1)) ((5 5) (4 2)) ((6 5) (5 2)))
  (leadsto ((2 0) (1 2)) ((3 0) (6 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((4 5) (3 1)) ((5 5) (4 2)) ((6 5) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 3 server 1)
    (cat answer-2 cookie-0) (6 2))
  (label 420)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k422">Item <a href="#t0">422</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 391.038 524.718 342.276 634.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 422 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((4 5) (3 1)) ((5 5) (4 2)) ((6 0) (5 2)))
  (leadsto ((1 1) (6 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((4 5) (3 1)) ((5 5) (4 2)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 1 proxy 2) request-3 (6 0))
  (label 422)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k423">Item <a href="#t0">423</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 586.740 189.960 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 391.038 524.718 342.276 634.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 423 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((4 5) (3 1)) ((5 1) (6 0)) ((5 5) (4 2)) ((6 0) (5 2)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)) ((4 5) (3 1))
    ((5 1) (6 0)) ((5 5) (4 2)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 5 proxy 2) request-3 (6 0))
  (label 423)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k424">Item <a href="#t0">424</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 391.038 524.718 342.276 634.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 424 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 request-3 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((4 5) (3 1)) ((5 5) (4 2)) ((6 0) (5 2)) ((7 1) (6 0)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)) ((4 5) (3 1))
    ((5 5) (4 2)) ((6 0) (5 2)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (6 0))
  (label 424)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k430">Item <a href="#t0">430</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='939.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-1 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 442.800 227.460 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 939.960 Q 392.820 939.960 345.840 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 486.780 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-1) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 430 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 request-3 request2-2 syskey-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-1) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (6 2)) ((3 1) (2 0))
    ((4 5) (3 1)) ((5 1) (3 0)) ((5 5) (4 2)) ((6 5) (5 2)))
  (leadsto ((2 0) (1 2)) ((3 0) (6 2)) ((3 1) (2 0)) ((4 5) (3 1))
    ((5 1) (3 0)) ((5 5) (4 2)) ((6 5) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 3 server 1)
    (cat answer-2 cookie-0) (6 2))
  (label 430)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k432">Item <a href="#t0">432</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 441.018 374.718 342.276 634.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 432 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 5) (3 1)) ((5 1) (3 0)) ((5 5) (4 2)) ((6 0) (5 2)))
  (leadsto ((1 1) (6 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 5) (3 1))
    ((5 1) (3 0)) ((5 5) (4 2)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 1 proxy 2) request-3 (6 0))
  (label 432)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k433">Item <a href="#t0">433</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 441.018 374.718 342.276 634.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 536.760 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 433 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (6 0))
    ((4 5) (3 1)) ((5 1) (3 0)) ((5 5) (4 2)) ((6 0) (5 2)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (6 0)) ((4 5) (3 1))
    ((5 1) (3 0)) ((5 5) (4 2)) ((6 0) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 4 proxy 2) request-3 (6 0))
  (label 433)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k434">Item <a href="#t0">434</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 592.140 225.660 544.559 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 441.018 374.718 342.276 634.477'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>((request request-3) (client client-2))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 434 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 answer-2 cookie-0 request-3 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-3) (client client-2))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 5) (3 1))
    ((5 1) (3 0)) ((5 5) (4 2)) ((6 0) (5 2)) ((7 1) (6 0)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 5) (3 1)) ((5 1) (3 0))
    ((5 5) (4 2)) ((6 0) (5 2)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (6 0))
  (label 434)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k437">Item <a href="#t0">437</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='564.960' x2='439.800' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='939.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-1 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 492.690 189.232 345.661 263.504'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie-0 (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 939.960 Q 392.820 939.960 345.840 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='439.800' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 486.780 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-1) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie-0) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 437 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request2-0 syskey-0 request-2
      request2-1 syskey-1 request-3 request2-2 syskey-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie-0) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-1) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (6 2)) ((3 1) (2 0))
    ((4 5) (3 1)) ((5 5) (4 2)) ((6 1) (3 0)) ((6 5) (5 2)))
  (leadsto ((2 0) (1 2)) ((3 0) (6 2)) ((3 1) (2 0)) ((4 5) (3 1))
    ((5 5) (4 2)) ((6 1) (3 0)) ((6 5) (5 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 3 server 1)
    (cat answer-2 cookie-0) (6 2))
  (label 437)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k441">Item <a href="#t0">441</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='564.960' x2='539.760' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='939.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-3 proxy-2))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-1 (enc cookie-0 (hash syskey-2 (ltk client-3 proxy-2))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 714.960 Q 592.740 714.960 545.760 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle style='fill: blue;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 939.960 Q 442.800 902.460 345.840 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.220 225.660 344.639 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 536.760 227.460 733.680 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-4) (request2 request2-2) (answer answer-1) (cookie cookie-0) (syskey syskey-2) (client client-3) (proxy proxy-2))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-1) (answer request2-2) (cookie cookie-0) (syskey syskey-1) (client client-2) (proxy proxy-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-1) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 441 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request-2 request2-0 syskey-0
      request-3 request2-1 syskey-1 request-4 request2-2 syskey-2
      cookie-0 data)
    (client proxy client-0 client-1 proxy-0 client-2 proxy-1 client-3
      proxy-2 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand proxy 6 (request request-2) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-1) (proxy proxy-0))
  (defstrand proxy 6 (request request-3) (request2 request2-1)
    (answer request2-2) (cookie cookie-0) (syskey syskey-1)
    (client client-2) (proxy proxy-1))
  (defstrand proxy 6 (request request-4) (request2 request2-2)
    (answer answer-1) (cookie cookie-0) (syskey syskey-2)
    (client client-3) (proxy proxy-2))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (7 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 5) (3 1)) ((6 5) (5 2)) ((7 5) (6 2)))
  (leadsto ((2 0) (1 2)) ((3 0) (7 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 5) (3 1)) ((6 5) (5 2)) ((7 5) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 3 server 1)
    (cat answer-2 cookie-0) (7 2))
  (label 441)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k443">Item <a href="#t0">443</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 442.800 677.460 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 390.471 412.031 341.141 634.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 436.800 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-2) (proxy proxy-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-1) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 443 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request-2 request2-0 syskey-0
      request-3 request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 client-1 proxy-0 client-2 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand proxy 6 (request request-2) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-1) (proxy proxy-0))
  (defstrand proxy 6 (request request-3) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-2) (proxy proxy-1))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (7 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 5) (3 1)) ((6 5) (5 2)) ((7 0) (6 2)))
  (leadsto ((1 1) (7 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 5) (3 1)) ((6 5) (5 2)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 1 proxy 2) request-4 (7 0))
  (label 443)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k444">Item <a href="#t0">444</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 442.800 677.460 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 636.720 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 390.471 412.031 341.141 634.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-2) (proxy proxy-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-1) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 444 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request-2 request2-0 syskey-0
      request-3 request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 client-1 proxy-0 client-2 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand proxy 6 (request request-2) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-1) (proxy proxy-0))
  (defstrand proxy 6 (request request-3) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-2) (proxy proxy-1))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (7 0)) ((5 5) (3 1)) ((6 5) (5 2)) ((7 0) (6 2)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (7 0))
    ((5 5) (3 1)) ((6 5) (5 2)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 5 proxy 2) request-4 (7 0))
  (label 444)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k445">Item <a href="#t0">445</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 686.700 189.960 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 442.800 677.460 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 390.471 412.031 341.141 634.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-2) (proxy proxy-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-1) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 445 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request-2 request2-0 syskey-0
      request-3 request2-1 syskey-1 answer-2 cookie-0 data)
    (client proxy client-0 client-1 proxy-0 client-2 proxy-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand proxy 6 (request request-2) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-1) (proxy proxy-0))
  (defstrand proxy 6 (request request-3) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-2) (proxy proxy-1))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 5) (3 1)) ((6 1) (7 0)) ((6 5) (5 2)) ((7 0) (6 2)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 5) (3 1))
    ((6 1) (7 0)) ((6 5) (5 2)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 6 proxy 2) request-4 (7 0))
  (label 445)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k446">Item <a href="#t0">446</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='639.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='714.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='714.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.660 189.960 745.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-1 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-1 (ltk client-2 proxy-1))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 442.800 677.460 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle cx='539.760' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 390.471 412.031 341.141 634.103'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 192.900 714.960 145.920 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-1) (answer answer-2) (cookie cookie-0) (syskey syskey-1) (client client-2) (proxy proxy-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer request2-1) (cookie cookie-0) (syskey syskey-0) (client client-1) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 446 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 request-2 request2-0 syskey-0
      request-3 request2-1 syskey-1 answer-2 cookie-0 request-4 data)
    (client proxy client-0 client-1 proxy-0 client-2 proxy-1 client-3
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand proxy 6 (request request-2) (request2 request2-0)
    (answer request2-1) (cookie cookie-0) (syskey syskey-0)
    (client client-1) (proxy proxy-0))
  (defstrand proxy 6 (request request-3) (request2 request2-1)
    (answer answer-2) (cookie cookie-0) (syskey syskey-1)
    (client client-2) (proxy proxy-1))
  (defstrand server 1 (request request-4) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 5) (3 1)) ((6 5) (5 2)) ((7 0) (6 2)) ((8 1) (7 0)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 5) (3 1))
    ((6 5) (5 2)) ((7 0) (6 2)) ((8 1) (7 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-4 (7 0))
  (label 446)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k454">Item <a href="#t0">454</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-3 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 442.800 227.460 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 486.870 189.232 633.899 263.504'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (request2 answer-1) (answer answer-3) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 454 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 answer-2 cookie-0 answer-3 answer2-1
      data) (client proxy client-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand server 1 (request answer2-1) (answer answer-2)
    (cookie cookie-0))
  (defstrand server 2 (request request-0) (request2 answer-1)
    (answer answer-3) (answer2 answer2-1) (cookie cookie-0))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (6 1))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (3 1)) ((6 1) (5 0)))
  (leadsto ((1 1) (6 0)) ((2 0) (1 2)) ((3 0) (6 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 0) (3 1)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 3 server 1)
    (cat answer-4 cookie-1) (6 1))
  (label 454)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k455">Item <a href="#t0">455</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-3 cookie-1) answer2-1)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-3 cookie-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 442.800 227.460 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (request2 answer-3) (answer answer-3) (answer2 answer2-1) (cookie cookie-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 455 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 answer-2 cookie-0 answer-3 answer2-1
      cookie-1 data) (client proxy client-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand server 1 (request answer2-1) (answer answer-2)
    (cookie cookie-0))
  (defstrand server 2 (request request-0) (request2 answer-3)
    (answer answer-3) (answer2 answer2-1) (cookie cookie-1))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 0) (3 1)) ((6 1) (5 0)))
  (leadsto ((1 1) (6 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 0) (3 1)) ((6 0) (6 1)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 6 server 1)
    (cat answer-4 cookie-1) (6 1))
  (label 455)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k460">Item <a href="#t0">460</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-3 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 442.800 227.460 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 486.870 189.232 633.899 263.504'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 answer-1) (answer answer-3) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 460 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 answer-2 cookie-0 answer-3 answer2-1
      request-2 data) (client proxy client-0 client-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand server 1 (request answer2-1) (answer answer-2)
    (cookie cookie-0))
  (defstrand server 2 (request request-2) (request2 answer-1)
    (answer answer-3) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (6 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 0) (3 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (leadsto ((2 0) (1 2)) ((3 0) (6 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 0) (3 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 3 server 1)
    (cat answer-4 cookie-1) (6 1))
  (label 460)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k461">Item <a href="#t0">461</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-3 cookie-1) answer2-1)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-3 cookie-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 442.800 227.460 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 answer-3) (answer answer-3) (answer2 answer2-1) (cookie cookie-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 461 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 request-1 answer-2 cookie-0 answer-3 answer2-1
      request-2 cookie-1 data) (client proxy client-0 client-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand server 1 (request answer2-1) (answer answer-2)
    (cookie cookie-0))
  (defstrand server 2 (request request-2) (request2 answer-3)
    (answer answer-3) (answer2 answer2-1) (cookie cookie-1))
  (defstrand proxy 2 (request request-2) (client client-1))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 0) (3 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (3 1))
    ((6 0) (6 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-4 cookie-1) (6 1))
  (label 461)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k470">Item <a href="#t0">470</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='564.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-0) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 470 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 request-1 request2-0
      syskey-0 cookie-0 cookie-1 data)
    (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-0) (request2 request2-0)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 0) (5 2)) ((4 1) (3 0)) ((5 5) (4 1)))
  (leadsto ((1 1) (4 0)) ((2 0) (1 2)) ((3 0) (3 1)) ((3 1) (2 0))
    ((4 0) (5 2)) ((4 1) (3 0)) ((5 5) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 3 server 1)
    (cat answer-3 cookie-1) (3 1))
  (label 470)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k471">Item <a href="#t0">471</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='564.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 390.768 412.114 341.737 559.268'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-0) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 471 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 request-1 request2-0
      syskey-0 cookie-0 data) (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 2 (request request-0) (request2 request2-0)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 0) (3 1)) ((4 0) (5 2)) ((4 1) (3 0)) ((5 5) (4 1)))
  (leadsto ((1 1) (4 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (3 1))
    ((4 0) (5 2)) ((4 1) (3 0)) ((5 5) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 4 server 1)
    (cat answer-3 cookie-1) (3 1))
  (label 471)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k477">Item <a href="#t0">477</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 442.800 452.460 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-1)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-1 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-1 (enc cookie-1 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-1)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 291.524 417.456 243.207 344.953'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (cookie cookie-1) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 477 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 cookie-0 request-1
      request2-0 syskey-0 cookie-1 data)
    (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-1) (cookie cookie-1) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (5 2))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 5) (3 1)))
  (leadsto ((1 1) (4 0)) ((2 0) (1 2)) ((3 0) (5 2)) ((3 1) (2 0))
    ((4 0) (4 1)) ((4 1) (3 0)) ((5 5) (3 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 3 server 1)
    (cat answer-3 cookie-1) (5 2))
  (label 477)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k478">Item <a href="#t0">478</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 442.800 452.460 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 391.484 337.464 343.167 409.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 487.380 225.660 534.961 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 478 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 cookie-0 request-1
      request2-0 syskey-0 data) (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 0) (5 2)) ((4 1) (3 0)) ((5 2) (4 1)) ((5 5) (3 1)))
  (leadsto ((1 1) (4 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (4 1))
    ((4 0) (5 2)) ((4 1) (3 0)) ((5 5) (3 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 4 server 1)
    (cat answer-3 cookie-1) (5 2))
  (label 478)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k480">Item <a href="#t0">480</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 442.200 225.660 344.639 336.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-3 cookie-1))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-3 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-3) (cookie cookie-1))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-3) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 480 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 cookie-0 answer-3 cookie-1
      request-1 data) (client proxy client-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-3)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand server 1 (request request-1) (answer answer-3)
    (cookie cookie-1))
  (defstrand proxy 2 (request request-1) (client client-0))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 0) (3 1)) ((6 1) (5 0)))
  (leadsto ((1 1) (4 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (4 1))
    ((4 1) (3 0)) ((5 0) (3 1)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-1 (5 0))
  (label 480)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k484">Item <a href="#t0">484</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-3 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-3 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-3) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (request2 answer-3) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 484 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 answer-3 cookie-0 request-1
      cookie-1 data) (client proxy client-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-0) (request2 answer-3)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand server 1 (request request-1) (answer answer-3)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 0) (4 1)) ((6 1) (5 0)))
  (leadsto ((1 1) (4 0)) ((2 0) (1 2)) ((3 0) (3 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 0) (4 1)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 3 server 1)
    (cat answer-4 cookie-1) (3 1))
  (label 484)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k485">Item <a href="#t0">485</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 592.740 189.960 545.760 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-3 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-3 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 391.484 262.464 343.167 334.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (answer answer-3) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (request2 answer-3) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 485 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 answer-3 cookie-0 request-1
      data) (client proxy client-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 2 (request request-0) (request2 answer-3)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand server 1 (request request-1) (answer answer-3)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (precedes ((1 1) (4 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 0) (3 1)) ((4 1) (3 0)) ((5 0) (4 1)) ((6 1) (5 0)))
  (leadsto ((1 1) (4 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (3 1))
    ((4 1) (3 0)) ((5 0) (4 1)) ((6 1) (5 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 4 server 1)
    (cat answer-4 cookie-1) (3 1))
  (label 485)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k493">Item <a href="#t0">493</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='414.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='564.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 493 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 request-1 request2-0
      syskey-0 cookie-0 cookie-1 data)
    (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (5 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((5 5) (4 1)))
  (leadsto ((2 0) (1 2)) ((3 0) (3 1)) ((3 1) (2 0)) ((4 0) (5 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((5 5) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 3 server 1)
    (cat answer-3 cookie-1) (3 1))
  (label 493)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k494">Item <a href="#t0">494</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='414.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='564.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 390.768 412.114 341.737 559.268'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 494 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 request-1 request2-0
      syskey-0 cookie-0 data) (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (3 1))
    ((4 0) (5 2)) ((4 1) (3 0)) ((5 1) (4 0)) ((5 5) (4 1)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (3 1)) ((4 0) (5 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((5 5) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 4 server 1)
    (cat answer-3 cookie-1) (3 1))
  (label 494)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k508">Item <a href="#t0">508</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='414.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='564.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 542.760 452.460 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 536.760 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-1) (proxy proxy-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 508 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 request-1 request-2
      request2-0 syskey-0 cookie-0 cookie-1 data)
    (client proxy client-0 client-1 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand proxy 6 (request request-2) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-1) (proxy proxy-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (6 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 5) (4 1)))
  (leadsto ((2 0) (1 2)) ((3 0) (3 1)) ((3 1) (2 0)) ((4 0) (6 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 5) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 3 server 1)
    (cat answer-3 cookie-1) (3 1))
  (label 508)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k509">Item <a href="#t0">509</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='414.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='564.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 542.760 452.460 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.180 225.660 444.599 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 390.768 412.114 341.737 559.268'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 536.760 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-1) (proxy proxy-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 509 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 request-1 request-2
      request2-0 syskey-0 cookie-0 data)
    (client proxy client-0 client-1 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 2 (request request-1) (request2 request2-0)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand proxy 6 (request request-2) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-1) (proxy proxy-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (3 1))
    ((4 0) (6 2)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 5) (4 1)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (3 1)) ((4 0) (6 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 5) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 4 server 1)
    (cat answer-3 cookie-1) (3 1))
  (label 509)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k516">Item <a href="#t0">516</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 442.800 452.460 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-1)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-1 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-1 (enc cookie-1 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-1)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 291.524 417.456 243.207 344.953'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-1) (cookie cookie-1) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 516 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 cookie-0 request-1
      request2-0 syskey-0 cookie-1 data)
    (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-1) (cookie cookie-1) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (5 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)) ((5 5) (3 1)))
  (leadsto ((2 0) (1 2)) ((3 0) (5 2)) ((3 1) (2 0)) ((4 0) (4 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((5 5) (3 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 3 server 1)
    (cat answer-3 cookie-1) (5 2))
  (label 516)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k517">Item <a href="#t0">517</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 442.800 452.460 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 391.484 337.464 343.167 409.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 487.380 225.660 534.961 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>sbp 517 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 cookie-0 request-1
      request2-0 syskey-0 data) (client proxy client-0 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (5 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((5 2) (4 1)) ((5 5) (3 1)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (4 1)) ((4 0) (5 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((5 5) (3 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 6 4 server 1)
    (cat answer-3 cookie-1) (5 2))
  (label 517)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k521">Item <a href="#t0">521</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 492.780 452.460 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-1)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-0 (enc cookie-1 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-1 (enc cookie-1 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-1)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 291.524 417.456 243.207 344.953'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 486.780 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer answer-1) (cookie cookie-1) (syskey syskey-0) (client client-1) (proxy proxy-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 521 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 request-1 cookie-0 request-2
      request2-0 syskey-0 cookie-1 data)
    (client proxy client-0 client-1 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand proxy 6 (request request-2) (request2 request2-0)
    (answer answer-1) (cookie cookie-1) (syskey syskey-0)
    (client client-1) (proxy proxy-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 0) (6 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 5) (3 1)))
  (leadsto ((2 0) (1 2)) ((3 0) (6 2)) ((3 1) (2 0)) ((4 0) (4 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 5) (3 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 3 server 1)
    (cat answer-3 cookie-1) (6 2))
  (label 521)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k522">Item <a href="#t0">522</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='489.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 489.960 Q 492.780 452.460 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-0 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-2 (enc cookie-0 (hash syskey-0 (ltk client-1 proxy-0))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 542.760 227.460 445.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 391.484 337.464 343.167 409.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 536.951 188.906 634.102 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-0 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (request2 request2-0) (answer answer-2) (cookie cookie-0) (syskey syskey-0) (client client-1) (proxy proxy-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 request2-0) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 522 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 request-1 cookie-0 request-2
      request2-0 syskey-0 data)
    (client proxy client-0 client-1 proxy-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 request2-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand proxy 6 (request request-2) (request2 request2-0)
    (answer answer-2) (cookie cookie-0) (syskey syskey-0)
    (client client-1) (proxy proxy-0))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (6 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 2) (4 1)) ((6 5) (3 1)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (4 1)) ((4 0) (6 2))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 5) (3 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 4 server 1)
    (cat answer-3 cookie-1) (6 2))
  (label 522)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k524">Item <a href="#t0">524</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 492.463 226.118 345.206 337.276'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-3 cookie-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-3 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-3) (cookie cookie-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-3) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 524 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 request-1 cookie-0 answer-3
      cookie-1 data) (client proxy client-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-3)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand server 1 (request request-0) (answer answer-3)
    (cookie cookie-1))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 0) (3 1)))
  (leadsto ((1 1) (6 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (4 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 0) (3 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 1 proxy 2) request-2 (6 0))
  (label 524)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k525">Item <a href="#t0">525</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 492.463 226.118 345.206 337.276'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-3 cookie-1))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-3 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-3) (cookie cookie-1))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-3) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 525 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 request-1 cookie-0 answer-3
      cookie-1 request-2 data) (client proxy client-0 client-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-3)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand server 1 (request request-2) (answer answer-3)
    (cookie cookie-1))
  (defstrand proxy 2 (request request-2) (client client-1))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 0) (3 1)) ((7 1) (6 0)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (4 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 0) (3 1)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (6 0))
  (label 525)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k529">Item <a href="#t0">529</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 542.569 188.906 445.418 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-3 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-3 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-3) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-3) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 529 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 request-1 answer-3 cookie-0
      cookie-1 data) (client proxy client-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-1) (request2 answer-3)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand server 1 (request request-0) (answer answer-3)
    (cookie cookie-0))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 0) (4 1)))
  (leadsto ((1 1) (6 0)) ((2 0) (1 2)) ((3 0) (3 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 0) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 3 server 1)
    (cat answer-4 cookie-1) (3 1))
  (label 529)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k530">Item <a href="#t0">530</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 542.569 188.906 445.418 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-3 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-3 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 391.484 262.464 343.167 334.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-3) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-3) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>sbp 530 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 request-1 answer-3 cookie-0
      data) (client proxy client-0 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 2 (request request-1) (request2 answer-3)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand server 1 (request request-0) (answer answer-3)
    (cookie cookie-0))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0))
    ((4 0) (3 1)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 0) (4 1)))
  (leadsto ((1 1) (6 0)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (3 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 0) (4 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 7 4 server 1)
    (cat answer-4 cookie-1) (3 1))
  (label 530)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k535">Item <a href="#t0">535</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 542.569 188.906 445.418 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-3 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-3 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-1) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-1))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-3) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-3) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 535 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 request-1 answer-3 cookie-0
      request-2 cookie-1 data) (client proxy client-0 client-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-1))
  (defstrand server 2 (request request-1) (request2 answer-3)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand server 1 (request request-2) (answer answer-3)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 0) (4 1)) ((7 1) (6 0)))
  (leadsto ((2 0) (1 2)) ((3 0) (3 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 0) (4 1)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 3 server 1)
    (cat answer-4 cookie-1) (3 1))
  (label 535)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k536">Item <a href="#t0">536</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 542.569 188.906 445.418 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-3 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-3 cookie-0) answer2-1)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 391.484 262.464 343.167 334.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(tran answer2-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client answer-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>((request request-2) (client client-1))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (answer answer-3) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-1) (client client-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 answer-3) (answer answer-2) (answer2 answer2-1) (cookie cookie-0))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 536 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 answer-0 cookie
      answer-1 answer2-0 answer-2 answer2-1 request-1 answer-3 cookie-0
      request-2 data) (client proxy client-0 client-1 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer answer-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request answer2-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 2 (request request-1) (request2 answer-3)
    (answer answer-2) (answer2 answer2-1) (cookie cookie-0))
  (defstrand proxy 2 (request request-1) (client client-0))
  (defstrand server 1 (request request-2) (answer answer-3)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-2) (client client-1))
  (precedes ((1 3) (0 1)) ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (3 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 0) (4 1)) ((7 1) (6 0)))
  (leadsto ((2 0) (1 2)) ((3 1) (2 0)) ((4 0) (3 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 0) (4 1)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 4 server 1)
    (cat answer-4 cookie-1) (3 1))
  (label 536)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k575">Item <a href="#t0">575</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1879.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1879.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='564.960' x2='539.760' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='789.960' x2='439.800' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='1014.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='1239.960' x2='239.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1614.960' x2='39.960' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.060 225.660 744.479 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 request2-5 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 answer-0 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-6</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-5 request-6)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 714.960 Q 592.740 714.960 545.760 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-4 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle style='fill: blue;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-5 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 939.960 Q 492.780 939.960 445.800 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-4 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 1164.960 Q 392.820 1164.960 345.840 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <path
   d='M 339.840 1389.960 Q 292.860 1389.960 245.880 1389.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1614.960 Q 192.900 1614.960 145.920 1614.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1614.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1539.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1464.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 1689.960 Q 92.940 1689.960 45.960 1689.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1689.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1614.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 486.780 152.460 833.640 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1839.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1764.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1689.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1614.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-6) (request2 request2-5) (answer answer-0) (cookie cookie) (syskey syskey-5) (client client-5) (proxy proxy-5))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-5) (request2 request2-4) (answer request2-5) (cookie cookie) (syskey syskey-4) (client client-4) (proxy proxy-4))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer request2-4) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 575 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 request-5
      request2-4 syskey-4 request-6 request2-5 syskey-5 answer-0 cookie
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 proxy-4 client-5 proxy-5 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer request2-4) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand proxy 6 (request request-5) (request2 request2-4)
    (answer request2-5) (cookie cookie) (syskey syskey-4)
    (client client-4) (proxy proxy-4))
  (defstrand proxy 6 (request request-6) (request2 request2-5)
    (answer answer-0) (cookie cookie) (syskey syskey-5)
    (client client-5) (proxy proxy-5))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((1 1) (8 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 5) (5 2)) ((7 5) (6 2))
    ((8 0) (7 2)))
  (leadsto ((1 1) (8 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 5) (5 2)) ((7 5) (6 2)) ((8 0) (7 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 9 1 proxy 2) request-7 (8 0))
  (label 575)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k576">Item <a href="#t0">576</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1879.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1879.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='564.960' x2='539.760' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='789.960' x2='439.800' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='1014.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1464.960' x2='139.920' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1614.960' x2='39.960' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.060 225.660 744.479 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 request2-5 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 answer-0 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-6</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-5 request-6)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 714.960 Q 592.740 714.960 545.760 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-4 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle style='fill: blue;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-5 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 939.960 Q 492.780 939.960 445.800 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-4 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 1164.960 Q 392.820 1164.960 345.840 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <path
   d='M 339.840 1389.960 Q 292.860 1389.960 245.880 1389.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1614.960 Q 192.900 1614.960 145.920 1614.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1614.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1539.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1464.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 189.960 Q 536.760 152.460 833.640 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1689.960 Q 92.940 1689.960 45.960 1689.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1689.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1614.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1539.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1464.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1839.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1764.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1689.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1614.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-0) (cookie cookie))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-6) (request2 request2-5) (answer answer-0) (cookie cookie) (syskey syskey-5) (client client-5) (proxy proxy-5))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-5) (request2 request2-4) (answer request2-5) (cookie cookie) (syskey syskey-4) (client client-4) (proxy proxy-4))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer request2-4) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 576 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 request-5
      request2-4 syskey-4 request-6 request2-5 syskey-5 answer-0 cookie
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 proxy-4 client-5 proxy-5 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer request2-4) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand proxy 6 (request request-5) (request2 request2-4)
    (answer request2-5) (cookie cookie) (syskey syskey-4)
    (client client-4) (proxy proxy-4))
  (defstrand proxy 6 (request request-6) (request2 request2-5)
    (answer answer-0) (cookie cookie) (syskey syskey-5)
    (client client-5) (proxy proxy-5))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 1) (8 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 5) (5 2)) ((7 5) (6 2))
    ((8 0) (7 2)))
  (leadsto ((2 1) (8 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 5) (5 2)) ((7 5) (6 2)) ((8 0) (7 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 9 2 proxy 2) request-7 (8 0))
  (label 576)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k577">Item <a href="#t0">577</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1879.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1879.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='564.960' x2='539.760' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='789.960' x2='439.800' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='1239.960' x2='239.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1464.960' x2='139.920' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1614.960' x2='39.960' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.060 225.660 744.479 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 request2-5 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 answer-0 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-6</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-5 request-6)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 714.960 Q 592.740 714.960 545.760 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-4 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle style='fill: blue;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-5 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 939.960 Q 492.780 939.960 445.800 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-4 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 1164.960 Q 392.820 1164.960 345.840 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <path
   d='M 339.840 1389.960 Q 292.860 1389.960 245.880 1389.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 339.840 189.960 Q 586.740 152.460 833.640 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1614.960 Q 192.900 1614.960 145.920 1614.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1614.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1539.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1464.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 1689.960 Q 92.940 1689.960 45.960 1689.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1689.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1614.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1539.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1464.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1839.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1764.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1689.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1614.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-0) (cookie cookie))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-6) (request2 request2-5) (answer answer-0) (cookie cookie) (syskey syskey-5) (client client-5) (proxy proxy-5))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-5) (request2 request2-4) (answer request2-5) (cookie cookie) (syskey syskey-4) (client client-4) (proxy proxy-4))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer request2-4) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 577 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 request-5
      request2-4 syskey-4 request-6 request2-5 syskey-5 answer-0 cookie
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 proxy-4 client-5 proxy-5 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer request2-4) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand proxy 6 (request request-5) (request2 request2-4)
    (answer request2-5) (cookie cookie) (syskey syskey-4)
    (client client-4) (proxy proxy-4))
  (defstrand proxy 6 (request request-6) (request2 request2-5)
    (answer answer-0) (cookie cookie) (syskey syskey-5)
    (client client-5) (proxy proxy-5))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (8 0)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 5) (5 2)) ((7 5) (6 2))
    ((8 0) (7 2)))
  (leadsto ((2 5) (1 2)) ((3 1) (8 0)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 5) (5 2)) ((7 5) (6 2)) ((8 0) (7 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 9 3 proxy 2) request-7 (8 0))
  (label 577)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k578">Item <a href="#t0">578</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1879.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1879.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='564.960' x2='539.760' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='1014.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='1239.960' x2='239.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1464.960' x2='139.920' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1614.960' x2='39.960' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.060 225.660 744.479 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 request2-5 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 answer-0 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-6</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-5 request-6)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 714.960 Q 592.740 714.960 545.760 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-4 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle style='fill: blue;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-5 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 939.960 Q 492.780 939.960 445.800 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-4 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 1164.960 Q 392.820 1164.960 345.840 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 636.720 152.460 833.640 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 1389.960 Q 292.860 1389.960 245.880 1389.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1614.960 Q 192.900 1614.960 145.920 1614.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1614.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1539.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1464.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 1689.960 Q 92.940 1689.960 45.960 1689.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1689.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1614.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1539.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1464.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1839.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1764.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1689.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1614.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (answer answer-0) (cookie cookie))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-6) (request2 request2-5) (answer answer-0) (cookie cookie) (syskey syskey-5) (client client-5) (proxy proxy-5))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-5) (request2 request2-4) (answer request2-5) (cookie cookie) (syskey syskey-4) (client client-4) (proxy proxy-4))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer request2-4) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 578 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 request-5
      request2-4 syskey-4 request-6 request2-5 syskey-5 answer-0 cookie
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 proxy-4 client-5 proxy-5 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer request2-4) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand proxy 6 (request request-5) (request2 request2-4)
    (answer request2-5) (cookie cookie) (syskey syskey-4)
    (client client-4) (proxy proxy-4))
  (defstrand proxy 6 (request request-6) (request2 request2-5)
    (answer answer-0) (cookie cookie) (syskey syskey-5)
    (client client-5) (proxy proxy-5))
  (defstrand server 1 (request request-3) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (8 0))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 5) (5 2)) ((7 5) (6 2))
    ((8 0) (7 2)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (8 0)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 5) (5 2)) ((7 5) (6 2)) ((8 0) (7 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 9 4 proxy 2) request-7 (8 0))
  (label 578)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k579">Item <a href="#t0">579</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1879.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1879.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='789.960' x2='439.800' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='1014.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='1239.960' x2='239.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1464.960' x2='139.920' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1614.960' x2='39.960' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.060 225.660 744.479 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 request2-5 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 answer-0 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-6</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-5 request-6)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 714.960 Q 592.740 714.960 545.760 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-4 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle style='fill: blue;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-5 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 939.960 Q 492.780 939.960 445.800 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-4 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 686.700 152.460 833.640 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 1164.960 Q 392.820 1164.960 345.840 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <path
   d='M 339.840 1389.960 Q 292.860 1389.960 245.880 1389.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1614.960 Q 192.900 1614.960 145.920 1614.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1614.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1539.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1464.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 1689.960 Q 92.940 1689.960 45.960 1689.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1689.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1614.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1539.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1464.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1839.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1764.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1689.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1614.960' r='6.000'/></g>
  <g>
   <title>((request request-4) (answer answer-0) (cookie cookie))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-6) (request2 request2-5) (answer answer-0) (cookie cookie) (syskey syskey-5) (client client-5) (proxy proxy-5))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-5) (request2 request2-4) (answer request2-5) (cookie cookie) (syskey syskey-4) (client client-4) (proxy proxy-4))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer request2-4) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 579 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 request-5
      request2-4 syskey-4 request-6 request2-5 syskey-5 answer-0 cookie
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 proxy-4 client-5 proxy-5 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer request2-4) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand proxy 6 (request request-5) (request2 request2-4)
    (answer request2-5) (cookie cookie) (syskey syskey-4)
    (client client-4) (proxy proxy-4))
  (defstrand proxy 6 (request request-6) (request2 request2-5)
    (answer answer-0) (cookie cookie) (syskey syskey-5)
    (client client-5) (proxy proxy-5))
  (defstrand server 1 (request request-4) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 1) (8 0)) ((5 5) (4 2)) ((6 5) (5 2)) ((7 5) (6 2))
    ((8 0) (7 2)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 1) (8 0))
    ((5 5) (4 2)) ((6 5) (5 2)) ((7 5) (6 2)) ((8 0) (7 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 9 5 proxy 2) request-7 (8 0))
  (label 579)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k580">Item <a href="#t0">580</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1879.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1879.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='564.960' x2='539.760' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='789.960' x2='439.800' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='1014.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='1239.960' x2='239.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1464.960' x2='139.920' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1614.960' x2='39.960' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.060 225.660 744.479 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-5 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 request2-5 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 answer-0 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-6</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-5 request-6)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 714.960 Q 592.740 714.960 545.760 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-4 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle style='fill: blue;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-5 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 736.680 152.460 833.640 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 939.960 Q 492.780 939.960 445.800 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-4 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 1164.960 Q 392.820 1164.960 345.840 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <path
   d='M 339.840 1389.960 Q 292.860 1389.960 245.880 1389.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1614.960 Q 192.900 1614.960 145.920 1614.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1614.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1539.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1464.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 1689.960 Q 92.940 1689.960 45.960 1689.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1689.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1614.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1539.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1464.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1839.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1764.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1689.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1614.960' r='6.000'/></g>
  <g>
   <title>((request request-5) (answer answer-0) (cookie cookie))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-6) (request2 request2-5) (answer answer-0) (cookie cookie) (syskey syskey-5) (client client-5) (proxy proxy-5))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-5) (request2 request2-4) (answer request2-5) (cookie cookie) (syskey syskey-4) (client client-4) (proxy proxy-4))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer request2-4) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 580 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 request-5
      request2-4 syskey-4 request-6 request2-5 syskey-5 answer-0 cookie
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 proxy-4 client-5 proxy-5 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer request2-4) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand proxy 6 (request request-5) (request2 request2-4)
    (answer request2-5) (cookie cookie) (syskey syskey-4)
    (client client-4) (proxy proxy-4))
  (defstrand proxy 6 (request request-6) (request2 request2-5)
    (answer answer-0) (cookie cookie) (syskey syskey-5)
    (client client-5) (proxy proxy-5))
  (defstrand server 1 (request request-5) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 1) (8 0)) ((6 5) (5 2)) ((7 5) (6 2))
    ((8 0) (7 2)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 5) (4 2))
    ((6 1) (8 0)) ((6 5) (5 2)) ((7 5) (6 2)) ((8 0) (7 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 9 6 proxy 2) request-7 (8 0))
  (label 580)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k581">Item <a href="#t0">581</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1879.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1879.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='564.960' x2='539.760' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='789.960' x2='439.800' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='1014.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='1239.960' x2='239.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1464.960' x2='139.920' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1614.960' x2='39.960' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.060 225.660 744.479 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-6 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 request2-5 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 answer-0 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 786.660 189.960 833.640 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-6</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-5 request-6)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 714.960 Q 592.740 714.960 545.760 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-4 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle style='fill: blue;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-5 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 939.960 Q 492.780 939.960 445.800 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-4 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 1164.960 Q 392.820 1164.960 345.840 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <path
   d='M 339.840 1389.960 Q 292.860 1389.960 245.880 1389.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1614.960 Q 192.900 1614.960 145.920 1614.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1614.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1539.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1464.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 1689.960 Q 92.940 1689.960 45.960 1689.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1689.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1614.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1539.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1464.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1839.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1764.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1689.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1614.960' r='6.000'/></g>
  <g>
   <title>((request request-6) (answer answer-0) (cookie cookie))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-6) (request2 request2-5) (answer answer-0) (cookie cookie) (syskey syskey-5) (client client-5) (proxy proxy-5))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-5) (request2 request2-4) (answer request2-5) (cookie cookie) (syskey syskey-4) (client client-4) (proxy proxy-4))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer request2-4) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 581 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 request-5
      request2-4 syskey-4 request-6 request2-5 syskey-5 answer-0 cookie
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 proxy-4 client-5 proxy-5 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer request2-4) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand proxy 6 (request request-5) (request2 request2-4)
    (answer request2-5) (cookie cookie) (syskey syskey-4)
    (client client-4) (proxy proxy-4))
  (defstrand proxy 6 (request request-6) (request2 request2-5)
    (answer answer-0) (cookie cookie) (syskey syskey-5)
    (client client-5) (proxy proxy-5))
  (defstrand server 1 (request request-6) (answer answer-0)
    (cookie cookie))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 5) (5 2)) ((7 1) (8 0)) ((7 5) (6 2))
    ((8 0) (7 2)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 5) (4 2))
    ((6 5) (5 2)) ((7 1) (8 0)) ((7 5) (6 2)) ((8 0) (7 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 9 7 proxy 2) request-7 (8 0))
  (label 581)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k582">Item <a href="#t0">582</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1879.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1879.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='564.960' x2='539.760' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='789.960' x2='439.800' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='1014.960' x2='339.840' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='1239.960' x2='239.880' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1464.960' x2='139.920' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1614.960' x2='39.960' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 189.960 Q 892.620 189.960 845.640 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-7</title>
   <circle style='fill: gray;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-6 request-7)</title>
   <circle style='fill: blue;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 189.960 Q 792.060 225.660 744.479 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-7 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 request2-5 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-5 answer-0 (enc cookie (hash syskey-5 (ltk client-5 proxy-5))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-6</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-5 request-6)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 714.960 Q 592.740 714.960 545.760 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-4 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle style='fill: blue;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-5 (enc cookie (hash syskey-4 (ltk client-4 proxy-4))))</title>
   <circle cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-5 cookie)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 939.960 Q 492.780 939.960 445.800 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-4 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-4 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 1164.960 Q 392.820 1164.960 345.840 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='939.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='789.960' r='6.000'/></g>
  <path
   d='M 339.840 1389.960 Q 292.860 1389.960 245.880 1389.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1389.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='1314.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='1014.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 1614.960 Q 192.900 1614.960 145.920 1614.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1614.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1539.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1464.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1389.960' r='6.000'/>
   </g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='1314.960' r='6.000'/>
   </g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='1239.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 1689.960 Q 92.940 1689.960 45.960 1689.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1689.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1614.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1539.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1464.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1839.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1764.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1689.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1614.960' r='6.000'/></g>
  <g><title>((request request-7) (client client-6))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-7) (answer answer-0) (cookie cookie))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-6) (request2 request2-5) (answer answer-0) (cookie cookie) (syskey syskey-5) (client client-5) (proxy proxy-5))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-5) (request2 request2-4) (answer request2-5) (cookie cookie) (syskey syskey-4) (client client-4) (proxy proxy-4))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer request2-4) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 582 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 request-5
      request2-4 syskey-4 request-6 request2-5 syskey-5 answer-0 cookie
      request-7 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 proxy-4 client-5 proxy-5 client-6 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer request2-4) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand proxy 6 (request request-5) (request2 request2-4)
    (answer request2-5) (cookie cookie) (syskey syskey-4)
    (client client-4) (proxy proxy-4))
  (defstrand proxy 6 (request request-6) (request2 request2-5)
    (answer answer-0) (cookie cookie) (syskey syskey-5)
    (client client-5) (proxy proxy-5))
  (defstrand server 1 (request request-7) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-7) (client client-6))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 5) (5 2)) ((7 5) (6 2)) ((8 0) (7 2))
    ((9 1) (8 0)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 5) (4 2))
    ((6 5) (5 2)) ((7 5) (6 2)) ((8 0) (7 2)) ((9 1) (8 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-7 (8 0))
  (label 582)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k593">Item <a href="#t0">593</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-0 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 436.800 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-0) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 593 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 answer-0 cookie
      answer-1 answer2-0 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-0) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((1 1) (7 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 0) (5 2)) ((7 1) (6 0)))
  (leadsto ((1 1) (7 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 0) (5 2)) ((7 0) (7 1)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 7 server 1)
    (cat answer-2 cookie-0) (7 1))
  (label 593)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k596">Item <a href="#t0">596</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-0 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 486.780 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-0) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 596 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 answer-0 cookie
      answer-1 answer2-0 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-0) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (7 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 0) (5 2)) ((7 1) (6 0)))
  (leadsto ((2 1) (7 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 0) (5 2)) ((7 0) (7 1)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 7 server 1)
    (cat answer-2 cookie-0) (7 1))
  (label 596)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k599">Item <a href="#t0">599</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-0 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 536.760 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-0) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 599 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 answer-0 cookie
      answer-1 answer2-0 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-0) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (7 0)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 0) (5 2)) ((7 1) (6 0)))
  (leadsto ((2 5) (1 2)) ((3 1) (7 0)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 0) (5 2)) ((7 0) (7 1)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 7 server 1)
    (cat answer-2 cookie-0) (7 1))
  (label 599)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k602">Item <a href="#t0">602</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-0 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 586.740 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-0) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 602 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 answer-0 cookie
      answer-1 answer2-0 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-0) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (7 0))
    ((4 5) (3 2)) ((5 5) (4 2)) ((6 0) (5 2)) ((7 1) (6 0)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (7 0)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 0) (5 2)) ((7 0) (7 1)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 7 server 1)
    (cat answer-2 cookie-0) (7 1))
  (label 602)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k605">Item <a href="#t0">605</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-4 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-0 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 636.720 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-4) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-0) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 605 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 answer-0 cookie
      answer-1 answer2-0 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-0) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-4) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 1) (7 0)) ((5 5) (4 2)) ((6 0) (5 2)) ((7 1) (6 0)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 1) (7 0))
    ((5 5) (4 2)) ((6 0) (5 2)) ((7 0) (7 1)) ((7 1) (6 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 7 server 1)
    (cat answer-2 cookie-0) (7 1))
  (label 605)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k609">Item <a href="#t0">609</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.660 189.960 745.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-1 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-5 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-0 (enc cookie (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g><title>((request request-5) (client client-4))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-5) (request2 answer-1) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-0) (cookie cookie) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 609 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 request-4 request2-3 syskey-3 answer-0 cookie
      answer-1 answer2-0 request-5 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 client-4 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-0) (cookie cookie) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-5) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-5) (client client-4))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 5) (4 2)) ((6 0) (5 2)) ((7 1) (6 0)) ((8 1) (7 0)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 5) (4 2))
    ((6 0) (5 2)) ((7 0) (7 1)) ((7 1) (6 0)) ((8 1) (7 0)))
  (non-orig syskey)
  (operation state-passing-test (displaced 9 7 server 1)
    (cat answer-2 cookie-0) (7 1))
  (label 609)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k619">Item <a href="#t0">619</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='489.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-1 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-3 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 686.700 264.960 733.680 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 264.960 Q 386.820 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-1) (cookie cookie-0) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-3) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 619 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 request-4
      request2-3 syskey-3 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-3)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-1) (cookie cookie-0) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 0) (7 2)) ((6 1) (5 0))
    ((7 5) (6 1)))
  (leadsto ((1 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 0) (7 2)) ((6 1) (5 0)) ((7 5) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-2 cookie-0) (7 2))
  (label 619)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k621">Item <a href="#t0">621</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 486.780 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 621 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 1) (7 0)) ((2 5) (1 2))
    ((3 5) (2 2)) ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0))
    ((7 0) (6 1)))
  (leadsto ((1 1) (6 0)) ((2 1) (7 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 2 proxy 2) request-4 (7 0))
  (label 621)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k622">Item <a href="#t0">622</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 536.760 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 622 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (7 0))
    ((3 5) (2 2)) ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0))
    ((7 0) (6 1)))
  (leadsto ((1 1) (6 0)) ((2 5) (1 2)) ((3 1) (7 0)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 3 proxy 2) request-4 (7 0))
  (label 622)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k623">Item <a href="#t0">623</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 586.740 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 623 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 1) (7 0)) ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0))
    ((7 0) (6 1)))
  (leadsto ((1 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (7 0))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 4 proxy 2) request-4 (7 0))
  (label 623)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k624">Item <a href="#t0">624</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.660 189.960 745.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 386.820 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-0) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 624 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 request-4 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-4) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (precedes ((1 1) (6 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1))
    ((8 1) (7 0)))
  (leadsto ((1 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)) ((8 1) (7 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-4 (7 0))
  (label 624)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k627">Item <a href="#t0">627</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='489.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-1 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-3 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 686.700 264.960 733.680 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 436.800 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-1) (cookie cookie-0) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-3) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 627 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 request-4
      request2-3 syskey-3 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-3)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-1) (cookie cookie-0) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (precedes ((1 3) (0 1)) ((2 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 0) (7 2)) ((6 1) (5 0))
    ((7 5) (6 1)))
  (leadsto ((2 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 0) (7 2)) ((6 1) (5 0)) ((7 5) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-2 cookie-0) (7 2))
  (label 627)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k629">Item <a href="#t0">629</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 436.800 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 629 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (7 0)) ((1 3) (0 1)) ((2 1) (6 0)) ((2 5) (1 2))
    ((3 5) (2 2)) ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0))
    ((7 0) (6 1)))
  (leadsto ((1 1) (7 0)) ((2 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 1 proxy 2) request-4 (7 0))
  (label 629)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k630">Item <a href="#t0">630</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 536.760 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 630 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (6 0)) ((2 5) (1 2)) ((3 1) (7 0))
    ((3 5) (2 2)) ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0))
    ((7 0) (6 1)))
  (leadsto ((2 1) (6 0)) ((2 5) (1 2)) ((3 1) (7 0)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 3 proxy 2) request-4 (7 0))
  (label 630)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k631">Item <a href="#t0">631</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 586.740 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 631 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 1) (7 0)) ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0))
    ((7 0) (6 1)))
  (leadsto ((2 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (7 0))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 4 proxy 2) request-4 (7 0))
  (label 631)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k632">Item <a href="#t0">632</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.660 189.960 745.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-1) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 632 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 request-4 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-4) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (precedes ((1 3) (0 1)) ((2 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1))
    ((8 1) (7 0)))
  (leadsto ((2 1) (6 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)) ((8 1) (7 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-4 (7 0))
  (label 632)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k635">Item <a href="#t0">635</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='489.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-1 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-3 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 686.700 264.960 733.680 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 486.780 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-1) (cookie cookie-0) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-3) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 635 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 request-4
      request2-3 syskey-3 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-3)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-1) (cookie cookie-0) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (6 0)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 0) (7 2)) ((6 1) (5 0))
    ((7 5) (6 1)))
  (leadsto ((2 5) (1 2)) ((3 1) (6 0)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 0) (7 2)) ((6 1) (5 0)) ((7 5) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-2 cookie-0) (7 2))
  (label 635)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k637">Item <a href="#t0">637</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 486.780 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 436.800 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 637 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (7 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (6 0))
    ((3 5) (2 2)) ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0))
    ((7 0) (6 1)))
  (leadsto ((1 1) (7 0)) ((2 5) (1 2)) ((3 1) (6 0)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 1 proxy 2) request-4 (7 0))
  (label 637)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k638">Item <a href="#t0">638</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 486.780 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 486.780 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 638 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (7 0)) ((2 5) (1 2)) ((3 1) (6 0))
    ((3 5) (2 2)) ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0))
    ((7 0) (6 1)))
  (leadsto ((2 1) (7 0)) ((2 5) (1 2)) ((3 1) (6 0)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 2 proxy 2) request-4 (7 0))
  (label 638)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k639">Item <a href="#t0">639</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 586.740 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 486.780 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 639 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (6 0)) ((3 5) (2 2))
    ((4 1) (7 0)) ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0))
    ((7 0) (6 1)))
  (leadsto ((2 5) (1 2)) ((3 1) (6 0)) ((3 5) (2 2)) ((4 1) (7 0))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 4 proxy 2) request-4 (7 0))
  (label 639)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k640">Item <a href="#t0">640</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.660 189.960 745.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 486.780 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 640 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 request-4 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-4) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (6 0)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1))
    ((8 1) (7 0)))
  (leadsto ((2 5) (1 2)) ((3 1) (6 0)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)) ((8 1) (7 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-4 (7 0))
  (label 640)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k643">Item <a href="#t0">643</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='489.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-1 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-3 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 686.700 264.960 733.680 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 536.760 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-1) (cookie cookie-0) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-3) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 643 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 request-4
      request2-3 syskey-3 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 request2-3)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-1) (cookie cookie-0) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (6 0))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 0) (7 2)) ((6 1) (5 0))
    ((7 5) (6 1)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (6 0)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 0) (7 2)) ((6 1) (5 0)) ((7 5) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-2 cookie-0) (7 2))
  (label 643)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k645">Item <a href="#t0">645</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 536.760 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 436.800 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 645 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (7 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 1) (6 0)) ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0))
    ((7 0) (6 1)))
  (leadsto ((1 1) (7 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (6 0))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 1 proxy 2) request-4 (7 0))
  (label 645)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k646">Item <a href="#t0">646</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 536.760 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 486.780 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 646 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (7 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 1) (6 0)) ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0))
    ((7 0) (6 1)))
  (leadsto ((2 1) (7 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (6 0))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 2 proxy 2) request-4 (7 0))
  (label 646)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k647">Item <a href="#t0">647</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 536.760 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 536.760 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 647 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (7 0)) ((3 5) (2 2))
    ((4 1) (6 0)) ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0))
    ((7 0) (6 1)))
  (leadsto ((2 5) (1 2)) ((3 1) (7 0)) ((3 5) (2 2)) ((4 1) (6 0))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 3 proxy 2) request-4 (7 0))
  (label 647)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k648">Item <a href="#t0">648</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.660 189.960 745.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-3 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 536.760 152.460 633.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 648 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 answer-2
      cookie-0 request-4 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-3) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand server 1 (request request-4) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (6 0))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1))
    ((8 1) (7 0)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (6 0)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 1) (5 0)) ((7 0) (6 1)) ((8 1) (7 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-4 (7 0))
  (label 648)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k651">Item <a href="#t0">651</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='489.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-1 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-3 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 686.700 264.960 733.680 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-1) (cookie cookie-0) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 651 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 request-4
      request2-3 syskey-3 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-4) (request2 request2-3)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-1) (cookie cookie-0) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 0) (7 2)) ((6 1) (5 0)) ((7 1) (6 0))
    ((7 5) (6 1)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 0) (4 2))
    ((6 0) (7 2)) ((6 1) (5 0)) ((7 1) (6 0)) ((7 5) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-2 cookie-0) (7 2))
  (label 651)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k655">Item <a href="#t0">655</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='489.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 489.960 Q 742.680 452.460 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie-0)</title>
   <circle style='fill: gray;' cx='839.640' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 request2-3 (enc cookie-0 (hash syskey-3 (ltk client-4 proxy-3))))</title>
   <circle style='fill: blue;' cx='839.640' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-4 answer-1 (enc cookie-0 (hash syskey-3 (ltk client-4 proxy-3))))</title>
   <circle cx='839.640' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-3 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 736.680 227.460 833.640 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-5) (request2 request2-3) (answer answer-1) (cookie cookie-0) (syskey syskey-3) (client client-4) (proxy proxy-3))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 655 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 request-4
      request-5 request2-3 syskey-3 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 client-4 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-4) (request2 request2-3)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (defstrand proxy 6 (request request-5) (request2 request2-3)
    (answer answer-1) (cookie cookie-0) (syskey syskey-3)
    (client client-4) (proxy proxy-3))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 0) (8 2)) ((6 1) (5 0)) ((7 1) (6 0))
    ((8 5) (6 1)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 0) (4 2))
    ((6 0) (8 2)) ((6 1) (5 0)) ((7 1) (6 0)) ((8 5) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 9 6 server 1)
    (cat answer-2 cookie-0) (8 2))
  (label 655)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k657">Item <a href="#t0">657</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 742.489 188.906 645.338 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-4 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 486.780 152.460 833.640 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 657 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 request-4
      answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-4) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (8 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 1) (6 0))
    ((8 0) (6 1)))
  (leadsto ((1 1) (8 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 1) (5 0)) ((7 1) (6 0)) ((8 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 9 1 proxy 2) request-5 (8 0))
  (label 657)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k658">Item <a href="#t0">658</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 742.489 188.906 645.338 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-4 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 536.760 152.460 833.640 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 658 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 request-4
      answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-4) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (8 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 1) (6 0))
    ((8 0) (6 1)))
  (leadsto ((2 1) (8 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 1) (5 0)) ((7 1) (6 0)) ((8 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 9 2 proxy 2) request-5 (8 0))
  (label 658)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k659">Item <a href="#t0">659</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 742.489 188.906 645.338 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-4 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 586.740 152.460 833.640 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 659 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 request-4
      answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-4) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (8 0)) ((3 5) (2 2))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 1) (6 0))
    ((8 0) (6 1)))
  (leadsto ((2 5) (1 2)) ((3 1) (8 0)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 1) (5 0)) ((7 1) (6 0)) ((8 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 9 3 proxy 2) request-5 (8 0))
  (label 659)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k660">Item <a href="#t0">660</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 742.489 188.906 645.338 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-4 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 636.720 152.460 833.640 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 660 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 request-4
      answer-2 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-4) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (8 0))
    ((4 5) (3 2)) ((5 0) (4 2)) ((6 1) (5 0)) ((7 1) (6 0))
    ((8 0) (6 1)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 1) (8 0)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 1) (5 0)) ((7 1) (6 0)) ((8 0) (6 1)))
  (non-orig syskey)
  (operation state-passing-test (displaced 9 4 proxy 2) request-5 (8 0))
  (label 660)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k661">Item <a href="#t0">661</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='114.960' x2='939.600' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 189.960 Q 892.620 189.960 845.640 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-5</title>
   <circle style='fill: gray;' cx='939.600' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-4 request-5)</title>
   <circle style='fill: blue;' cx='939.600' cy='114.960' r='6.000'/></g>
  <path
   d='M 839.640 189.960 Q 742.489 188.906 645.338 262.852'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-5 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat answer-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(tran request-4 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-0 (enc cookie (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-2 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-2 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>((request request-5) (client client-4))</title>
   <text
    x='939.600' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-5) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (request2 answer-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-0) (cookie cookie) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer request2-2) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>sbp 661 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 request-3
      request2-2 syskey-2 answer-0 cookie answer-1 answer2-0 request-4
      answer-2 cookie-0 request-5 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 client-4 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-4) (request2 answer-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (defstrand server 1 (request request-5) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-5) (client client-4))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2))
    ((5 0) (4 2)) ((6 1) (5 0)) ((7 1) (6 0)) ((8 0) (6 1))
    ((9 1) (8 0)))
  (leadsto ((2 5) (1 2)) ((3 5) (2 2)) ((4 5) (3 2)) ((5 0) (4 2))
    ((6 1) (5 0)) ((7 1) (6 0)) ((8 0) (6 1)) ((9 1) (8 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-5 (8 0))
  (label 661)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k686">Item <a href="#t0">686</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='714.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-1 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 714.960 Q 592.740 714.960 545.760 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 636.720 227.460 733.680 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 264.960 Q 336.840 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-1) (cookie cookie-0) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 686 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 request-4
      request2-3 syskey-3 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-1) (cookie cookie-0) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (precedes ((1 1) (5 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 0) (7 2)) ((5 1) (4 0)) ((6 5) (5 1))
    ((7 5) (6 2)))
  (leadsto ((1 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 0) (7 2)) ((5 1) (4 0)) ((6 5) (5 1)) ((7 5) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 5 server 1)
    (cat answer-2 cookie-0) (7 2))
  (label 686)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k688">Item <a href="#t0">688</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 486.780 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 336.840 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-2) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 688 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 answer-2 cookie-0
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-2) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (5 0)) ((1 3) (0 1)) ((2 1) (7 0)) ((2 5) (1 2))
    ((3 5) (2 2)) ((4 0) (3 2)) ((5 1) (4 0)) ((6 5) (5 1))
    ((7 0) (6 2)))
  (leadsto ((1 1) (5 0)) ((2 1) (7 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 5) (5 1)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 2 proxy 2) request-4 (7 0))
  (label 688)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k689">Item <a href="#t0">689</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 536.760 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 336.840 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-2) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 689 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 answer-2 cookie-0
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-2) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (5 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (7 0))
    ((3 5) (2 2)) ((4 0) (3 2)) ((5 1) (4 0)) ((6 5) (5 1))
    ((7 0) (6 2)))
  (leadsto ((1 1) (5 0)) ((2 5) (1 2)) ((3 1) (7 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 5) (5 1)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 3 proxy 2) request-4 (7 0))
  (label 689)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k690">Item <a href="#t0">690</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 686.700 189.960 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 336.840 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-2) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 690 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 answer-2 cookie-0
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-2) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (5 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 1) (7 0)) ((6 5) (5 1))
    ((7 0) (6 2)))
  (leadsto ((1 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)) ((6 1) (7 0)) ((6 5) (5 1)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 6 proxy 2) request-4 (7 0))
  (label 690)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k691">Item <a href="#t0">691</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.660 189.960 745.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-0 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 336.840 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-2) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 691 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 answer-2 cookie-0
      request-4 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-0) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-2) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-4) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (precedes ((1 1) (5 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 5) (5 1)) ((7 0) (6 2))
    ((8 1) (7 0)))
  (leadsto ((1 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)) ((6 5) (5 1)) ((7 0) (6 2)) ((8 1) (7 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-4 (7 0))
  (label 691)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k698">Item <a href="#t0">698</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='714.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='564.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-1 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 714.960 Q 592.740 714.960 545.760 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 636.720 227.460 733.680 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 386.820 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-1) (cookie cookie-0) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 698 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 request-4
      request2-3 syskey-3 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-1) (cookie cookie-0) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (precedes ((1 3) (0 1)) ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 0) (7 2)) ((5 1) (4 0)) ((6 5) (5 1))
    ((7 5) (6 2)))
  (leadsto ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 0) (7 2)) ((5 1) (4 0)) ((6 5) (5 1)) ((7 5) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 5 server 1)
    (cat answer-2 cookie-0) (7 2))
  (label 698)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k700">Item <a href="#t0">700</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 386.820 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 436.800 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-2) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 700 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 answer-2 cookie-0
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-2) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (7 0)) ((1 3) (0 1)) ((2 1) (5 0)) ((2 5) (1 2))
    ((3 5) (2 2)) ((4 0) (3 2)) ((5 1) (4 0)) ((6 5) (5 1))
    ((7 0) (6 2)))
  (leadsto ((1 1) (7 0)) ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 5) (5 1)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 1 proxy 2) request-4 (7 0))
  (label 700)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k701">Item <a href="#t0">701</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 536.760 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 386.820 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-2) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-2) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 701 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 answer-2 cookie-0
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-2) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (5 0)) ((2 5) (1 2)) ((3 1) (7 0))
    ((3 5) (2 2)) ((4 0) (3 2)) ((5 1) (4 0)) ((6 5) (5 1))
    ((7 0) (6 2)))
  (leadsto ((2 1) (5 0)) ((2 5) (1 2)) ((3 1) (7 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 5) (5 1)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 3 proxy 2) request-4 (7 0))
  (label 701)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k702">Item <a href="#t0">702</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 686.700 189.960 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 386.820 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-2) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 702 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 answer-2 cookie-0
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-2) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 1) (7 0)) ((6 5) (5 1))
    ((7 0) (6 2)))
  (leadsto ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)) ((6 1) (7 0)) ((6 5) (5 1)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 6 proxy 2) request-4 (7 0))
  (label 702)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k703">Item <a href="#t0">703</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.660 189.960 745.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-1 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 386.820 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-2) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 703 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 answer-2 cookie-0
      request-4 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-2) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-4) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (precedes ((1 3) (0 1)) ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 5) (5 1)) ((7 0) (6 2))
    ((8 1) (7 0)))
  (leadsto ((2 1) (5 0)) ((2 5) (1 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)) ((6 5) (5 1)) ((7 0) (6 2)) ((8 1) (7 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-4 (7 0))
  (label 703)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k710">Item <a href="#t0">710</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1429.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1429.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='714.960' x2='439.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='789.960' x2='239.880' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='1014.960' x2='139.920' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='1164.960' x2='39.960' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 489.960 Q 692.700 489.960 645.720 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-3 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 request2-3 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle style='fill: blue;' cx='739.680' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-3 answer-1 (enc cookie-0 (hash syskey-3 (ltk client-3 proxy-3))))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-1 cookie-0)</title>
   <circle style='fill: gray;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 714.960 Q 592.740 714.960 545.760 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-3 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='564.960' r='6.000'/></g>
  <g><title>(cat request2-3 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 714.960 Q 492.780 714.960 445.800 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='714.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 636.720 227.460 733.680 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 714.960 Q 392.820 714.960 345.840 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 939.960 Q 292.860 939.960 245.880 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 1164.960 Q 192.900 1164.960 145.920 1164.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='1164.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='1089.960' r='6.000'/>
   </g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <path
   d='M 139.920 1239.960 Q 92.940 1239.960 45.960 1239.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1239.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='1164.960' r='6.000'/>
   </g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='1089.960' r='6.000'/>
   </g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='1014.960' r='6.000'/>
   </g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1389.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1314.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1239.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>((request request-4) (request2 request2-3) (answer answer-1) (cookie cookie-0) (syskey syskey-3) (client client-3) (proxy proxy-3))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer request2-3) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 710 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 request-4
      request2-3 syskey-3 cookie-0 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 proxy-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer request2-3) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand proxy 6 (request request-4) (request2 request2-3)
    (answer answer-1) (cookie cookie-0) (syskey syskey-3)
    (client client-3) (proxy proxy-3))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 0) (7 2)) ((5 1) (4 0)) ((6 5) (5 1))
    ((7 5) (6 2)))
  (leadsto ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 0) (7 2)) ((5 1) (4 0)) ((6 5) (5 1)) ((7 5) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 5 server 1)
    (cat answer-2 cookie-0) (7 2))
  (label 710)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k712">Item <a href="#t0">712</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-0 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 436.800 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 436.800 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-0) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-2) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 712 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 answer-2 cookie-0
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-2) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 1) (7 0)) ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (5 0))
    ((3 5) (2 2)) ((4 0) (3 2)) ((5 1) (4 0)) ((6 5) (5 1))
    ((7 0) (6 2)))
  (leadsto ((1 1) (7 0)) ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 5) (5 1)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 1 proxy 2) request-4 (7 0))
  (label 712)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k713">Item <a href="#t0">713</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-1 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 436.800 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 486.780 152.460 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-1) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-2) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 713 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 answer-2 cookie-0
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-2) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 1) (7 0)) ((2 5) (1 2)) ((3 1) (5 0))
    ((3 5) (2 2)) ((4 0) (3 2)) ((5 1) (4 0)) ((6 5) (5 1))
    ((7 0) (6 2)))
  (leadsto ((2 1) (7 0)) ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 5) (5 1)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 2 proxy 2) request-4 (7 0))
  (label 713)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k714">Item <a href="#t0">714</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-3 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 686.700 189.960 733.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 436.800 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>((request request-3) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-2) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>sbp 714 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 answer-2 cookie-0
      data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-2) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-3) (answer answer-2)
    (cookie cookie-0))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 1) (7 0)) ((6 5) (5 1))
    ((7 0) (6 2)))
  (leadsto ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)) ((6 1) (7 0)) ((6 5) (5 1)) ((7 0) (6 2)))
  (non-orig syskey)
  (operation state-passing-test (displaced 8 6 proxy 2) request-4 (7 0))
  (label 714)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

<p id="k715">Item <a href="#t0">715</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='1204.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 1204.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='489.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='564.960' x2='239.880' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='789.960' x2='139.920' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='939.960' x2='39.960' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.660 189.960 745.680 189.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-4</title>
   <circle style='fill: gray;' cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-3 request-4)</title>
   <circle style='fill: blue;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 692.100 225.660 644.519 261.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran request-4 (cat answer-2 cookie-0))</title>
   <circle style='fill: gray;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 592.740 489.960 545.760 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 request2-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat client-2 answer-2 (enc cookie-0 (hash syskey-2 (ltk client-2 proxy-2))))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat answer-2 cookie-0)</title>
   <circle style='fill: gray;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>request-3</title>
   <circle style='fill: gray;' cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat client-2 request-3)</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran (cat request2-2 cookie-0) answer2-0)</title>
   <circle style='fill: gray;' cx='539.760' cy='489.960' r='6.000'/></g>
  <g><title>(tran request-2 (cat answer-1 cookie-0))</title>
   <circle style='fill: gray;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(tran answer2-0 (cat answer-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 714.960 Q 292.860 714.960 245.880 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 request2-1 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle style='fill: blue;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat client-1 answer-0 (enc cookie (hash syskey-1 (ltk client-1 proxy-1))))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(cat answer-0 cookie)</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 436.800 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>request-2</title>
   <circle style='fill: gray;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat client-1 request-2)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 939.960 Q 192.900 939.960 145.920 939.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='939.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-0 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle style='fill: blue;' cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(cat client-0 request2-1 (enc cookie (hash syskey-0 (ltk client-0 proxy-0))))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g><title>(cat request2-1 cookie)</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>request-1</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(cat client-0 request-1)</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 1014.960 Q 92.940 1014.960 45.960 1014.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat client request2-0 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='139.920' cy='1014.960' r='6.000'/></g>
  <g><title>(cat request2-0 cookie)</title>
   <circle style='fill: gray;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g><title>request-0</title>
   <circle style='fill: gray;' cx='139.920' cy='864.960' r='6.000'/></g>
  <g><title>(cat client request-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(cat client answer2)</title>
   <circle style='fill: blue;' cx='39.960' cy='1164.960' r='6.000'/></g>
  <g>
   <title>(cat client request2 (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle cx='39.960' cy='1089.960' r='6.000'/></g>
  <g>
   <title>(cat client answer (enc cookie (hash syskey (ltk client proxy))))</title>
   <circle style='fill: blue;' cx='39.960' cy='1014.960' r='6.000'/></g>
  <g><title>(cat client request)</title>
   <circle cx='39.960' cy='939.960' r='6.000'/></g>
  <g><title>((request request-4) (client client-3))</title>
   <text
    x='839.640' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-4) (answer answer-2) (cookie cookie-0))</title>
   <text
    x='739.680' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-3) (request2 request2-2) (answer answer-2) (cookie cookie-0) (syskey syskey-2) (client client-2) (proxy proxy-2))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-2) (request2 request2-2) (answer answer-1) (answer2 answer2-0) (cookie cookie-0))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request answer2-0) (answer answer-0) (cookie cookie))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((request request-2) (request2 request2-1) (answer answer-0) (cookie cookie) (syskey syskey-1) (client client-1) (proxy proxy-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-1) (request2 request2-0) (answer request2-1) (cookie cookie) (syskey syskey-0) (client client-0) (proxy proxy-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request-0) (answer request2-0) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>proxy</text></g>
  <g>
   <title>((request request) (request2 request2) (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey) (client client) (proxy proxy))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>sbp 715 (realized)</text></svg></div>

<pre>(defskeleton sbp
  (vars
    (syskey request request2 answer answer2 request-0 request-1
      request2-0 syskey-0 request-2 request2-1 syskey-1 answer-0 cookie
      answer-1 answer2-0 request-3 request2-2 syskey-2 answer-2 cookie-0
      request-4 data)
    (client proxy client-0 proxy-0 client-1 proxy-1 client-2 proxy-2
      client-3 name))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (client client) (proxy proxy))
  (defstrand proxy 4 (request request-0) (answer request2-0)
    (cookie cookie) (syskey syskey) (client client) (proxy proxy))
  (defstrand proxy 6 (request request-1) (request2 request2-0)
    (answer request2-1) (cookie cookie) (syskey syskey-0)
    (client client-0) (proxy proxy-0))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (client client-1) (proxy proxy-1))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-2) (request2 request2-2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 6 (request request-3) (request2 request2-2)
    (answer answer-2) (cookie cookie-0) (syskey syskey-2)
    (client client-2) (proxy proxy-2))
  (defstrand server 1 (request request-4) (answer answer-2)
    (cookie cookie-0))
  (defstrand proxy 2 (request request-4) (client client-3))
  (precedes ((1 3) (0 1)) ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)) ((6 5) (5 1)) ((7 0) (6 2))
    ((8 1) (7 0)))
  (leadsto ((2 5) (1 2)) ((3 1) (5 0)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)) ((6 5) (5 1)) ((7 0) (6 2)) ((8 1) (7 0)))
  (non-orig syskey)
  (operation state-passing-test (added-strand proxy 2) request-4 (7 0))
  (label 715)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie)
        (client client) (proxy proxy))))
  (origs))</pre>

</body>
</html>
