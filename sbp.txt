(herald "Session Binding Protocol (SBP)")

(comment "CPSA 3.6.6")
(comment "All input read from sbp.lsp")

(defprotocol sbp basic
  (defrole client
    (vars (answer cookie sskey login_info data))
    (trace (send login_info) (recv (enc cookie sskey))
      (send (cat "request" (enc cookie sskey))) (recv answer)))
  (defrole proxy
    (vars (answer cookie sskey login_info data))
    (trace (recv login_info) (send (enc cookie sskey))
      (recv (cat "request" (enc cookie sskey))) (send answer))
    (uniq-gen answer)))

(defskeleton sbp
  (vars (answer cookie sskey login_info data))
  (defstrand client 4 (answer answer) (cookie cookie) (sskey sskey)
    (login_info login_info))
  (traces
    ((send login_info) (recv (enc cookie sskey))
      (send (cat "request" (enc cookie sskey))) (recv answer)))
  (label 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((answer answer) (cookie cookie) (sskey sskey)
        (login_info login_info))))
  (origs))

(comment "Nothing left to do")
