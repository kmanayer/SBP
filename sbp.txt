(herald "Session Binding Protocol (SBP)")

(comment "CPSA 3.6.6")
(comment "All input read from sbp.lsp")

(defprotocol sbp basic
  (defrole client
    (vars (challenge id secret request iv answer cookie syskey data)
      (proxy ca name))
    (trace (send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (defrole proxy
    (vars (challenge id secret request iv answer cookie syskey data)
      (proxy ca name))
    (trace (obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer cookie))
      (send
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (defrole certauth
    (vars (proxy ca name))
    (trace (init (enc proxy (pubk proxy) (privk ca)))))
  (defrole server
    (vars (request answer cookie data))
    (trace (tran request (cat answer cookie)))))

(defskeleton sbp
  (vars (challenge secret id syskey request iv answer cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 0)
  (unrealized (0 1) (0 4) (0 6))
  (origs (challenge (0 0)) (secret (0 2)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (precedes ((1 2) (0 1)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-strand proxy 3)
    (enc proxy (pubk proxy) (privk ca)) (0 1))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))))
  (label 1)
  (parent 0)
  (unrealized (0 4) (0 6) (1 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (precedes ((1 2) (0 1)) ((2 0) (1 0)))
  (leadsto ((2 0) (1 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy (pubk proxy) (privk ca)) (1 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca)))))
  (label 2)
  (parent 1)
  (unrealized (0 4) (0 6))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars (secret id syskey request iv answer cookie challenge id-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (precedes ((1 2) (0 1)) ((2 0) (1 0)))
  (leadsto ((2 0) (1 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation encryption-test (displaced 3 0 client 4)
    (enc id (hash secret id id)) (0 4))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca)))))
  (label 3)
  (parent 2)
  (unrealized (0 6))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars (challenge secret id syskey request iv answer cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 1 3 proxy 6)
    (enc challenge (hash secret challenge id)) (0 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id)))))
  (label 4)
  (parent 2)
  (unrealized (0 6) (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)))
  (leadsto ((2 0) (1 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-strand proxy 6)
    (enc challenge (hash secret challenge id)) (0 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id)))))
  (label 5)
  (parent 2)
  (unrealized (0 6) (3 0) (3 3) (3 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (precedes ((1 2) (0 1)) ((2 0) (1 0)) ((3 1) (0 4)))
  (leadsto ((2 0) (1 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (hash secret challenge id))
    (enc challenge (hash secret challenge id)) (0 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id))))
  (label 6)
  (parent 2)
  (unrealized (0 6) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 9) (0 6)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation encryption-test (displaced 1 3 proxy 10)
    (enc cookie (hash syskey (hash secret id id))) (0 6))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id)))))))
  (label 7)
  (parent 3)
  (unrealized (2 4) (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)))
  (leadsto ((2 0) (1 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation encryption-test (added-strand proxy 10)
    (enc cookie (hash syskey (hash secret id id))) (0 6))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id)))))))
  (label 8)
  (parent 3)
  (unrealized (3 0) (3 3) (3 4) (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars (secret id syskey request iv answer cookie challenge id-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash syskey (hash secret id id)))
  (precedes ((1 2) (0 1)) ((2 0) (1 0)) ((3 1) (0 6)))
  (leadsto ((2 0) (1 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation encryption-test
    (added-listener (hash syskey (hash secret id id)))
    (enc cookie (hash syskey (hash secret id id))) (0 6))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash syskey (hash secret id id)))
      (send (hash syskey (hash secret id id)))))
  (label 9)
  (parent 3)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars (challenge secret id syskey request iv answer cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 5) (0 4)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 3 0 client 4)
    (enc id (hash secret challenge id)) (2 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id)))))
  (label 10)
  (parent 4)
  (unrealized (0 6))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars (challenge secret id syskey request iv answer cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 1) (2 4)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (hash secret challenge id))
    (enc id (hash secret challenge id)) (2 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id))))
  (label 11)
  (parent 4)
  (unrealized (0 6) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 4 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id)))))
  (label 12)
  (parent 5)
  (unrealized (0 6) (3 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 13)
  (parent 5)
  (unrealized (0 6) (3 3) (3 4))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (precedes ((0 2) (4 0)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 1) (0 4))
    ((4 1) (3 0)))
  (leadsto ((2 0) (1 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (cat secret challenge id))
    (hash secret challenge id) (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id))))
  (label 14)
  (parent 6)
  (unrealized (0 6) (4 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation encryption-test (displaced 3 0 client 4)
    (enc id (hash secret id id)) (2 4))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id)))))))
  (label 15)
  (parent 7)
  (unrealized (2 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation encryption-test (added-listener (hash secret id id))
    (enc id (hash secret id id)) (2 4))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id))))
  (label 16)
  (parent 7)
  (unrealized (2 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 9) (0 6)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 4 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (3 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id)))))))
  (label 17)
  (parent 8)
  (unrealized (3 4) (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (3 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 18)
  (parent 8)
  (unrealized (3 3) (3 4) (3 8))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((2 9) (0 6)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 2 3 proxy 10)
    (enc cookie (hash syskey (hash secret challenge id))) (0 6))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 19)
  (parent 10)
  (unrealized (2 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-strand proxy 10)
    (enc cookie (hash syskey (hash secret challenge id))) (0 6))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 20)
  (parent 10)
  (unrealized (3 0) (3 3) (3 4) (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars (challenge secret id syskey request iv answer cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash syskey (hash secret challenge id)))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 1) (0 6)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test
    (added-listener (hash syskey (hash secret challenge id)))
    (enc cookie (hash syskey (hash secret challenge id))) (0 6))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash syskey (hash secret challenge id)))
      (send (hash syskey (hash secret challenge id)))))
  (label 21)
  (parent 10)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars (challenge secret id syskey request iv answer cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (4 0)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 1) (2 4)) ((4 1) (3 0)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (cat secret challenge id))
    (hash secret challenge id) (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id))))
  (label 22)
  (parent 11)
  (unrealized (0 6) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 5) (0 4)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 4 0 client 4)
    (enc id (hash secret challenge id)) (3 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id)))))
  (label 23)
  (parent 12)
  (unrealized (0 6))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 1) (3 4)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (hash secret challenge id))
    (enc id (hash secret challenge id)) (3 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id))))
  (label 24)
  (parent 12)
  (unrealized (0 6) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (contracted (proxy-0 proxy)) secret (3 3)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0)))))
  (label 25)
  (parent 13)
  (unrealized (0 6) (3 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 secret-0 request-0 iv-0 answer-0 syskey-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (4 8)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (2 3)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 5 proxy 10) secret (3 3)
    (enc secret (pubk proxy-1)))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 26)
  (parent 13)
  (unrealized (0 6) (4 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 answer-0 syskey-0
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (3 3)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (3 3)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 27)
  (parent 13)
  (unrealized (0 6) (5 0) (5 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 secret-0 request-0 iv-0 cookie-0 syskey-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (4 8)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (2 3)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 5 proxy 10) secret (3 3)
    (enc secret (pubk proxy-1)))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 28)
  (parent 13)
  (unrealized (0 6) (4 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 cookie-0 syskey-0
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (3 3)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (3 3)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 29)
  (parent 13)
  (unrealized (0 6) (5 0) (5 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 secret-0 request-0 iv-0 answer-0 syskey-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 2) (4 8)) ((1 0) (4 0)) ((2 1) (0 4)) ((3 1) (2 0))
    ((4 2) (0 1)) ((4 9) (3 0)))
  (leadsto ((1 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 5 proxy 10) secret (4 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 30)
  (parent 14)
  (unrealized (0 6) (4 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 answer-0 syskey-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 1) (0 4))
    ((4 1) (3 0)) ((5 9) (4 0)))
  (leadsto ((2 0) (1 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (4 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 31)
  (parent 14)
  (unrealized (0 6) (5 0) (5 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 secret-0 request-0 iv-0 cookie-0 syskey-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 2) (4 8)) ((1 0) (4 0)) ((2 1) (0 4)) ((3 1) (2 0))
    ((4 2) (0 1)) ((4 9) (3 0)))
  (leadsto ((1 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 5 proxy 10) secret (4 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 32)
  (parent 14)
  (unrealized (0 6) (4 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 cookie-0 syskey-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 1) (0 4))
    ((4 1) (3 0)) ((5 9) (4 0)))
  (leadsto ((2 0) (1 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (4 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 33)
  (parent 14)
  (unrealized (0 6) (5 0) (5 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer request-0 iv-0 request-1
      answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((3 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (2 8))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 34)
  (parent 15)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (4 0)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation encryption-test (added-listener (cat secret id id))
    (hash secret id id) (3 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id))))
  (label 35)
  (parent 16)
  (unrealized (2 8) (4 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation encryption-test (displaced 4 0 client 4)
    (enc id (hash secret id id)) (3 4))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id)))))))
  (label 36)
  (parent 17)
  (unrealized (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 9) (0 6)) ((4 1) (3 4)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation encryption-test (added-listener (hash secret id id))
    (enc id (hash secret id id)) (3 4))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id))))
  (label 37)
  (parent 17)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation nonce-test (contracted (proxy-0 proxy)) secret (3 3)
    (enc secret (pubk proxy)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0)))))
  (label 38)
  (parent 18)
  (unrealized (3 4) (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer cookie challenge id-0 request-0 iv-0
      answer-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 5) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation nonce-test (displaced 5 0 client 6) secret (3 3)
    (enc secret (pubk proxy)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 39)
  (parent 18)
  (unrealized (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      challenge id-0 secret-0 request-1 iv-1 answer-1 syskey-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (4 8)) ((1 0) (4 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (2 3)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig secret id)
  (operation nonce-test (displaced 1 5 proxy 10) secret (3 3)
    (enc secret (pubk proxy-1)))
  (traces
    ((send id)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge id-0)))))))
  (label 40)
  (parent 18)
  (unrealized (2 8) (4 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 9) (3 3)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation nonce-test (added-strand proxy 10) secret (3 3)
    (enc secret (pubk proxy)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 41)
  (parent 18)
  (unrealized (3 8) (5 0) (5 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      challenge id-0 secret-0 request-1 iv-1 cookie-0 syskey-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (4 8)) ((1 0) (4 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (2 3)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig secret id)
  (operation nonce-test (displaced 1 5 proxy 10) secret (3 3)
    (enc secret (pubk proxy-1)))
  (traces
    ((send id)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge id-0)))))))
  (label 42)
  (parent 18)
  (unrealized (2 8) (4 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 9) (3 3)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation nonce-test (added-strand proxy 10) secret (3 3)
    (enc secret (pubk proxy)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 43)
  (parent 18)
  (unrealized (3 8) (5 0) (5 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      request-1 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((2 9) (0 6)) ((3 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((3 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 44)
  (parent 19)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 4 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 45)
  (parent 20)
  (unrealized (3 4) (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 46)
  (parent 20)
  (unrealized (3 3) (3 4) (3 8))
  (comment "7 in cohort - 7 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 secret-0 request-0 iv-0 answer-0 syskey-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (4 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 47)
  (parent 22)
  (unrealized (0 6) (5 0) (5 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 secret-0 request-0 iv-0 cookie-0 syskey-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (4 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 48)
  (parent 22)
  (unrealized (0 6) (5 0) (5 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0)) ((2 5) (0 4))
    ((3 2) (0 1)) ((3 9) (0 6)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 1 4 proxy 10)
    (enc cookie (hash syskey (hash secret challenge id))) (0 6))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 49)
  (parent 23)
  (unrealized (3 4) (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 5) (0 4)) ((3 9) (0 6)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 3 4 proxy 10)
    (enc cookie (hash syskey (hash secret challenge id))) (0 6))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 50)
  (parent 23)
  (unrealized (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-strand proxy 10)
    (enc cookie (hash syskey (hash secret challenge id))) (0 6))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 51)
  (parent 23)
  (unrealized (4 0) (4 3) (4 4) (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash syskey (hash secret challenge id)))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 5) (0 4)) ((4 1) (0 6)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test
    (added-listener (hash syskey (hash secret challenge id)))
    (enc cookie (hash syskey (hash secret challenge id))) (0 6))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash syskey (hash secret challenge id)))
      (send (hash syskey (hash secret challenge id)))))
  (label 52)
  (parent 23)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (5 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 5) (0 4)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (cat secret challenge id))
    (hash secret challenge id) (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id))))
  (label 53)
  (parent 24)
  (unrealized (0 6) (5 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 5) (0 4)) ((4 0) (3 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 5 0 client 4)
    (enc id (hash secret challenge id)) (3 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0)))))
  (label 54)
  (parent 25)
  (unrealized (0 6))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 1) (3 4)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (hash secret challenge id))
    (enc id (hash secret challenge id)) (3 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id))))
  (label 55)
  (parent 25)
  (unrealized (0 6) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 answer-0 syskey-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (3 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 56)
  (parent 27)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 answer-0 syskey-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (3 3)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 57)
  (parent 27)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 answer-0 syskey-0
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (3 3)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 58)
  (parent 27)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 cookie-0 syskey-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (3 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 59)
  (parent 29)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 cookie-0 syskey-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (3 3)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 60)
  (parent 29)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 cookie-0 syskey-0
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (3 3)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 61)
  (parent 29)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 answer-0 syskey-0
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0))
    ((3 1) (0 4)) ((4 1) (3 0)) ((5 9) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 62)
  (parent 31)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 answer-0 syskey-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 1) (0 4))
    ((4 1) (3 0)) ((5 9) (4 0)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 63)
  (parent 31)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 cookie-0 syskey-0
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0))
    ((3 1) (0 4)) ((4 1) (3 0)) ((5 9) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 64)
  (parent 33)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 cookie-0 syskey-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 1) (0 4))
    ((4 1) (3 0)) ((5 9) (4 0)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 65)
  (parent 33)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer request-0 iv-0 answer-0 cookie
      data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 7) (3 0)) ((2 9) (0 6)) ((3 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((2 7) (3 0)) ((3 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 4 2 proxy 8) request-1 (3 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 66)
  (parent 34)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret-0 request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8)) ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand proxy 8) request-1 (3 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1)))
  (label 67)
  (parent 34)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer cookie request-0 iv-0 answer-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (4 0)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation nonce-test (displaced 5 0 client 6) secret (4 0)
    (enc secret (pubk proxy)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id))))
  (label 68)
  (parent 35)
  (unrealized (2 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      challenge id-0 secret-0 request-1 iv-1 answer-1 syskey-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation nonce-test (added-strand proxy 10) secret (4 0)
    (enc secret (pubk proxy)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge id-0)))))))
  (label 69)
  (parent 35)
  (unrealized (2 8) (5 0) (5 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      challenge id-0 secret-0 request-1 iv-1 cookie-0 syskey-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation nonce-test (added-strand proxy 10) secret (4 0)
    (enc secret (pubk proxy)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge id-0)))))))
  (label 70)
  (parent 35)
  (unrealized (2 8) (5 0) (5 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      request-1 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)) ((4 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (3 8))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 71)
  (parent 36)
  (unrealized (4 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (5 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation encryption-test (added-listener (cat secret id id))
    (hash secret id id) (4 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id))))
  (label 72)
  (parent 37)
  (unrealized (3 8) (5 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation encryption-test (displaced 5 0 client 4)
    (enc id (hash secret id id)) (3 4))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0)))))
  (label 73)
  (parent 38)
  (unrealized (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret id id))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation encryption-test (added-listener (hash secret id id))
    (enc id (hash secret id id)) (3 4))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret id id)) (send (hash secret id id))))
  (label 74)
  (parent 38)
  (unrealized (3 8) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 request-1
      answer-0 cookie data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 5) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (3 8))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 75)
  (parent 39)
  (unrealized (5 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 9) (3 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 6 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 76)
  (parent 41)
  (unrealized (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (3 3)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 6 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 77)
  (parent 41)
  (unrealized (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 9) (3 3)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-1))))))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 78)
  (parent 41)
  (unrealized (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 9) (3 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 6 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 79)
  (parent 43)
  (unrealized (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (3 3)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 6 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 80)
  (parent 43)
  (unrealized (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (5 8)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 9) (3 3)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-1))))))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 81)
  (parent 43)
  (unrealized (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((2 7) (3 0)) ((2 9) (0 6))
    ((3 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((2 7) (3 0)) ((3 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 4 2 proxy 8) request-1 (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 82)
  (parent 44)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((2 9) (0 6)) ((3 0) (2 8))
    ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-1 (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 83)
  (parent 44)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 4 0 client 4)
    (enc id (hash secret challenge id)) (3 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 84)
  (parent 45)
  (unrealized (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 1) (3 4)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (hash secret challenge id))
    (enc id (hash secret challenge id)) (3 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id))))
  (label 85)
  (parent 45)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (contracted (proxy-0 proxy)) secret (3 3)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0)))))
  (label 86)
  (parent 46)
  (unrealized (3 4) (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 3) (2 4))
    ((0 5) (3 3)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation nonce-test (displaced 5 0 client 6) secret (3 3)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 87)
  (parent 46)
  (unrealized (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 iv-1 answer-1 syskey-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 9) (2 3)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 2 5 proxy 10) secret-0 (3 3)
    (enc secret-0 (pubk proxy-1)))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret (hash syskey-0 (hash secret challenge id)))))))
  (label 88)
  (parent 46)
  (unrealized (2 3) (2 8) (4 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (5 8))
    ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 9) (3 3)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (3 3)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 89)
  (parent 46)
  (unrealized (3 8) (5 0) (5 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 iv-1 cookie-0 syskey-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 9) (2 3)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 2 5 proxy 10) secret-0 (3 3)
    (enc secret-0 (pubk proxy-1)))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0 (hash syskey-0 (hash secret challenge id)))))))
  (label 90)
  (parent 46)
  (unrealized (2 8) (4 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (5 8))
    ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 9) (3 3)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (3 3)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 91)
  (parent 46)
  (unrealized (3 8) (5 0) (5 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 answer-1 cookie-0 syskey-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 9) (2 3)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 2 5 proxy 10) secret-0 (3 3)
    (enc secret-0 (pubk proxy-1)))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id)))))))
  (label 92)
  (parent 46)
  (unrealized (2 8) (4 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 secret-0 request-0 iv-0 answer-0 syskey-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((1 0) (5 0)) ((2 2) (0 1)) ((2 5) (0 4)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 93)
  (parent 47)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 secret-0 request-0 iv-0 answer-0 syskey-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 9) (4 0)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 94)
  (parent 47)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 secret-0 request-0 iv-0 cookie-0 syskey-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((1 0) (5 0)) ((2 2) (0 1)) ((2 5) (0 4)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 95)
  (parent 48)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 secret-0 request-0 iv-0 cookie-0 syskey-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 9) (4 0)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 96)
  (parent 48)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 4 0 client 4)
    (enc id (hash secret challenge id)) (3 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 97)
  (parent 49)
  (unrealized (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0)) ((2 5) (0 4))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (hash secret challenge id))
    (enc id (hash secret challenge id)) (3 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id))))
  (label 98)
  (parent 49)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 request-1 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 5) (0 4)) ((3 9) (0 6))
    ((4 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 99)
  (parent 50)
  (unrealized (4 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 5 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 100)
  (parent 51)
  (unrealized (4 4) (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 101)
  (parent 51)
  (unrealized (4 3) (4 4) (4 8))
  (comment "9 in cohort - 9 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 secret-0 request-0 iv-0 answer-0 syskey-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((1 0) (5 0)) ((2 5) (0 4)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 2) (0 1)) ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 6 proxy 10) secret (5 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 102)
  (parent 53)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 answer-0 syskey-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (6 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 5) (0 4)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (5 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 103)
  (parent 53)
  (unrealized (0 6) (6 0) (6 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 secret-0 request-0 iv-0 cookie-0 syskey-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((1 0) (5 0)) ((2 5) (0 4)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 2) (0 1)) ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 6 proxy 10) secret (5 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 104)
  (parent 53)
  (unrealized (0 6) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 cookie-0 syskey-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (6 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 5) (0 4)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (5 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 105)
  (parent 53)
  (unrealized (0 6) (6 0) (6 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((1 0) (4 0)) ((2 5) (0 4)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 9) (0 6)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 1 5 proxy 10)
    (enc cookie (hash syskey (hash secret challenge id))) (0 6))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 106)
  (parent 54)
  (unrealized (4 4) (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 0) (4 0)) ((4 5) (0 4)) ((4 9) (0 6)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 3 5 proxy 10)
    (enc cookie (hash syskey (hash secret challenge id))) (0 6))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 107)
  (parent 54)
  (unrealized (4 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-strand proxy 10)
    (enc cookie (hash syskey (hash secret challenge id))) (0 6))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 108)
  (parent 54)
  (unrealized (5 0) (5 3) (5 4) (5 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash syskey (hash secret challenge id)))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 1) (0 6)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test
    (added-listener (hash syskey (hash secret challenge id)))
    (enc cookie (hash syskey (hash secret challenge id))) (0 6))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash syskey (hash secret challenge id)))
      (send (hash syskey (hash secret challenge id)))))
  (label 109)
  (parent 54)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (6 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (cat secret challenge id))
    (hash secret challenge id) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id))))
  (label 110)
  (parent 55)
  (unrealized (0 6) (6 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret-0 request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((1 0) (4 0)) ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8))
    ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 5 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (4 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1)))
  (label 111)
  (parent 67)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret-0 request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8)) ((4 7) (3 0))
    ((5 0) (4 0)))
  (leadsto ((1 0) (2 0)) ((3 0) (2 8)) ((4 7) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (4 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 112)
  (parent 67)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 request-1 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (4 0)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((5 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (2 8))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie))))
  (label 113)
  (parent 68)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      challenge id-0 secret-0 request-1 iv-1 answer-1 syskey-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((1 0) (5 0)) ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 6 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge id-0)))))))
  (label 114)
  (parent 69)
  (unrealized (2 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      challenge id-0 secret-0 request-1 iv-1 answer-1 syskey-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 9) (4 0)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret (hash syskey-0 (hash secret-0 challenge id-0))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 115)
  (parent 69)
  (unrealized (2 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      challenge id-0 secret-0 request-1 iv-1 cookie-0 syskey-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((1 0) (5 0)) ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 6 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge id-0)))))))
  (label 116)
  (parent 70)
  (unrealized (2 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      challenge id-0 secret-0 request-1 iv-1 cookie-0 syskey-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 9) (4 0)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge id-0))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 117)
  (parent 70)
  (unrealized (2 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret-0 request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 8)) ((4 2) (0 1))
    ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 1 5 proxy 8) request-1 (4 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1)))
  (label 118)
  (parent 71)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (4 0)) ((3 9) (0 6))
    ((4 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 5 3 proxy 8) request-1 (4 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 119)
  (parent 71)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie challenge-0 id-1 secret-0 request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand proxy 8) request-1 (4 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 120)
  (parent 71)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer cookie challenge id-0 request-0 iv-0
      answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (5 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation nonce-test (displaced 6 0 client 6) secret (5 0)
    (enc secret (pubk proxy)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id))))
  (label 121)
  (parent 72)
  (unrealized (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      challenge id-0 secret-0 request-1 iv-1 answer-1 syskey-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((1 0) (5 0)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 2) (0 1)) ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation nonce-test (displaced 1 6 proxy 10) secret (5 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge id-0)))))))
  (label 122)
  (parent 72)
  (unrealized (2 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (6 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation nonce-test (added-strand proxy 10) secret (5 0)
    (enc secret (pubk proxy)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 123)
  (parent 72)
  (unrealized (3 8) (6 0) (6 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      challenge id-0 secret-0 request-1 iv-1 cookie-0 syskey-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (5 8)) ((1 0) (2 0))
    ((1 0) (5 0)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 2) (0 1)) ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation nonce-test (displaced 1 6 proxy 10) secret (5 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge id-0)))))))
  (label 124)
  (parent 72)
  (unrealized (2 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (6 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation nonce-test (added-strand proxy 10) secret (5 0)
    (enc secret (pubk proxy)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 125)
  (parent 72)
  (unrealized (3 8) (6 0) (6 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      request-1 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (3 8))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 126)
  (parent 73)
  (unrealized (5 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (6 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation encryption-test (added-listener (cat secret id id))
    (hash secret id id) (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id))))
  (label 127)
  (parent 74)
  (unrealized (3 8) (6 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 5) (2 3)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 0) (2 8)) ((5 2) (0 1)) ((5 7) (4 0)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig id request)
  (operation state-passing-test (displaced 1 6 proxy 8) request-1 (5 0))
  (traces
    ((send id)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc request (pubk proxy-0)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 128)
  (parent 75)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 5) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 7) (5 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((3 7) (5 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (displaced 6 3 proxy 8) request-1 (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 129)
  (parent 75)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 5) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (added-strand proxy 8) request-1 (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret (pubk proxy-1)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 130)
  (parent 75)
  (unrealized (6 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((1 0) (4 0)) ((2 2) (0 1)) ((2 5) (0 4)) ((2 9) (0 6))
    ((3 0) (2 8)) ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 5 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 131)
  (parent 83)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((2 9) (0 6)) ((3 0) (2 8))
    ((4 7) (3 0)) ((5 0) (4 0)))
  (leadsto ((1 0) (2 0)) ((3 0) (2 8)) ((4 7) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 132)
  (parent 83)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      request-1 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 133)
  (parent 84)
  (unrealized (4 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (5 0)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (cat secret challenge id))
    (hash secret challenge id) (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id))))
  (label 134)
  (parent 85)
  (unrealized (3 8) (5 0))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 5 0 client 4)
    (enc id (hash secret challenge id)) (3 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0)))))
  (label 135)
  (parent 86)
  (unrealized (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (hash secret challenge id))
    (enc id (hash secret challenge id)) (3 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id))))
  (label 136)
  (parent 86)
  (unrealized (3 8) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 request-1
      answer-0 cookie data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 3) (2 4))
    ((0 5) (3 3)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 137)
  (parent 87)
  (unrealized (5 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (5 8))
    ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 9) (3 3)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 138)
  (parent 89)
  (unrealized (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (5 8))
    ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (3 3)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((4 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 139)
  (parent 89)
  (unrealized (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (5 8))
    ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 9) (3 3)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0))))))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 140)
  (parent 89)
  (unrealized (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (5 8))
    ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 9) (3 3)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 141)
  (parent 91)
  (unrealized (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (5 8))
    ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (3 3)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((4 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 142)
  (parent 91)
  (unrealized (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (5 8))
    ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 9) (3 3)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0))))))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 143)
  (parent 91)
  (unrealized (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (4 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 144)
  (parent 92)
  (unrealized (2 8) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      request-1 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)) ((4 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 145)
  (parent 97)
  (unrealized (4 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (5 0)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (cat secret challenge id))
    (hash secret challenge id) (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id))))
  (label 146)
  (parent 98)
  (unrealized (3 8) (5 0))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (2 0))
    ((1 0) (4 0)) ((2 5) (0 4)) ((2 9) (0 6)) ((3 0) (2 8))
    ((4 2) (0 1)) ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 5 proxy 8) request-1 (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 147)
  (parent 99)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 5) (0 4)) ((3 7) (4 0))
    ((3 9) (0 6)) ((4 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 5 3 proxy 8) request-1 (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 148)
  (parent 99)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 5) (0 4)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-1 (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 149)
  (parent 99)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 5 0 client 4)
    (enc id (hash secret challenge id)) (4 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 150)
  (parent 100)
  (unrealized (4 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 1) (4 4)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (hash secret challenge id))
    (enc id (hash secret challenge id)) (4 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id))))
  (label 151)
  (parent 100)
  (unrealized (4 8) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (contracted (proxy-0 proxy)) secret (4 3)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0)))))
  (label 152)
  (parent 101)
  (unrealized (4 4) (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer cookie challenge-0 id-0
      request-0 iv-0 answer-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (4 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation nonce-test (displaced 6 0 client 6) secret (4 3)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 153)
  (parent 101)
  (unrealized (4 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (5 8))
    ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 2) (0 1)) ((5 9) (3 3)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 6 proxy 10) secret (4 3)
    (enc secret (pubk proxy-1)))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 154)
  (parent 101)
  (unrealized (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 iv-1 answer-1 syskey-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 6 proxy 10) secret-0 (4 3)
    (enc secret-0 (pubk proxy-1)))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 155)
  (parent 101)
  (unrealized (3 3) (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (6 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 9) (4 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (4 3)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 156)
  (parent 101)
  (unrealized (4 8) (6 0) (6 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (5 8))
    ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 2) (0 1)) ((5 9) (3 3)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 6 proxy 10) secret (4 3)
    (enc secret (pubk proxy-1)))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 157)
  (parent 101)
  (unrealized (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 iv-1 cookie-0 syskey-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 6 proxy 10) secret-0 (4 3)
    (enc secret-0 (pubk proxy-1)))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 158)
  (parent 101)
  (unrealized (3 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (6 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 9) (4 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (4 3)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 159)
  (parent 101)
  (unrealized (4 8) (6 0) (6 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 answer-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 6 proxy 10) secret-0 (4 3)
    (enc secret-0 (pubk proxy-1)))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 160)
  (parent 101)
  (unrealized (3 8) (5 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 answer-0 syskey-0
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (6 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((3 5) (0 4))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 161)
  (parent 103)
  (unrealized (0 6) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 answer-0 syskey-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (6 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 5) (0 4)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)) ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 162)
  (parent 103)
  (unrealized (0 6) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 cookie-0 syskey-0
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (6 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((3 5) (0 4))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 163)
  (parent 105)
  (unrealized (0 6) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 cookie-0 syskey-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (6 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 5) (0 4)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)) ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 164)
  (parent 105)
  (unrealized (0 6) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 5 0 client 4)
    (enc id (hash secret challenge id)) (4 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 165)
  (parent 106)
  (unrealized (4 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((1 0) (4 0)) ((2 5) (0 4)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 9) (0 6)) ((5 1) (4 4)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (hash secret challenge id))
    (enc id (hash secret challenge id)) (4 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id))))
  (label 166)
  (parent 106)
  (unrealized (4 8) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 request-1 answer-0 cookie data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 0) (4 0)) ((4 5) (0 4)) ((4 9) (0 6))
    ((5 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((5 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (4 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 167)
  (parent 107)
  (unrealized (5 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 168)
  (parent 108)
  (unrealized (5 4) (5 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 169)
  (parent 108)
  (unrealized (5 4) (5 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 170)
  (parent 108)
  (unrealized (5 3) (5 4) (5 8))
  (comment "9 in cohort - 9 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 secret-0 request-0 iv-0 answer-0 syskey-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (6 8)) ((1 0) (6 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0))
    ((6 2) (0 1)) ((6 9) (5 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 7 proxy 10) secret (6 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 171)
  (parent 110)
  (unrealized (0 6) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 answer-0 syskey-0
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (6 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 172)
  (parent 110)
  (unrealized (0 6) (7 0) (7 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 secret-0 request-0 iv-0 cookie-0 syskey-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (6 8)) ((1 0) (6 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0))
    ((6 2) (0 1)) ((6 9) (5 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 7 proxy 10) secret (6 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 173)
  (parent 110)
  (unrealized (0 6) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 cookie-0 syskey-0
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (6 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 174)
  (parent 110)
  (unrealized (0 6) (7 0) (7 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (4 0)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 7) (5 0)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((2 7) (5 0)) ((5 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (displaced 6 2 proxy 8) request-1 (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 175)
  (parent 113)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (4 0)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 0) (2 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((5 0) (2 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (added-strand proxy 8) request-1 (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 176)
  (parent 113)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie challenge-0 id-1 secret-0 request-1 data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 6 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 177)
  (parent 120)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie challenge-0 id-1 secret-0 request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0))
    ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 178)
  (parent 120)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 request-1
      answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (5 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((6 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (3 8))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie))))
  (label 179)
  (parent 121)
  (unrealized (6 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (6 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 7 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 180)
  (parent 123)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (6 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)) ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 181)
  (parent 123)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (6 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 7 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 182)
  (parent 125)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (6 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)) ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 183)
  (parent 125)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret-0 request-1 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((1 0) (5 0))
    ((2 9) (0 6)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 2) (0 1))
    ((5 7) (4 0)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 1 6 proxy 8) request-1 (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1)))
  (label 184)
  (parent 126)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 7) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((3 7) (5 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 6 3 proxy 8) request-1 (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 185)
  (parent 126)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie challenge-0 id-1 secret-0 request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand proxy 8) request-1 (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 186)
  (parent 126)
  (unrealized (6 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer cookie challenge id-0 request-0 iv-0
      answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (6 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation nonce-test (displaced 7 0 client 6) secret (6 0)
    (enc secret (pubk proxy)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id))))
  (label 187)
  (parent 127)
  (unrealized (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      challenge id-0 secret-0 request-1 iv-1 answer-1 syskey-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (6 8)) ((1 0) (6 0))
    ((2 9) (0 6)) ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0))
    ((6 2) (0 1)) ((6 9) (5 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig secret id)
  (operation nonce-test (displaced 1 7 proxy 10) secret (6 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge id-0)))))))
  (label 188)
  (parent 127)
  (unrealized (2 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation nonce-test (added-strand proxy 10) secret (6 0)
    (enc secret (pubk proxy)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 189)
  (parent 127)
  (unrealized (3 8) (7 0) (7 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie request-0 iv-0 answer-0
      challenge id-0 secret-0 request-1 iv-1 cookie-0 syskey-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge) (id id-0) (secret secret-0)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 2) (6 8)) ((1 0) (6 0))
    ((2 9) (0 6)) ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0))
    ((6 2) (0 1)) ((6 9) (5 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig secret id)
  (operation nonce-test (displaced 1 7 proxy 10) secret (6 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge id-0)))
      (send (enc challenge (hash secret-0 challenge id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge id-0)))))))
  (label 190)
  (parent 127)
  (unrealized (2 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation nonce-test (added-strand proxy 10) secret (6 0)
    (enc secret (pubk proxy)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 191)
  (parent 127)
  (unrealized (3 8) (7 0) (7 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 5) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (displaced 7 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 192)
  (parent 130)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 5) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (displaced 7 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 193)
  (parent 130)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 5) (3 3)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv id)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret (pubk proxy-1)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 194)
  (parent 130)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 answer-0 cookie challenge
      id secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0))
    ((2 9) (0 6)) ((3 0) (2 8)) ((4 2) (0 1)) ((4 5) (0 4))
    ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 2 5 proxy 8) request-1 (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1)))
  (label 195)
  (parent 133)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 7) (4 0)) ((3 9) (0 6))
    ((4 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 5 3 proxy 8) request-1 (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 196)
  (parent 133)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-1 (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 197)
  (parent 133)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation nonce-test (displaced 6 0 client 6) secret (5 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id))))
  (label 198)
  (parent 134)
  (unrealized (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 iv-1 answer-1 syskey-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 2 6 proxy 10) secret-0 (5 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret (hash syskey-0 (hash secret challenge id)))))))
  (label 199)
  (parent 134)
  (unrealized (2 8) (4 0) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (6 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (5 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 200)
  (parent 134)
  (unrealized (3 8) (6 0) (6 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 iv-1 cookie-0 syskey-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 2 6 proxy 10) secret-0 (5 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0 (hash syskey-0 (hash secret challenge id)))))))
  (label 201)
  (parent 134)
  (unrealized (2 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (6 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (5 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 202)
  (parent 134)
  (unrealized (3 8) (6 0) (6 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 answer-1 cookie-0 syskey-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 2 6 proxy 10) secret-0 (5 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id)))))))
  (label 203)
  (parent 134)
  (unrealized (2 8) (5 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      request-1 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 204)
  (parent 135)
  (unrealized (5 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (6 0)) ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (cat secret challenge id))
    (hash secret challenge id) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id))))
  (label 205)
  (parent 136)
  (unrealized (3 8) (6 0))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((0 5) (2 3)) ((1 0) (5 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 0) (2 8)) ((5 2) (0 1)) ((5 5) (0 4)) ((5 7) (4 0)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 2 6 proxy 8) request-0 (5 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 206)
  (parent 137)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request secret) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 3) (2 4))
    ((0 5) (3 3)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 7) (5 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((3 7) (5 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 6 3 proxy 8) request-1 (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 207)
  (parent 137)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 3) (2 4))
    ((0 5) (3 3)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand proxy 8) request-1 (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret (pubk proxy-1)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 208)
  (parent 137)
  (unrealized (6 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 3)) ((5 0) (4 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (5 0)) ((5 0) (4 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 4 proxy 8) request-2 (5 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 209)
  (parent 144)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (4 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (5 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 210)
  (parent 144)
  (unrealized (2 8) (6 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 answer-0 cookie challenge
      id secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8)) ((4 5) (0 4))
    ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 2 5 proxy 8) request-1 (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1)))
  (label 211)
  (parent 145)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 7) (4 0)) ((3 9) (0 6))
    ((4 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 5 3 proxy 8) request-1 (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 212)
  (parent 145)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-1 (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 213)
  (parent 145)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation nonce-test (displaced 6 0 client 6) secret (5 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id))))
  (label 214)
  (parent 146)
  (unrealized (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 iv-1 answer-1 syskey-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 2 6 proxy 10) secret-0 (5 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret (hash syskey-0 (hash secret challenge id)))))))
  (label 215)
  (parent 146)
  (unrealized (2 8) (4 0) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (6 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (5 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 216)
  (parent 146)
  (unrealized (3 8) (6 0) (6 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 iv-1 cookie-0 syskey-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 2 6 proxy 10) secret-0 (5 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0 (hash syskey-0 (hash secret challenge id)))))))
  (label 217)
  (parent 146)
  (unrealized (2 8) (5 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (6 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (5 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 218)
  (parent 146)
  (unrealized (3 8) (6 0) (6 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 answer-1 cookie-0 syskey-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 2 6 proxy 10) secret-0 (5 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id)))))))
  (label 219)
  (parent 146)
  (unrealized (2 8) (5 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((3 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 220)
  (parent 149)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 5) (0 4)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0))
    ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 221)
  (parent 149)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 request-1 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((5 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (4 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 222)
  (parent 150)
  (unrealized (5 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (6 0)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (cat secret challenge id))
    (hash secret challenge id) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id))))
  (label 223)
  (parent 151)
  (unrealized (4 8) (6 0))
  (comment "8 in cohort - 8 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 6 0 client 4)
    (enc id (hash secret challenge id)) (4 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0)))))
  (label 224)
  (parent 152)
  (unrealized (4 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 1) (4 4)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (hash secret challenge id))
    (enc id (hash secret challenge id)) (4 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id))))
  (label 225)
  (parent 152)
  (unrealized (4 8) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 request-1 answer-0 cookie data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (4 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((6 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (4 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 226)
  (parent 153)
  (unrealized (6 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (6 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 9) (4 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 227)
  (parent 156)
  (unrealized (4 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (6 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)) ((5 0) (6 0))
    ((6 9) (4 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((5 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 5 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 228)
  (parent 156)
  (unrealized (4 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (6 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 9) (4 3))
    ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 229)
  (parent 156)
  (unrealized (4 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (6 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 9) (4 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 230)
  (parent 159)
  (unrealized (4 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (6 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)) ((5 0) (6 0))
    ((6 9) (4 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((5 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 5 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 231)
  (parent 159)
  (unrealized (4 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (6 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 9) (4 3))
    ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 232)
  (parent 159)
  (unrealized (4 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 request-2
      answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (5 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 233)
  (parent 160)
  (unrealized (3 8) (6 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      request-1 answer-0 cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)) ((5 0) (4 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (4 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 234)
  (parent 165)
  (unrealized (5 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 2) (6 0)) ((0 3) (2 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (cat secret challenge id))
    (hash secret challenge id) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id))))
  (label 235)
  (parent 166)
  (unrealized (4 8) (6 0))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 0) (5 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 2) (0 1)) ((5 7) (4 0)))
  (leadsto ((1 0) (5 0)) ((2 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 6 proxy 8) request-1 (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 236)
  (parent 167)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 0) (4 0)) ((4 5) (0 4)) ((4 7) (5 0))
    ((4 9) (0 6)) ((5 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((4 7) (5 0)) ((5 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 4 proxy 8) request-1 (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 237)
  (parent 167)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 0) (4 0)) ((4 5) (0 4)) ((4 9) (0 6))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((5 0) (4 8)) ((6 7) (5 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-1 (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 238)
  (parent 167)
  (unrealized (6 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 6 0 client 4)
    (enc id (hash secret challenge id)) (5 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 239)
  (parent 168)
  (unrealized (5 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 1) (5 4)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (hash secret challenge id))
    (enc id (hash secret challenge id)) (5 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id))))
  (label 240)
  (parent 168)
  (unrealized (5 8) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 6 0 client 4)
    (enc id (hash secret challenge id)) (5 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id)))))))
  (label 241)
  (parent 169)
  (unrealized (5 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6)) ((6 1) (5 4)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (hash secret challenge id))
    (enc id (hash secret challenge id)) (5 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id))))
  (label 242)
  (parent 169)
  (unrealized (5 8) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (contracted (proxy-0 proxy)) secret (5 3)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1)))))
  (label 243)
  (parent 170)
  (unrealized (5 4) (5 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer cookie challenge-0 id-0
      request-0 iv-0 answer-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (5 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation nonce-test (displaced 7 0 client 6) secret (5 3)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 244)
  (parent 170)
  (unrealized (5 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (6 8))
    ((0 3) (2 4)) ((1 0) (6 0)) ((2 5) (0 4)) ((3 0) (2 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 2) (0 1)) ((6 9) (4 3)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 7 proxy 10) secret (5 3)
    (enc secret (pubk proxy-1)))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 245)
  (parent 170)
  (unrealized (4 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 iv-1 answer-1 syskey-0
      data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 7 proxy 10) secret-0 (5 3)
    (enc secret-0 (pubk proxy-1)))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 246)
  (parent 170)
  (unrealized (4 3) (4 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data)
    (proxy ca ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (7 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)) ((7 9) (5 3)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (5 3)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 247)
  (parent 170)
  (unrealized (5 8) (7 0) (7 8))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (6 8))
    ((0 3) (2 4)) ((1 0) (6 0)) ((2 5) (0 4)) ((3 0) (2 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 2) (0 1)) ((6 9) (4 3)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 7 proxy 10) secret (5 3)
    (enc secret (pubk proxy-1)))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 248)
  (parent 170)
  (unrealized (4 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 iv-1 cookie-0 syskey-0
      data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 7 proxy 10) secret-0 (5 3)
    (enc secret-0 (pubk proxy-1)))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 249)
  (parent 170)
  (unrealized (4 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data)
    (proxy ca ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (7 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)) ((7 9) (5 3)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (5 3)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 250)
  (parent 170)
  (unrealized (5 8) (7 0) (7 8))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 answer-1 cookie-0
      syskey-0 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 7 proxy 10) secret-0 (5 3)
    (enc secret-0 (pubk proxy-1)))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 251)
  (parent 170)
  (unrealized (4 8) (6 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 answer-0 syskey-0
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (7 0)) ((3 5) (0 4)) ((4 0) (3 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 252)
  (parent 172)
  (unrealized (0 6) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 answer-0 syskey-0
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (7 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 253)
  (parent 172)
  (unrealized (0 6) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 answer-0 syskey-0
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer answer-0)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 9) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat answer-0 secret))
      (send
        (cat answer-0 iv-0
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 254)
  (parent 172)
  (unrealized (0 6) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 cookie-0 syskey-0
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (7 0)) ((3 5) (0 4)) ((4 0) (3 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 255)
  (parent 174)
  (unrealized (0 6) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 cookie-0 syskey-0
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (7 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 256)
  (parent 174)
  (unrealized (0 6) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 challenge-1 id-1 secret-0 request-0 iv-0 cookie-0 syskey-0
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-0) (iv iv-0) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 9) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-0) (init request-0) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-0
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 257)
  (parent 174)
  (unrealized (0 6) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (3 0)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 7) (4 0)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((2 7) (4 0)) ((4 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (3 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 258)
  (parent 175)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (4 0)) ((1 0) (2 0))
    ((1 0) (6 0)) ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 0) (2 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (6 0)) ((5 0) (2 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (displaced 7 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 259)
  (parent 176)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (4 0)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 0) (2 8)) ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (2 0)) ((5 0) (2 8)) ((6 7) (5 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 260)
  (parent 176)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (4 0)) ((1 0) (2 0))
    ((1 0) (6 0)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 0) (2 8)) ((6 2) (0 1)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (6 0)) ((5 0) (2 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (displaced 1 7 proxy 8) request-1 (6 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 261)
  (parent 179)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (5 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (6 0)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (6 0)) ((6 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (displaced 7 3 proxy 8) request-1 (6 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 262)
  (parent 179)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (5 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 0) (3 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((6 0) (3 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (added-strand proxy 8) request-1 (6 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 263)
  (parent 179)
  (unrealized (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie challenge-0 id-1 secret-0 request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (6 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 7 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 264)
  (parent 186)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie challenge-0 id-1 secret-0 request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (6 0))
    ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 7 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 265)
  (parent 186)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer challenge id-0 request-0 iv-0
      answer-0 cookie challenge-0 id-1 secret-0 request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 266)
  (parent 186)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge id) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (id (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 request-1
      answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (6 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((7 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (3 8))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie))))
  (label 267)
  (parent 187)
  (unrealized (7 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (7 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 268)
  (parent 189)
  (unrealized (3 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (7 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 8 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 269)
  (parent 189)
  (unrealized (3 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 9) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 270)
  (parent 189)
  (unrealized (3 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (7 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 271)
  (parent 191)
  (unrealized (3 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (7 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (displaced 8 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-1)))))))
  (label 272)
  (parent 191)
  (unrealized (3 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (secret id syskey request iv answer cookie challenge id-0 request-0
      iv-0 answer-0 challenge-0 id-1 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret id id))
  (deflistener (cat secret id id))
  (defstrand proxy 10 (challenge challenge-0) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 2) (7 8)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 9) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig secret id)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret id id)))
      (recv (enc id (hash secret id id))) (send request)
      (recv
        (cat answer iv (enc cookie (hash syskey (hash secret id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret id id)))
      (send (enc id (hash secret id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret id id)) (send (hash secret id id)))
    ((recv (cat secret id id)) (send (cat secret id id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-0 id-1)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 273)
  (parent 191)
  (unrealized (3 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (5 0)) ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 274)
  (parent 197)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0))
    ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 275)
  (parent 197)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 request-1
      answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((6 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie))))
  (label 276)
  (parent 198)
  (unrealized (6 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (6 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (6 0)) ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 277)
  (parent 200)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (6 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 278)
  (parent 200)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (6 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (6 0)) ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 279)
  (parent 202)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (6 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 280)
  (parent 202)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 request-2 answer-1 cookie-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (5 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 281)
  (parent 203)
  (unrealized (2 8) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 answer-0 cookie challenge
      id secret request-1 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (2 4)) ((0 3) (5 4)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 0) (2 8)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 7) (4 0)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 2 6 proxy 8) request-1 (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1)))
  (label 282)
  (parent 204)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 7) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((3 7) (5 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 3 proxy 8) request-1 (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 283)
  (parent 204)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-1 (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 284)
  (parent 204)
  (unrealized (6 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation nonce-test (displaced 7 0 client 6) secret (6 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id))))
  (label 285)
  (parent 205)
  (unrealized (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 iv-1 answer-1 syskey-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1)) ((6 5) (0 4))
    ((6 9) (5 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 2 7 proxy 10) secret-0 (6 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret (hash syskey-0 (hash secret challenge id)))))))
  (label 286)
  (parent 205)
  (unrealized (2 8) (5 0) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (6 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 287)
  (parent 205)
  (unrealized (3 8) (7 0) (7 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 iv-1 cookie-0 syskey-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1)) ((6 5) (0 4))
    ((6 9) (5 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 2 7 proxy 10) secret-0 (6 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0 (hash syskey-0 (hash secret challenge id)))))))
  (label 288)
  (parent 205)
  (unrealized (2 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (6 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 289)
  (parent 205)
  (unrealized (3 8) (7 0) (7 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 answer-1 cookie-0 syskey-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1)) ((6 5) (0 4))
    ((6 9) (5 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 2 7 proxy 10) secret-0 (6 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id)))))))
  (label 290)
  (parent 205)
  (unrealized (2 8) (6 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 3) (2 4))
    ((0 5) (3 3)) ((1 0) (2 0)) ((1 0) (6 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 7 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 291)
  (parent 208)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 3) (2 4))
    ((0 5) (3 3)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((4 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 7 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 292)
  (parent 208)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 3) (2 4))
    ((0 5) (3 3)) ((1 0) (2 0)) ((2 2) (0 1)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret (pubk proxy-1)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 293)
  (parent 208)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 3)) ((5 0) (2 8))
    ((5 0) (4 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (5 0)) ((5 0) (2 8))
    ((5 0) (4 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 5 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 294)
  (parent 209)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie request-2 answer-1 cookie-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (5 0)) ((5 0) (4 8))
    ((6 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 295)
  (parent 209)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 296)
  (parent 210)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((3 0) (6 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 3 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 297)
  (parent 210)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 298)
  (parent 210)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (5 0)) ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 299)
  (parent 213)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0))
    ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 300)
  (parent 213)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 request-1
      answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((6 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie))))
  (label 301)
  (parent 214)
  (unrealized (6 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (6 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (6 0)) ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 302)
  (parent 216)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (6 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 303)
  (parent 216)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (6 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (6 0)) ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 9) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 304)
  (parent 218)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (6 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 9) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 305)
  (parent 218)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 request-2 answer-1 cookie-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (5 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 306)
  (parent 219)
  (unrealized (2 8) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (5 0)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 2) (0 1)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 6 proxy 8) request-1 (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 307)
  (parent 222)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 5) (0 4)) ((5 7) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 6 proxy 8) request-1 (5 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 308)
  (parent 222)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 7) (5 0))
    ((4 9) (0 6)) ((5 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((4 7) (5 0))
    ((5 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 4 proxy 8) request-1 (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 309)
  (parent 222)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-1 (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 310)
  (parent 222)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer cookie challenge-0 id-0
      request-0 iv-0 answer-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation nonce-test (displaced 7 0 client 6) secret (6 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id))))
  (label 311)
  (parent 223)
  (unrealized (4 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (6 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (6 0)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 2) (0 1)) ((6 9) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 7 proxy 10) secret (6 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 312)
  (parent 223)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 iv-1 answer-1 syskey-0
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 7 proxy 10) secret-0 (6 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 313)
  (parent 223)
  (unrealized (3 8) (5 0) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (6 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 314)
  (parent 223)
  (unrealized (4 8) (7 0) (7 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (6 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (6 0)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 2) (0 1)) ((6 9) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 7 proxy 10) secret (6 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 315)
  (parent 223)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 iv-1 cookie-0 syskey-0
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 7 proxy 10) secret-0 (6 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 316)
  (parent 223)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (6 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 317)
  (parent 223)
  (unrealized (4 8) (7 0) (7 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 answer-1 cookie-0
      syskey-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 7 proxy 10) secret-0 (6 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 318)
  (parent 223)
  (unrealized (3 8) (6 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 request-1 answer-0 cookie data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((6 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (4 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 319)
  (parent 224)
  (unrealized (6 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (7 0)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 1) (4 4)) ((7 1) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (cat secret challenge id))
    (hash secret challenge id) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id))))
  (label 320)
  (parent 225)
  (unrealized (4 8) (7 0))
  (comment "8 in cohort - 8 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 3) (2 4))
    ((0 5) (3 3)) ((1 0) (2 0)) ((1 0) (6 0)) ((2 5) (0 4))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 2) (0 1))
    ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 1 7 proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc request (pubk proxy-0)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 321)
  (parent 226)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((0 5) (3 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (6 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 5) (0 4))
    ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 7 proxy 8) request-0 (6 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 322)
  (parent 226)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request secret) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (4 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 7) (6 0)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 7) (6 0)) ((5 0) (4 0))
    ((6 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 7 4 proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 323)
  (parent 226)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (4 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret (pubk proxy-1)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 324)
  (parent 226)
  (unrealized (7 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)) ((6 2) (0 1))
    ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 7 proxy 8) request-2 (6 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 325)
  (parent 233)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 7) (6 0)) ((5 9) (3 3))
    ((6 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (6 0))
    ((6 0) (5 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 7 5 proxy 8) request-2 (6 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 326)
  (parent 233)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (6 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 327)
  (parent 233)
  (unrealized (3 8) (7 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 answer-0 cookie challenge
      id secret request-1 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 0) (3 0)) ((2 0) (5 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 0) (3 8)) ((5 5) (0 4))
    ((5 7) (4 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (5 0)) ((4 0) (3 8)) ((5 7) (4 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 2 6 proxy 8) request-1 (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1)))
  (label 328)
  (parent 234)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 7) (5 0)) ((4 9) (0 6))
    ((5 0) (4 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (5 0)) ((5 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 6 4 proxy 8) request-1 (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 329)
  (parent 234)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (4 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-1 (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 330)
  (parent 234)
  (unrealized (6 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer cookie request-0 iv-0
      answer-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation nonce-test (displaced 7 0 client 6) secret (6 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id))))
  (label 331)
  (parent 235)
  (unrealized (4 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 iv-1 answer-1 syskey-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 2 7 proxy 10) secret-0 (6 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret (hash syskey-0 (hash secret challenge id)))))))
  (label 332)
  (parent 235)
  (unrealized (3 8) (5 0) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (6 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 333)
  (parent 235)
  (unrealized (4 8) (7 0) (7 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 iv-1 cookie-0 syskey-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 2 7 proxy 10) secret-0 (6 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0 (hash syskey-0 (hash secret challenge id)))))))
  (label 334)
  (parent 235)
  (unrealized (3 8) (6 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (6 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 335)
  (parent 235)
  (unrealized (4 8) (7 0) (7 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 answer-1 cookie-0 syskey-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 2 7 proxy 10) secret-0 (6 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id)))))))
  (label 336)
  (parent 235)
  (unrealized (3 8) (6 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (6 0)) ((3 0) (4 0)) ((4 5) (0 4))
    ((4 9) (0 6)) ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (6 0)) ((3 0) (4 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 337)
  (parent 238)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (6 0)) ((4 5) (0 4))
    ((4 9) (0 6)) ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 3 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 338)
  (parent 238)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 0) (4 0)) ((4 5) (0 4)) ((4 9) (0 6))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 339)
  (parent 238)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 request-1 answer-0 cookie data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (5 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 340)
  (parent 239)
  (unrealized (6 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (7 0)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (cat secret challenge id))
    (hash secret challenge id) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id))))
  (label 341)
  (parent 240)
  (unrealized (5 8) (7 0))
  (comment "8 in cohort - 8 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 request-1 answer-0 cookie data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6))
    ((6 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (5 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 342)
  (parent 241)
  (unrealized (6 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (7 0)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (cat secret challenge id))
    (hash secret challenge id) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id))))
  (label 343)
  (parent 242)
  (unrealized (5 8) (7 0))
  (comment "8 in cohort - 8 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (displaced 7 0 client 4)
    (enc id (hash secret challenge id)) (5 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1)))))
  (label 344)
  (parent 243)
  (unrealized (5 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash secret challenge id))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)) ((7 1) (5 4)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (hash secret challenge id))
    (enc id (hash secret challenge id)) (5 4))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id))))
  (label 345)
  (parent 243)
  (unrealized (5 8) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 request-1 answer-0 cookie data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (5 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)) ((7 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((7 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (5 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 346)
  (parent 244)
  (unrealized (7 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (7 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 9) (5 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 347)
  (parent 247)
  (unrealized (5 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (7 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((4 0) (7 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 9) (5 3)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (7 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 348)
  (parent 247)
  (unrealized (5 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (7 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)) ((6 0) (7 0))
    ((7 9) (5 3)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((6 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 6 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 349)
  (parent 247)
  (unrealized (5 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data)
    (proxy ca ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (7 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)) ((7 9) (5 3))
    ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-2)))))
  (label 350)
  (parent 247)
  (unrealized (5 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (7 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 9) (5 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 351)
  (parent 250)
  (unrealized (5 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (7 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((4 0) (7 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 9) (5 3)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (7 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 352)
  (parent 250)
  (unrealized (5 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (7 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)) ((6 0) (7 0))
    ((7 9) (5 3)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((6 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 6 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 353)
  (parent 250)
  (unrealized (5 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data)
    (proxy ca ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (7 8))
    ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)) ((7 9) (5 3))
    ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-2)))))
  (label 354)
  (parent 250)
  (unrealized (5 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 request-2
      answer-1 cookie-0 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3)) ((7 0) (6 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((7 0) (6 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (6 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 355)
  (parent 251)
  (unrealized (4 8) (7 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 7) (3 0)) ((2 9) (0 6)) ((3 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((2 7) (3 0)) ((3 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (3 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 356)
  (parent 258)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (3 0)) ((1 0) (2 0))
    ((1 0) (5 0)) ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 0) (2 8)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (3 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 357)
  (parent 259)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (3 0)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 0) (2 8))
    ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (2 8)) ((5 7) (4 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (3 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 358)
  (parent 260)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (3 0)) ((1 0) (2 0))
    ((1 0) (5 0)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 0) (2 8))
    ((5 2) (0 1)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (3 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 359)
  (parent 261)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (4 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (5 0)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (5 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (4 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 360)
  (parent 262)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (5 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (7 0)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 0) (3 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (7 0)) ((6 0) (3 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (7 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 361)
  (parent 263)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (5 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 0) (3 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((6 0) (3 8)) ((7 7) (6 0))
    ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (7 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 362)
  (parent 263)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (5 0)) ((1 0) (7 0))
    ((2 9) (0 6)) ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0))
    ((6 0) (2 8)) ((7 2) (0 1)) ((7 7) (6 0)))
  (leadsto ((1 0) (7 0)) ((3 0) (2 0)) ((6 0) (2 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig id request)
  (operation state-passing-test (displaced 1 8 proxy 8) request-1 (7 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 363)
  (parent 267)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (6 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 7) (7 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((3 7) (7 0)) ((4 0) (3 0)) ((7 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (displaced 8 3 proxy 8) request-1 (7 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 364)
  (parent 267)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (6 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 0) (3 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((7 0) (3 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (added-strand proxy 8) request-1 (7 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 365)
  (parent 267)
  (unrealized (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((0 5) (4 0)) ((1 0) (2 0)) ((1 0) (6 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 0) (2 8))
    ((6 2) (0 1)) ((6 5) (0 4)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (6 0)) ((5 0) (2 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 2 7 proxy 8) request-0 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 366)
  (parent 276)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 7) (6 0)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (6 0)) ((6 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 7 3 proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 367)
  (parent 276)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 0) (3 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((6 0) (3 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 368)
  (parent 276)
  (unrealized (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((5 7) (6 0)) ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 5 proxy 8) request-2 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 369)
  (parent 281)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 370)
  (parent 281)
  (unrealized (2 8) (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (6 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 371)
  (parent 284)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (6 0))
    ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((4 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 372)
  (parent 284)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 373)
  (parent 284)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 request-1
      answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((7 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie))))
  (label 374)
  (parent 285)
  (unrealized (7 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (7 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (7 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 375)
  (parent 287)
  (unrealized (3 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (7 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((4 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 376)
  (parent 287)
  (unrealized (3 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 9) (6 0)) ((8 0) (7 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 377)
  (parent 287)
  (unrealized (3 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (7 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (7 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 378)
  (parent 289)
  (unrealized (3 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (7 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((4 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 379)
  (parent 289)
  (unrealized (3 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 9) (6 0)) ((8 0) (7 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 380)
  (parent 289)
  (unrealized (3 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((7 0) (6 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (6 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 381)
  (parent 290)
  (unrealized (2 8) (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 7) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((2 7) (6 0)) ((3 0) (2 0)) ((4 7) (5 0))
    ((5 0) (4 8)) ((6 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 2 proxy 8) request-2 (6 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 382)
  (parent 295)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 0) (2 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (5 0)) ((5 0) (4 8))
    ((6 0) (2 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (6 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 383)
  (parent 295)
  (unrealized (7 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (2 8))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (2 8))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 5 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 384)
  (parent 296)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 385)
  (parent 296)
  (unrealized (7 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((3 0) (6 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (2 8))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (6 0)) ((5 0) (2 8))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 5 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 386)
  (parent 297)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((3 0) (6 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 387)
  (parent 297)
  (unrealized (7 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (2 8)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (2 8)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 5 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 388)
  (parent 298)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)) ((8 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 389)
  (parent 298)
  (unrealized (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((0 5) (4 0)) ((1 0) (2 0)) ((1 0) (6 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 0) (2 8)) ((6 5) (0 4)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (6 0)) ((5 0) (2 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 2 7 proxy 8) request-0 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 390)
  (parent 301)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 7) (6 0)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (6 0)) ((6 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 7 3 proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 391)
  (parent 301)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 0) (3 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((6 0) (3 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 392)
  (parent 301)
  (unrealized (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((5 7) (6 0)) ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 5 proxy 8) request-2 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 393)
  (parent 306)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 394)
  (parent 306)
  (unrealized (2 8) (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((2 0) (6 0)) ((3 5) (0 4))
    ((4 9) (0 6)) ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((2 0) (6 0))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 395)
  (parent 310)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 396)
  (parent 310)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 request-1 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)) ((7 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((7 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (4 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie))))
  (label 397)
  (parent 311)
  (unrealized (7 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((2 0) (7 0)) ((3 5) (0 4))
    ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((2 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 398)
  (parent 314)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)) ((7 9) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 399)
  (parent 314)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((2 0) (7 0)) ((3 5) (0 4))
    ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((2 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 400)
  (parent 317)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)) ((7 9) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 401)
  (parent 317)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 request-2
      answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((7 0) (6 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (6 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 402)
  (parent 318)
  (unrealized (3 8) (7 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (6 0))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 2) (0 1)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 7 proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 403)
  (parent 319)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (3 4)) ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 5) (0 4)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 7 proxy 8) request-1 (6 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 404)
  (parent 319)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 7) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 7) (6 0)) ((5 0) (4 0))
    ((6 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 4 proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 405)
  (parent 319)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 0) (4 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 406)
  (parent 319)
  (unrealized (7 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer cookie challenge-0 id-0
      request-0 iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 1) (4 4)) ((7 1) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation nonce-test (displaced 8 0 client 6) secret (7 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id))))
  (label 407)
  (parent 320)
  (unrealized (4 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (7 0))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 2) (0 1)) ((7 9) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (7 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 8 proxy 10) secret (7 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 408)
  (parent 320)
  (unrealized (3 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 iv-1 answer-1 syskey-0
      data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 8 proxy 10) secret-0 (7 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 409)
  (parent 320)
  (unrealized (3 8) (6 0) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 1) (4 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (7 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 410)
  (parent 320)
  (unrealized (4 8) (8 0) (8 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (2 0)) ((1 0) (7 0))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 2) (0 1)) ((7 9) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (7 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 8 proxy 10) secret (7 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 411)
  (parent 320)
  (unrealized (3 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 iv-1 cookie-0 syskey-0
      data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 8 proxy 10) secret-0 (7 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 412)
  (parent 320)
  (unrealized (3 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 1) (4 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (7 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 413)
  (parent 320)
  (unrealized (4 8) (8 0) (8 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 answer-1 cookie-0
      syskey-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 8 proxy 10) secret-0 (7 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 414)
  (parent 320)
  (unrealized (3 8) (7 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (4 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (7 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 0) (4 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (7 0)) ((5 0) (4 0))
    ((6 0) (4 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 415)
  (parent 324)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (4 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)) ((5 0) (7 0))
    ((6 0) (4 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((5 0) (7 0))
    ((6 0) (4 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 8 5 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 416)
  (parent 324)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (4 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret (pubk proxy-1)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 417)
  (parent 324)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (2 8)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (2 8))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 5 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 418)
  (parent 325)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)) ((6 2) (0 1))
    ((6 7) (5 0)) ((7 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 419)
  (parent 325)
  (unrealized (7 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 7) (6 0)) ((5 9) (3 3))
    ((6 0) (3 8)) ((6 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (6 0))
    ((6 0) (3 8)) ((6 0) (5 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 7 6 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 420)
  (parent 326)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie request-2 answer-1
      cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 7) (6 0)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (6 0))
    ((6 0) (5 8)) ((7 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 421)
  (parent 326)
  (unrealized (7 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (7 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 422)
  (parent 327)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((4 0) (7 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (7 0))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 8 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (7 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 423)
  (parent 327)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (7 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 424)
  (parent 327)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (4 0)) ((1 0) (6 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 425)
  (parent 330)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((3 0) (6 0)) ((4 2) (0 1)) ((4 9) (0 6))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 3 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 426)
  (parent 330)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 427)
  (parent 330)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 request-1
      answer-0 cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 0) (4 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((7 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (4 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie))))
  (label 428)
  (parent 331)
  (unrealized (7 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (4 0)) ((1 0) (7 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (7 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 429)
  (parent 333)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((3 0) (7 0)) ((4 2) (0 1)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 3 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 430)
  (parent 333)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 9) (6 0)) ((8 0) (7 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 431)
  (parent 333)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (4 0)) ((1 0) (7 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (7 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 432)
  (parent 335)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((3 0) (7 0)) ((4 2) (0 1)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)) ((7 9) (6 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 3 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 433)
  (parent 335)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 9) (6 0)) ((8 0) (7 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 434)
  (parent 335)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((7 0) (6 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (6 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 435)
  (parent 336)
  (unrealized (3 8) (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (4 0)) ((1 0) (6 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 7 proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 436)
  (parent 340)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (4 3)) ((0 2) (6 3))
    ((0 3) (4 4)) ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (4 0)) ((3 0) (6 0)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 5) (0 4)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 7 proxy 8) request-1 (6 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 437)
  (parent 340)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 7) (6 0))
    ((5 9) (0 6)) ((6 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (6 0))
    ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 5 proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 438)
  (parent 340)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 439)
  (parent 340)
  (unrealized (7 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer cookie challenge-0 id-0
      request-0 iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation nonce-test (displaced 8 0 client 6) secret (7 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id))))
  (label 440)
  (parent 341)
  (unrealized (5 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (4 0)) ((1 0) (7 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 2) (0 1)) ((7 9) (6 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (7 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 8 proxy 10) secret (7 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 441)
  (parent 341)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 iv-1 answer-1 syskey-0
      data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 8 proxy 10) secret-0 (7 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 442)
  (parent 341)
  (unrealized (4 8) (6 0) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (7 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 443)
  (parent 341)
  (unrealized (5 8) (8 0) (8 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (4 0)) ((1 0) (7 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 2) (0 1)) ((7 9) (6 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (7 0)) ((3 0) (2 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 8 proxy 10) secret (7 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 444)
  (parent 341)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 iv-1 cookie-0 syskey-0
      data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 8 proxy 10) secret-0 (7 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 445)
  (parent 341)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (7 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 446)
  (parent 341)
  (unrealized (5 8) (8 0) (8 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 answer-1 cookie-0
      syskey-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 8 proxy 10) secret-0 (7 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 447)
  (parent 341)
  (unrealized (4 8) (7 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (6 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((3 0) (4 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 7 proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 448)
  (parent 342)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (4 3)) ((0 2) (6 3))
    ((0 3) (4 4)) ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 0) (4 0)) ((3 0) (6 0)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 5) (0 4)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 7 proxy 8) request-1 (6 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 449)
  (parent 342)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 7) (6 0))
    ((5 9) (0 6)) ((6 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 7) (6 0))
    ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 5 proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 450)
  (parent 342)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((6 0) (5 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-1 (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 451)
  (parent 342)
  (unrealized (7 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer cookie challenge-0 id-0
      request-0 iv-0 answer-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation nonce-test (displaced 8 0 client 6) secret (7 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id))))
  (label 452)
  (parent 343)
  (unrealized (5 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (7 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 2) (0 1)) ((7 9) (6 0)))
  (leadsto ((1 0) (7 0)) ((3 0) (2 0)) ((3 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 8 proxy 10) secret (7 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 453)
  (parent 343)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 iv-1 answer-1 syskey-0
      data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (7 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 8 proxy 10) secret-0 (7 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 454)
  (parent 343)
  (unrealized (4 8) (6 0) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (7 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 455)
  (parent 343)
  (unrealized (5 8) (8 0) (8 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 2) (7 8)) ((0 3) (2 4)) ((1 0) (7 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 2) (0 1)) ((7 9) (6 0)))
  (leadsto ((1 0) (7 0)) ((3 0) (2 0)) ((3 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 8 proxy 10) secret (7 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 456)
  (parent 343)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 iv-1 cookie-0 syskey-0
      data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (7 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 8 proxy 10) secret-0 (7 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 457)
  (parent 343)
  (unrealized (4 8) (7 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (7 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 458)
  (parent 343)
  (unrealized (5 8) (8 0) (8 8))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 answer-1 cookie-0
      syskey-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (7 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 8 proxy 10) secret-0 (7 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 459)
  (parent 343)
  (unrealized (4 8) (7 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 request-1 answer-0 cookie data)
    (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((7 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (5 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 460)
  (parent 344)
  (unrealized (7 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 0)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 1) (5 4)) ((8 1) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation encryption-test (added-listener (cat secret challenge id))
    (hash secret challenge id) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id))))
  (label 461)
  (parent 345)
  (unrealized (5 8) (8 0))
  (comment "8 in cohort - 8 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 3) (2 4))
    ((0 5) (4 3)) ((1 0) (7 0)) ((2 5) (0 4)) ((3 0) (2 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 0) (4 8)) ((7 2) (0 1))
    ((7 7) (6 0)))
  (leadsto ((1 0) (7 0)) ((3 0) (2 0)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 1 8 proxy 8) request-1 (7 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc request (pubk proxy-0)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0) (enc proxy-0 (pubk proxy-0) (privk ca))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 462)
  (parent 346)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (7 3)) ((0 3) (7 4))
    ((0 5) (4 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (7 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 0) (4 8)) ((7 5) (0 4))
    ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (7 0)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 8 proxy 8) request-0 (7 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 463)
  (parent 346)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request secret) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (5 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 7) (7 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((5 7) (7 0)) ((6 0) (5 0))
    ((7 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 8 5 proxy 8) request-1 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 464)
  (parent 346)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (5 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)) ((7 0) (5 8))
    ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((7 0) (5 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand proxy 8) request-1 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret (pubk proxy-1)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 465)
  (parent 346)
  (unrealized (8 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8)) ((7 2) (0 1))
    ((7 7) (6 0)))
  (leadsto ((1 0) (7 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 8 proxy 8) request-2 (7 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 466)
  (parent 355)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (4 3))
    ((7 0) (6 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((6 7) (7 0))
    ((7 0) (6 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 8 6 proxy 8) request-2 (7 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 467)
  (parent 355)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3)) ((7 0) (6 8))
    ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((7 0) (6 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (7 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 468)
  (parent 355)
  (unrealized (4 8) (8 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((0 5) (2 6))
    ((1 0) (2 0)) ((2 2) (0 1)) ((2 7) (3 0)) ((2 9) (0 6))
    ((3 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((2 7) (3 0)) ((3 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (2 4)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 469)
  (parent 356)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (2 4)) ((1 0) (2 0))
    ((1 0) (4 0)) ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8))
    ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (3 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 470)
  (parent 357)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (2 4)) ((1 0) (2 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8)) ((4 7) (3 0))
    ((5 0) (4 0)))
  (leadsto ((1 0) (2 0)) ((3 0) (2 8)) ((4 7) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (3 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 471)
  (parent 358)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (2 4)) ((1 0) (2 0))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 8)) ((4 2) (0 1))
    ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (3 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 472)
  (parent 359)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (4 0)) ((3 9) (0 6))
    ((4 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (4 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 473)
  (parent 360)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (4 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (4 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 474)
  (parent 361)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (4 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 0) (3 8)) ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (4 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 475)
  (parent 362)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (4 0)) ((1 0) (6 0))
    ((2 9) (0 6)) ((3 0) (2 0)) ((4 1) (2 4)) ((5 0) (2 8))
    ((6 2) (0 1)) ((6 7) (5 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (2 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig id request)
  (operation generalization deleted (4 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 476)
  (parent 363)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (5 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 7) (6 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 1) (3 4)) ((6 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((3 7) (6 0)) ((4 0) (3 0)) ((6 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 477)
  (parent 364)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (6 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (8 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 0) (3 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((4 0) (3 0)) ((7 0) (3 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 478)
  (parent 365)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (6 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (8 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 0) (3 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (8 0)) ((7 0) (3 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (displaced 9 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 479)
  (parent 365)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request id id))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (6 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 0) (3 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((7 0) (3 8)) ((8 7) (7 0))
    ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request id id)) (send (hash request id id)))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 480)
  (parent 365)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((0 5) (3 0)) ((1 0) (2 0)) ((1 0) (5 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 0) (2 8)) ((5 2) (0 1))
    ((5 5) (0 4)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 481)
  (parent 366)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (4 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 7) (5 0)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (5 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 482)
  (parent 367)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (7 0)) ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 0) (3 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (7 0)) ((6 0) (3 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 8 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 483)
  (parent 368)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 0) (3 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((6 0) (3 8)) ((7 7) (6 0))
    ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 484)
  (parent 368)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (2 8)) ((6 0) (5 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((5 7) (6 0)) ((6 0) (2 8))
    ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 6 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 485)
  (parent 369)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie request-2 answer-1 cookie-0
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((5 7) (6 0)) ((6 0) (5 8))
    ((7 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 486)
  (parent 369)
  (unrealized (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((6 0) (5 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 487)
  (parent 370)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 488)
  (parent 370)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (7 1)) ((0 2) (2 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((0 5) (5 0)) ((1 0) (7 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 0) (2 8))
    ((7 2) (0 1)) ((7 5) (0 4)) ((7 7) (6 0)))
  (leadsto ((1 0) (7 0)) ((3 0) (2 0)) ((6 0) (2 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 2 8 proxy 8) request-0 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 489)
  (parent 374)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 7) (7 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((3 7) (7 0)) ((4 0) (3 0)) ((7 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 8 3 proxy 8) request-1 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 490)
  (parent 374)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 0) (3 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((7 0) (3 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand proxy 8) request-1 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 491)
  (parent 374)
  (unrealized (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1)) ((6 5) (0 4))
    ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((6 7) (7 0)) ((7 0) (6 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 6 proxy 8) request-2 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 492)
  (parent 381)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 493)
  (parent 381)
  (unrealized (2 8) (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (7 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 0) (2 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (7 0)) ((3 0) (2 0)) ((4 7) (5 0))
    ((5 0) (4 8)) ((6 0) (2 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 494)
  (parent 383)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((3 0) (7 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 0) (2 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (7 0)) ((4 7) (5 0))
    ((5 0) (4 8)) ((6 0) (2 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 3 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 495)
  (parent 383)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 0) (2 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (5 0)) ((5 0) (4 8))
    ((6 0) (2 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 496)
  (parent 383)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 7) (7 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((2 7) (7 0)) ((3 0) (2 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 proxy 8) request-3 (7 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 497)
  (parent 385)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 7) (7 0)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((4 7) (7 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 proxy 8) request-3 (7 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 498)
  (parent 385)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (7 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 499)
  (parent 385)
  (unrealized (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 7) (7 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (6 0)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((2 7) (7 0)) ((3 0) (2 0)) ((3 0) (6 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 proxy 8) request-3 (7 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 500)
  (parent 387)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((3 0) (6 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 7) (7 0)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (6 0)) ((4 7) (7 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 proxy 8) request-3 (7 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 501)
  (parent 387)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((3 0) (6 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (7 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 502)
  (parent 387)
  (unrealized (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 7) (8 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((2 7) (8 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 2 proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 503)
  (parent 389)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 7) (8 0)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (8 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 4 proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 504)
  (parent 389)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 proxy-2 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-2) (ca ca-2))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-2 (pubk proxy-2) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-2)
          (enc proxy-2 (pubk proxy-2) (privk ca-2))))
      (recv (enc secret-1 (pubk proxy-2)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 505)
  (parent 389)
  (unrealized (9 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((0 5) (3 0)) ((1 0) (2 0)) ((1 0) (5 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 0) (2 8))
    ((5 5) (0 4)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 506)
  (parent 390)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (4 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 7) (5 0)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (5 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 507)
  (parent 391)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (7 0)) ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 0) (3 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (7 0)) ((6 0) (3 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 8 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 508)
  (parent 392)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 0) (3 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((6 0) (3 8)) ((7 7) (6 0))
    ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 509)
  (parent 392)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (2 8)) ((6 0) (5 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((5 7) (6 0)) ((6 0) (2 8))
    ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 7 6 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 510)
  (parent 393)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie request-2 answer-1 cookie-0
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((5 7) (6 0)) ((6 0) (5 8))
    ((7 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 511)
  (parent 393)
  (unrealized (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((6 0) (5 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 512)
  (parent 394)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 513)
  (parent 394)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (7 0)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 0) (3 8)) ((7 2) (0 1)) ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (7 0)) ((6 0) (3 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 1 8 proxy 8) request-1 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 514)
  (parent 397)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((0 5) (5 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (7 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 0) (3 8)) ((7 5) (0 4)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (7 0)) ((6 0) (3 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 8 proxy 8) request-0 (7 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 515)
  (parent 397)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 7) (7 0))
    ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0)) ((7 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((4 7) (7 0))
    ((7 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 8 4 proxy 8) request-1 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 516)
  (parent 397)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)) ((7 0) (4 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((7 0) (4 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand proxy 8) request-1 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 517)
  (parent 397)
  (unrealized (8 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)) ((7 2) (0 1)) ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((6 0) (5 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 8 proxy 8) request-2 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 518)
  (parent 402)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((6 7) (7 0))
    ((7 0) (6 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 8 6 proxy 8) request-2 (7 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 519)
  (parent 402)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((7 0) (6 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (7 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 520)
  (parent 402)
  (unrealized (3 8) (8 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (7 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 0) (4 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (7 0)) ((5 0) (4 0))
    ((6 0) (4 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 521)
  (parent 406)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((5 0) (7 0)) ((6 0) (4 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((5 0) (7 0))
    ((6 0) (4 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 5 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 522)
  (parent 406)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 0) (4 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 523)
  (parent 406)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 request-1 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 1) (4 4)) ((7 1) (6 0)) ((8 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((8 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (4 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie))))
  (label 524)
  (parent 407)
  (unrealized (8 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (8 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 1) (4 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (8 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 525)
  (parent 410)
  (unrealized (4 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((5 0) (8 0)) ((6 1) (4 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((5 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 5 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 526)
  (parent 410)
  (unrealized (4 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 1) (4 4)) ((7 1) (6 0)) ((8 9) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 527)
  (parent 410)
  (unrealized (4 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (8 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 1) (4 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (8 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 528)
  (parent 413)
  (unrealized (4 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((5 0) (8 0)) ((6 1) (4 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((5 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 5 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 529)
  (parent 413)
  (unrealized (4 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 1) (4 4)) ((7 1) (6 0)) ((8 9) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 530)
  (parent 413)
  (unrealized (4 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 request-2
      answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((8 0) (7 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (7 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 531)
  (parent 414)
  (unrealized (3 8) (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 7) (7 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)) ((7 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((2 7) (7 0)) ((3 0) (2 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 proxy 8) request-3 (7 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 532)
  (parent 419)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 5) (0 4)) ((4 7) (7 0)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)) ((7 0) (2 8)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((4 7) (7 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 proxy 8) request-3 (7 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 533)
  (parent 419)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)) ((6 2) (0 1))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (7 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 534)
  (parent 419)
  (unrealized (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (7 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 0) (2 8)) ((7 2) (0 1)) ((7 7) (6 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (7 0)) ((3 0) (2 0)) ((4 7) (5 0))
    ((5 0) (4 8)) ((6 0) (2 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 8 proxy 8) request-2 (7 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 535)
  (parent 421)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 7) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 7) (6 0))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((3 7) (7 0)) ((4 0) (3 0))
    ((5 7) (6 0)) ((6 0) (5 8)) ((7 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 8 3 proxy 8) request-2 (7 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 536)
  (parent 421)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 7) (6 0)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (6 0))
    ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (7 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 537)
  (parent 421)
  (unrealized (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (3 8)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((4 0) (3 0))
    ((6 0) (3 8)) ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 538)
  (parent 422)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 request-3 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 539)
  (parent 422)
  (unrealized (8 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((4 0) (7 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (3 8)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (7 0))
    ((6 0) (3 8)) ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 540)
  (parent 423)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 request-3 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((4 0) (7 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (7 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 541)
  (parent 423)
  (unrealized (8 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (3 8))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (3 8))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 6 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 542)
  (parent 424)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 request-3 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 543)
  (parent 424)
  (unrealized (9 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((0 5) (5 0)) ((1 0) (3 0)) ((2 0) (7 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 0) (3 8)) ((7 5) (0 4)) ((7 7) (6 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (7 0)) ((6 0) (3 8)) ((7 7) (6 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 2 8 proxy 8) request-0 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 544)
  (parent 428)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 7) (7 0)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)) ((7 0) (4 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (7 0)) ((7 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 8 4 proxy 8) request-1 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 545)
  (parent 428)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 0) (4 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((7 0) (4 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand proxy 8) request-1 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 546)
  (parent 428)
  (unrealized (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((6 7) (7 0)) ((7 0) (6 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 6 proxy 8) request-2 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 547)
  (parent 435)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 548)
  (parent 435)
  (unrealized (3 8) (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((2 0) (7 0)) ((3 5) (0 4)) ((4 0) (3 0))
    ((5 9) (0 6)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 549)
  (parent 439)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (7 0))
    ((5 9) (0 6)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (7 0))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 550)
  (parent 439)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 551)
  (parent 439)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 request-1 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)) ((8 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((8 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (5 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie))))
  (label 552)
  (parent 440)
  (unrealized (8 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((2 0) (8 0)) ((3 5) (0 4)) ((4 0) (3 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (8 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 553)
  (parent 443)
  (unrealized (5 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (8 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 554)
  (parent 443)
  (unrealized (5 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 555)
  (parent 443)
  (unrealized (5 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((2 0) (8 0)) ((3 5) (0 4)) ((4 0) (3 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (8 0)) ((4 0) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 556)
  (parent 446)
  (unrealized (5 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (8 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 557)
  (parent 446)
  (unrealized (5 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 558)
  (parent 446)
  (unrealized (5 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 request-2
      answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)) ((8 0) (7 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (7 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 559)
  (parent 447)
  (unrealized (4 8) (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (7 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0))
    ((5 9) (0 6)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((4 0) (5 0))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 560)
  (parent 451)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((4 0) (7 0))
    ((5 9) (0 6)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((4 0) (7 0))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 561)
  (parent 451)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 562)
  (parent 451)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 request-1 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)) ((8 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((8 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (5 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie))))
  (label 563)
  (parent 452)
  (unrealized (8 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (8 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((4 0) (3 0)) ((4 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 564)
  (parent 455)
  (unrealized (5 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((4 0) (8 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((4 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 565)
  (parent 455)
  (unrealized (5 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 566)
  (parent 455)
  (unrealized (5 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (8 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((4 0) (3 0)) ((4 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 567)
  (parent 458)
  (unrealized (5 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((4 0) (8 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((4 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 568)
  (parent 458)
  (unrealized (5 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (8 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)) ((8 9) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 569)
  (parent 458)
  (unrealized (5 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 request-2
      answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (7 0)) ((8 0) (7 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (7 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 570)
  (parent 459)
  (unrealized (4 8) (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer request-0 iv-0
      answer-0 cookie challenge-0 id-0 secret-0 request-1 data)
    (ca ca-0 proxy ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((1 0) (7 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 2) (0 1)) ((7 7) (6 0)))
  (leadsto ((1 0) (7 0)) ((3 0) (2 0)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 8 proxy 8) request-1 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 571)
  (parent 460)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca ca-0 proxy ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (4 4)) ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 5) (0 4)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (7 0)) ((5 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 8 proxy 8) request-1 (7 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 572)
  (parent 460)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 7) (7 0)) ((5 9) (0 6))
    ((6 0) (5 0)) ((7 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((5 7) (7 0)) ((6 0) (5 0))
    ((7 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 5 proxy 8) request-1 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 573)
  (parent 460)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 ca-1 proxy-0 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((7 0) (5 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-1 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 574)
  (parent 460)
  (unrealized (8 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer cookie challenge-0 id-0
      request-0 iv-0 answer-0 data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (8 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 1) (5 4)) ((8 1) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation nonce-test (displaced 9 0 client 6) secret (8 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id))))
  (label 575)
  (parent 461)
  (unrealized (5 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 answer-1
      syskey-0 data) (ca ca-0 proxy ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 2) (8 8)) ((0 3) (2 4)) ((1 0) (8 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 1) (4 4))
    ((7 1) (6 0)) ((8 2) (0 1)) ((8 9) (7 0)))
  (leadsto ((1 0) (8 0)) ((3 0) (2 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca-1))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 9 proxy 10) secret (8 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 576)
  (parent 461)
  (unrealized (4 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 iv-1 answer-1 syskey-0
      data) (ca ca-0 proxy ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv iv-1) (answer answer-1) (cookie secret)
    (syskey syskey-0) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (8 1)) ((0 2) (4 3)) ((0 2) (8 3))
    ((0 3) (8 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (8 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 1) (4 4)) ((7 1) (6 0))
    ((8 5) (0 4)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (8 0)) ((5 0) (4 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 9 proxy 10) secret-0 (8 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 577)
  (parent 461)
  (unrealized (4 8) (7 0) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data)
    (proxy ca ca-0 ca-1 proxy-0 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (9 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 1) (5 4)) ((8 1) (7 0)) ((9 9) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (8 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 578)
  (parent 461)
  (unrealized (5 8) (9 0) (9 8))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie request-0 iv-0
      answer-0 challenge-0 id-0 secret-0 request-1 iv-1 cookie-0
      syskey-0 data) (ca ca-0 proxy ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-0) (id id-0)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 2) (8 8)) ((0 3) (2 4)) ((1 0) (8 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 1) (4 4))
    ((7 1) (6 0)) ((8 2) (0 1)) ((8 9) (7 0)))
  (leadsto ((1 0) (8 0)) ((3 0) (2 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca-1))
  (uniq-orig challenge secret)
  (operation nonce-test (displaced 1 9 proxy 10) secret (8 0)
    (enc secret (pubk proxy-0)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-0 id-0)))))))
  (label 579)
  (parent 461)
  (unrealized (4 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 iv-1 cookie-0 syskey-0
      data) (ca ca-0 proxy ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv iv-1) (answer secret) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (8 1)) ((0 2) (4 3)) ((0 2) (8 3))
    ((0 3) (8 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (8 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 1) (4 4)) ((7 1) (6 0))
    ((8 5) (0 4)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (8 0)) ((5 0) (4 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 9 proxy 10) secret-0 (8 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 580)
  (parent 461)
  (unrealized (4 8) (8 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data)
    (proxy ca ca-0 ca-1 proxy-0 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (9 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 1) (5 4)) ((8 1) (7 0)) ((9 9) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation nonce-test (added-strand proxy 10) secret (8 0)
    (enc secret (pubk proxy)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 581)
  (parent 461)
  (unrealized (5 8) (9 0) (9 8))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 answer-1 cookie-0
      syskey-0 data) (ca ca-0 proxy ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (8 1)) ((0 2) (4 3)) ((0 2) (8 3))
    ((0 3) (8 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (8 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 1) (4 4)) ((7 1) (6 0))
    ((8 5) (0 4)) ((8 9) (7 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (8 0)) ((5 0) (4 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation nonce-test (displaced 3 9 proxy 10) secret-0 (8 0)
    (enc secret-0 (pubk proxy-0)))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0)))))))
  (label 582)
  (parent 461)
  (unrealized (4 8) (8 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (5 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (8 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((4 0) (3 0)) ((6 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 583)
  (parent 465)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (5 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((4 0) (8 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (8 0)) ((6 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 9 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 584)
  (parent 465)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (5 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)) ((6 0) (8 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((6 0) (8 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 9 6 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 585)
  (parent 465)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 3) (3 4))
    ((0 5) (5 3)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 5) (0 4))
    ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0)) ((7 0) (5 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((7 0) (5 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc request (pubk proxy-0)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret (pubk proxy-1)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-2)))))
  (label 586)
  (parent 465)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret request) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (request (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (3 8)) ((6 0) (5 8))
    ((7 2) (0 1)) ((7 7) (6 0)))
  (leadsto ((1 0) (7 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (3 8))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 587)
  (parent 466)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8)) ((7 2) (0 1))
    ((7 7) (6 0)) ((8 0) (3 8)))
  (leadsto ((1 0) (7 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 588)
  (parent 466)
  (unrealized (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (4 3))
    ((7 0) (4 8)) ((7 0) (6 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((6 7) (7 0))
    ((7 0) (4 8)) ((7 0) (6 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 8 7 server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 589)
  (parent 467)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie request-2 answer-1
      cookie-0 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((6 7) (7 0))
    ((7 0) (6 8)) ((8 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 590)
  (parent 467)
  (unrealized (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0)) ((5 0) (4 0))
    ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 591)
  (parent 468)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0)) ((5 0) (4 0))
    ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 3 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 592)
  (parent 468)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((5 0) (8 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((5 0) (8 0))
    ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 5 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 593)
  (parent 468)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-2)))))
  (label 594)
  (parent 468)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((0 5) (2 7))
    ((1 0) (2 0)) ((2 2) (0 1)) ((2 7) (3 0)) ((2 9) (0 6))
    ((3 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((2 7) (3 0)) ((3 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (2 6)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 595)
  (parent 469)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((0 5) (2 6))
    ((1 0) (2 0)) ((1 0) (4 0)) ((2 2) (0 1)) ((2 9) (0 6))
    ((3 0) (2 8)) ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (2 4)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 596)
  (parent 470)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((0 5) (2 6))
    ((1 0) (2 0)) ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8))
    ((4 7) (3 0)) ((5 0) (4 0)))
  (leadsto ((1 0) (2 0)) ((3 0) (2 8)) ((4 7) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (2 4)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 597)
  (parent 471)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((0 5) (2 6))
    ((1 0) (2 0)) ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 8))
    ((4 2) (0 1)) ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (2 4)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 598)
  (parent 472)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((0 5) (3 6))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (4 0))
    ((3 9) (0 6)) ((4 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 599)
  (parent 473)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (4 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 600)
  (parent 474)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0))
    ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (4 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 601)
  (parent 475)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 5) (2 4)) ((1 0) (5 0))
    ((2 9) (0 6)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 2) (0 1))
    ((5 7) (4 0)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig id request)
  (operation generalization deleted (4 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 602)
  (parent 476)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 7) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((3 7) (5 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 603)
  (parent 477)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (5 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (7 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 1) (3 4)) ((6 0) (3 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((6 0) (3 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 604)
  (parent 478)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (5 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (7 0))
    ((5 1) (3 4)) ((6 0) (3 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (7 0)) ((6 0) (3 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 605)
  (parent 479)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (cat request id id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (5 0)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 0) (3 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (3 8)) ((7 7) (6 0))
    ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (cat request id id)) (send (cat request id id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 606)
  (parent 480)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((0 5) (2 4)) ((1 0) (2 0)) ((1 0) (4 0))
    ((2 9) (0 6)) ((3 0) (2 8)) ((4 2) (0 1)) ((4 5) (0 4))
    ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 607)
  (parent 481)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 7) (4 0)) ((3 9) (0 6))
    ((4 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 608)
  (parent 482)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (4 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (6 0)) ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 609)
  (parent 483)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (4 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 0) (3 8)) ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 610)
  (parent 484)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 7) (5 0))
    ((4 9) (3 0)) ((5 0) (2 8)) ((5 0) (4 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((4 7) (5 0)) ((5 0) (2 8))
    ((5 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 611)
  (parent 485)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 7) (7 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1))
    ((5 5) (0 4)) ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8))
    ((7 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((2 7) (7 0)) ((5 7) (6 0))
    ((6 0) (5 8)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 proxy 8) request-2 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 612)
  (parent 486)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 0) (2 8))
    ((8 7) (7 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((5 7) (6 0)) ((6 0) (5 8))
    ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 613)
  (parent 486)
  (unrealized (8 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (2 8)) ((6 0) (5 8))
    ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((6 0) (2 8))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 614)
  (parent 487)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 615)
  (parent 487)
  (unrealized (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (2 8)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((6 0) (2 8)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 6 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 616)
  (parent 488)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0))
    ((9 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)) ((9 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 617)
  (parent 488)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((0 5) (4 0)) ((1 0) (6 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 0) (2 8)) ((6 2) (0 1))
    ((6 5) (0 4)) ((6 7) (5 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (2 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 618)
  (parent 489)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 7) (6 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 1) (3 4)) ((6 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((3 7) (6 0)) ((4 0) (3 0)) ((6 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 619)
  (parent 490)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (2 0)) ((1 0) (8 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 0) (3 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (8 0)) ((4 0) (3 0)) ((7 0) (3 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 9 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 620)
  (parent 491)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (8 0))
    ((5 1) (3 4)) ((6 1) (5 0)) ((7 0) (3 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((4 0) (8 0)) ((7 0) (3 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 9 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 621)
  (parent 491)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 0) (3 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((7 0) (3 8)) ((8 7) (7 0))
    ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 622)
  (parent 491)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1)) ((6 5) (0 4))
    ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (2 8)) ((7 0) (6 8)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((6 7) (7 0)) ((7 0) (2 8))
    ((7 0) (6 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 7 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 623)
  (parent 492)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie request-2 answer-1 cookie-0
      data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1)) ((6 5) (0 4))
    ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 0) (2 8)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((6 7) (7 0)) ((7 0) (6 8))
    ((8 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 624)
  (parent 492)
  (unrealized (8 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((7 0) (6 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 625)
  (parent 493)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (8 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((3 0) (8 0)) ((7 0) (6 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 3 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 626)
  (parent 493)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 627)
  (parent 493)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 628)
  (parent 499)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (8 0)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((3 0) (8 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 3 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-1 (pubk proxy)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 629)
  (parent 499)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 630)
  (parent 499)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (8 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (6 0)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((3 0) (6 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 631)
  (parent 502)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((3 0) (6 0))
    ((3 0) (8 0)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (6 0)) ((3 0) (8 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 3 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-1 (pubk proxy)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 632)
  (parent 502)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((3 0) (6 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 633)
  (parent 502)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (9 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (9 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 1 certauth 1)
    (enc proxy-2 (pubk proxy-2) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 634)
  (parent 505)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((3 0) (9 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (9 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 3 certauth 1)
    (enc proxy-2 (pubk proxy-2) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-1 (pubk proxy)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 635)
  (parent 505)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)) ((7 0) (9 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)) ((7 0) (9 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 7 certauth 1)
    (enc proxy-2 (pubk proxy-2) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 636)
  (parent 505)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 proxy-2 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-2) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-2) (ca ca-2))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-2 (pubk proxy-2) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-2 (pubk proxy-2) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-2)
          (enc proxy-2 (pubk proxy-2) (privk ca-2))))
      (recv (enc secret-1 (pubk proxy-2)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3))
    ((init (enc proxy-2 (pubk proxy-2) (privk ca-2)))))
  (label 637)
  (parent 505)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((0 5) (2 4)) ((1 0) (2 0)) ((1 0) (4 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8)) ((4 5) (0 4))
    ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 638)
  (parent 506)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 7) (4 0)) ((3 9) (0 6))
    ((4 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 639)
  (parent 507)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (4 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (6 0)) ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 640)
  (parent 508)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (4 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 0) (3 8)) ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 641)
  (parent 509)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 5) (0 4)) ((4 7) (5 0))
    ((4 9) (3 0)) ((5 0) (2 8)) ((5 0) (4 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((4 7) (5 0)) ((5 0) (2 8))
    ((5 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 642)
  (parent 510)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 7) (7 0)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 5) (0 4)) ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8))
    ((7 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((2 7) (7 0)) ((5 7) (6 0))
    ((6 0) (5 8)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 2 proxy 8) request-2 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 643)
  (parent 511)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 0) (2 8))
    ((8 7) (7 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((5 7) (6 0)) ((6 0) (5 8))
    ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (7 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 644)
  (parent 511)
  (unrealized (8 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (2 8)) ((6 0) (5 8))
    ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((6 0) (2 8))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 645)
  (parent 512)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 646)
  (parent 512)
  (unrealized (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (2 8)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((6 0) (2 8)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 6 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 647)
  (parent 513)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0))
    ((9 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)) ((9 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 648)
  (parent 513)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (4 0)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (6 0)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 0) (3 8)) ((6 2) (0 1)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 649)
  (parent 514)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((0 5) (4 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (6 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 0) (3 8)) ((6 5) (0 4)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 650)
  (parent 515)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (5 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 7) (6 0))
    ((4 9) (0 6)) ((5 1) (4 4)) ((6 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((4 7) (6 0))
    ((6 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 651)
  (parent 516)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((2 0) (8 0)) ((3 5) (0 4))
    ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0)) ((7 0) (4 8))
    ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((2 0) (8 0))
    ((7 0) (4 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 652)
  (parent 517)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)) ((7 0) (4 8)) ((8 7) (7 0))
    ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((7 0) (4 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 653)
  (parent 517)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (2 8)) ((6 0) (5 8)) ((7 2) (0 1))
    ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((6 0) (2 8))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 6 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 654)
  (parent 518)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)) ((7 2) (0 1)) ((7 7) (6 0))
    ((8 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 655)
  (parent 518)
  (unrealized (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (3 8))
    ((7 0) (6 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((6 7) (7 0))
    ((7 0) (3 8)) ((7 0) (6 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 8 7 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 656)
  (parent 519)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie request-2 answer-1
      cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((6 7) (7 0))
    ((7 0) (6 8)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 657)
  (parent 519)
  (unrealized (8 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((2 0) (8 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0))
    ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (8 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 658)
  (parent 520)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (8 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 659)
  (parent 520)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (2 0)) ((1 0) (8 0))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 0) (3 8)) ((8 2) (0 1)) ((8 7) (7 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (8 0)) ((4 0) (3 0)) ((7 0) (3 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 1 9 proxy 8) request-1 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 660)
  (parent 524)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (8 1)) ((0 2) (3 3)) ((0 2) (8 3))
    ((0 3) (8 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (8 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 0) (3 8)) ((8 5) (0 4)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((4 0) (3 0)) ((7 0) (3 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 9 proxy 8) request-0 (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 661)
  (parent 524)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 7) (8 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 1) (4 4)) ((7 1) (6 0)) ((8 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 7) (8 0)) ((5 0) (4 0))
    ((8 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 9 4 proxy 8) request-1 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 662)
  (parent 524)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 1) (4 4)) ((7 1) (6 0)) ((8 0) (4 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((8 0) (4 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand proxy 8) request-1 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 663)
  (parent 524)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)) ((8 2) (0 1)) ((8 7) (7 0)))
  (leadsto ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((7 0) (6 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 9 proxy 8) request-2 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 664)
  (parent 531)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 7) (8 0)) ((7 9) (6 0)) ((8 0) (7 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((7 7) (8 0))
    ((8 0) (7 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 7 proxy 8) request-2 (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 665)
  (parent 531)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((8 0) (7 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 666)
  (parent 531)
  (unrealized (3 8) (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 667)
  (parent 534)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (8 0)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((3 0) (8 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 3 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-1 (pubk proxy)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 668)
  (parent 534)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)) ((6 2) (0 1))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 669)
  (parent 534)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (8 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 7) (6 0))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (8 0)) ((4 0) (3 0))
    ((5 7) (6 0)) ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 670)
  (parent 537)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((4 0) (8 0)) ((5 5) (0 4)) ((5 7) (6 0))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (8 0))
    ((5 7) (6 0)) ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 671)
  (parent 537)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 7) (6 0)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (6 0))
    ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 672)
  (parent 537)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 2) (0 1)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 9 proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 673)
  (parent 539)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((3 7) (8 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((3 7) (8 0))
    ((4 0) (3 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 3 proxy 8) request-3 (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 674)
  (parent 539)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 7) (8 0))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((4 0) (3 0))
    ((5 7) (8 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 5 proxy 8) request-3 (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 675)
  (parent 539)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-2)
      (send
        (cat id-2 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3)))
  (label 676)
  (parent 539)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (8 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (6 0)) ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (2 8)) ((8 2) (0 1)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((3 0) (6 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 9 proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 677)
  (parent 541)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 7) (8 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (7 0)) ((5 5) (0 4))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((3 7) (8 0)) ((4 0) (3 0))
    ((4 0) (7 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 3 proxy 8) request-3 (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 678)
  (parent 541)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((4 0) (7 0)) ((5 5) (0 4)) ((5 7) (8 0))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (7 0))
    ((5 7) (8 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 5 proxy 8) request-3 (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 679)
  (parent 541)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((4 0) (7 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (7 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-2)
      (send
        (cat id-2 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3)))
  (label 680)
  (parent 541)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (4 3)) ((0 3) (4 4))
    ((1 0) (4 0)) ((1 0) (9 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 5) (0 4)) ((4 9) (2 3)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)) ((8 0) (2 8)) ((9 2) (0 1)) ((9 7) (8 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (9 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-1) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 10 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (send (enc secret (pubk proxy-1)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge)
      (send
        (cat id (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret (pubk proxy-1)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 681)
  (parent 543)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-1) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 7) (9 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((3 7) (9 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 3 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 682)
  (parent 543)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 7) (9 0)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (9 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 5 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 683)
  (parent 543)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data)
    (proxy ca proxy-0 ca-0 proxy-1 ca-1 proxy-2 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-2) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8)) ((10 7) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-2 (pubk proxy-2) (privk ca-2))) (recv challenge-2)
      (send
        (cat id-2 (pubk proxy-2)
          (enc proxy-2 (pubk proxy-2) (privk ca-2))))
      (recv (enc secret-1 (pubk proxy-2)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3)))
  (label 684)
  (parent 543)
  (unrealized (10 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((0 5) (4 0)) ((1 0) (3 0)) ((2 0) (6 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 0) (3 8))
    ((6 5) (0 4)) ((6 7) (5 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((5 0) (3 8)) ((6 7) (5 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 685)
  (parent 544)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 7) (6 0)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 0) (4 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (6 0)) ((6 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 686)
  (parent 545)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (4 0)) ((1 0) (8 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)) ((7 0) (4 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((7 0) (4 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 9 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 687)
  (parent 546)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((3 0) (8 0)) ((4 2) (0 1)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 1) (5 0)) ((7 0) (4 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (8 0)) ((7 0) (4 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 9 3 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 688)
  (parent 546)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 0) (4 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((7 0) (4 8)) ((8 7) (7 0))
    ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 689)
  (parent 546)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (3 8)) ((7 0) (6 8)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((6 7) (7 0)) ((7 0) (3 8))
    ((7 0) (6 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 8 7 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 690)
  (parent 547)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie request-2 answer-1 cookie-0
      data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 0) (3 8)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((6 7) (7 0)) ((7 0) (6 8))
    ((8 0) (3 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 691)
  (parent 547)
  (unrealized (8 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0)) ((7 0) (6 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 692)
  (parent 548)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0)) ((7 0) (6 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 693)
  (parent 548)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (8 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 694)
  (parent 548)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (4 0)) ((1 0) (8 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 0) (4 8)) ((8 2) (0 1)) ((8 7) (7 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((7 0) (4 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 1 9 proxy 8) request-1 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 695)
  (parent 552)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (8 1)) ((0 2) (4 3)) ((0 2) (8 3))
    ((0 3) (8 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (4 0)) ((3 0) (8 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 0) (4 8)) ((8 5) (0 4)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (8 0)) ((7 0) (4 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 9 proxy 8) request-0 (8 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 696)
  (parent 552)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 7) (8 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 1) (6 0)) ((8 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (8 0))
    ((8 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 9 5 proxy 8) request-1 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 697)
  (parent 552)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)) ((8 0) (5 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((8 0) (5 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand proxy 8) request-1 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 698)
  (parent 552)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)) ((8 2) (0 1)) ((8 7) (7 0)))
  (leadsto ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0)) ((7 0) (6 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 9 proxy 8) request-2 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 699)
  (parent 559)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 7) (8 0)) ((7 9) (6 0)) ((8 0) (7 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)) ((7 7) (8 0))
    ((8 0) (7 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 7 proxy 8) request-2 (8 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 700)
  (parent 559)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)) ((8 0) (7 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (8 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 701)
  (parent 559)
  (unrealized (4 8) (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (6 0)) ((1 0) (8 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 0) (4 8)) ((8 2) (0 1)) ((8 7) (7 0)))
  (leadsto ((1 0) (8 0)) ((3 0) (2 0)) ((3 0) (4 0)) ((7 0) (4 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 1 9 proxy 8) request-1 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 702)
  (parent 563)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (8 1)) ((0 2) (4 3)) ((0 2) (8 3))
    ((0 3) (8 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 0) (4 0)) ((3 0) (8 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 0) (4 8)) ((8 5) (0 4)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (8 0)) ((7 0) (4 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 9 proxy 8) request-0 (8 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 703)
  (parent 563)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 7) (8 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 1) (6 0)) ((8 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 7) (8 0))
    ((8 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 9 5 proxy 8) request-1 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 704)
  (parent 563)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)) ((8 0) (5 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((8 0) (5 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand proxy 8) request-1 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 705)
  (parent 563)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (8 0)) ((2 0) (3 0)) ((2 0) (6 0))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)) ((8 2) (0 1)) ((8 7) (7 0)))
  (leadsto ((1 0) (8 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((7 0) (6 8))
    ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 9 proxy 8) request-2 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 706)
  (parent 570)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 7) (8 0)) ((7 9) (6 0)) ((8 0) (7 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (7 0)) ((7 7) (8 0))
    ((8 0) (7 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 7 proxy 8) request-2 (8 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 707)
  (parent 570)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (7 0)) ((8 0) (7 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (8 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 708)
  (parent 570)
  (unrealized (4 8) (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (8 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 0) (5 0)) ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((4 0) (3 0)) ((6 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 709)
  (parent 574)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (8 0)) ((5 9) (0 6))
    ((6 0) (5 0)) ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (8 0)) ((6 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 710)
  (parent 574)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((6 0) (8 0)) ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((6 0) (8 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 6 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 711)
  (parent 574)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer challenge-0 id-0
      request-0 iv-0 answer-0 cookie challenge-1 id-1 secret-0 request-1
      data) (proxy ca ca-0 ca-1 proxy-0 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-1) (proxy proxy-0) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((7 0) (5 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-2)))))
  (label 712)
  (parent 574)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy) (ca ca) (request request) (iv iv) (answer answer)
        (cookie cookie))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 request-1 answer-0 cookie data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (8 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 1) (5 4)) ((8 1) (7 0)) ((9 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((9 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand server 1)
    (cat answer-0 cookie) (5 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie))))
  (label 713)
  (parent 575)
  (unrealized (9 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (9 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (9 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 0) (5 0)) ((7 1) (5 4)) ((8 1) (7 0)) ((9 9) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (9 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 714)
  (parent 578)
  (unrealized (5 8) (9 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (9 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (9 0)) ((5 9) (0 6))
    ((6 0) (5 0)) ((7 1) (5 4)) ((8 1) (7 0)) ((9 9) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (9 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 715)
  (parent 578)
  (unrealized (5 8) (9 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (9 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((6 0) (9 0)) ((7 1) (5 4)) ((8 1) (7 0)) ((9 9) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((6 0) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 6 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 716)
  (parent 578)
  (unrealized (5 8) (9 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 answer-1 syskey-0 data)
    (proxy ca ca-0 ca-1 proxy-0 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer answer-1)
    (cookie secret) (syskey syskey-0) (proxy proxy-0) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (9 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 1) (5 4)) ((8 1) (7 0)) ((9 9) (8 0)) ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat answer-1 secret))
      (send
        (cat answer-1 iv-1
          (enc secret
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-2)))))
  (label 717)
  (parent 578)
  (unrealized (5 8) (9 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (9 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (9 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 0) (5 0)) ((7 1) (5 4)) ((8 1) (7 0)) ((9 9) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (9 0)) ((4 0) (3 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 718)
  (parent 581)
  (unrealized (5 8) (9 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (9 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (9 0)) ((5 9) (0 6))
    ((6 0) (5 0)) ((7 1) (5 4)) ((8 1) (7 0)) ((9 9) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (9 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 719)
  (parent 581)
  (unrealized (5 8) (9 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (9 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((6 0) (9 0)) ((7 1) (5 4)) ((8 1) (7 0)) ((9 9) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((6 0) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 6 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1)))))))
  (label 720)
  (parent 581)
  (unrealized (5 8) (9 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (challenge secret id syskey request iv answer cookie challenge-0
      id-0 request-0 iv-0 answer-0 challenge-1 id-1 secret-0 request-1
      iv-1 cookie-0 syskey-0 data)
    (proxy ca ca-0 ca-1 proxy-0 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret secret)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge-1) (id id-1)
    (secret secret-0) (request request-1) (iv iv-1) (answer secret)
    (cookie cookie-0) (syskey syskey-0) (proxy proxy-0) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 2) (9 8)) ((0 3) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 1) (5 4)) ((8 1) (7 0)) ((9 9) (8 0)) ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-1) (init request-1) (obsv (cat secret cookie-0))
      (send
        (cat secret iv-1
          (enc cookie-0
            (hash syskey-0 (hash secret-0 challenge-1 id-1))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-2)))))
  (label 721)
  (parent 581)
  (unrealized (5 8) (9 8))
  (dead)
  (comment "empty cohort"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 request-2
      answer-1 cookie-0 data) (ca ca-0 proxy ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (8 1)) ((0 2) (4 3)) ((0 2) (8 3))
    ((0 3) (8 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (8 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 1) (4 4)) ((7 1) (6 0))
    ((8 5) (0 4)) ((8 9) (7 0)) ((9 0) (8 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (8 0)) ((5 0) (4 0)) ((9 0) (8 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (8 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 722)
  (parent 582)
  (unrealized (4 8) (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((2 0) (5 0)) ((3 7) (8 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 2) (0 1)) ((7 7) (6 0)) ((8 0) (3 8)))
  (leadsto ((1 0) (7 0)) ((2 0) (5 0)) ((3 7) (8 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 3 proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 723)
  (parent 588)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 5) (0 4)) ((5 7) (8 0)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 2) (0 1)) ((7 7) (6 0)) ((8 0) (3 8)))
  (leadsto ((1 0) (7 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (8 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 5 proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 724)
  (parent 588)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8)) ((7 2) (0 1))
    ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (7 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 725)
  (parent 588)
  (unrealized (9 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (8 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 5) (0 4)) ((5 7) (6 0)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 0) (3 8)) ((8 2) (0 1)) ((8 7) (7 0)))
  (leadsto ((1 0) (8 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (6 0))
    ((6 0) (5 8)) ((7 0) (3 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 9 proxy 8) request-2 (8 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 726)
  (parent 590)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 7) (8 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (7 0))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((4 7) (8 0)) ((5 0) (4 0))
    ((6 7) (7 0)) ((7 0) (6 8)) ((8 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 4 proxy 8) request-2 (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 727)
  (parent 590)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((6 7) (7 0))
    ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (8 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 728)
  (parent 590)
  (unrealized (9 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (4 8)) ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0)) ((5 0) (4 0))
    ((7 0) (4 8)) ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 7 server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 729)
  (parent 591)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 request-3 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0)) ((5 0) (4 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 730)
  (parent 591)
  (unrealized (9 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (4 8)) ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0)) ((5 0) (4 0))
    ((7 0) (4 8)) ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 7 server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 731)
  (parent 592)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 request-3 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0)) ((5 0) (4 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 732)
  (parent 592)
  (unrealized (9 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((5 0) (8 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (4 8)) ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((5 0) (8 0))
    ((7 0) (4 8)) ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 7 server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 733)
  (parent 593)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 request-3 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((5 0) (8 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((5 0) (8 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 734)
  (parent 593)
  (unrealized (9 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3)) ((7 0) (4 8))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((7 0) (4 8))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 7 server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-2)))))
  (label 735)
  (parent 594)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 request-3 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-2))))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 736)
  (parent 594)
  (unrealized (10 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((0 5) (3 0))
    ((1 0) (2 0)) ((2 2) (0 1)) ((2 7) (3 0)) ((2 9) (0 6))
    ((3 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((2 7) (3 0)) ((3 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (2 7)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 737)
  (parent 595)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((0 5) (2 7))
    ((1 0) (2 0)) ((1 0) (4 0)) ((2 2) (0 1)) ((2 9) (0 6))
    ((3 0) (2 8)) ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (2 6)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 738)
  (parent 596)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((0 5) (2 7))
    ((1 0) (2 0)) ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8))
    ((4 7) (3 0)) ((5 0) (4 0)))
  (leadsto ((1 0) (2 0)) ((3 0) (2 8)) ((4 7) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (2 6)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 739)
  (parent 597)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((0 5) (2 7))
    ((1 0) (2 0)) ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 8))
    ((4 2) (0 1)) ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (2 6)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 740)
  (parent 598)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((0 5) (3 7))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (4 0))
    ((3 9) (0 6)) ((4 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (3 6)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 741)
  (parent 599)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((0 5) (3 6))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0))
    ((3 9) (0 6)) ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 742)
  (parent 600)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((0 5) (3 6))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0))
    ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 743)
  (parent 601)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((0 5) (2 6))
    ((1 0) (5 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 0) (2 8))
    ((5 2) (0 1)) ((5 7) (4 0)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (2 4)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 744)
  (parent 602)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((0 5) (3 6))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 7) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((3 7) (5 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 745)
  (parent 603)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((2 0) (6 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 746)
  (parent 604)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (6 0))
    ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 747)
  (parent 605)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 5) (3 4)) ((1 2) (0 1))
    ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization deleted (5 0))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 748)
  (parent 606)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((0 5) (2 6)) ((1 0) (2 0)) ((1 0) (4 0))
    ((2 9) (0 6)) ((3 0) (2 8)) ((4 2) (0 1)) ((4 5) (0 4))
    ((4 5) (2 4)) ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization weakened ((0 5) (2 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 749)
  (parent 607)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 6)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((2 5) (3 4)) ((3 7) (4 0))
    ((3 9) (0 6)) ((4 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 750)
  (parent 608)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (5 0)) ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 751)
  (parent 609)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0))
    ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 752)
  (parent 610)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0)) ((2 9) (0 6))
    ((3 2) (0 1)) ((3 5) (0 4)) ((3 7) (4 0)) ((3 9) (2 4))
    ((4 0) (2 8)) ((4 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (4 0)) ((4 0) (2 8))
    ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 753)
  (parent 611)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((2 7) (6 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 2) (0 1)) ((4 5) (0 4))
    ((4 7) (5 0)) ((4 9) (3 0)) ((5 0) (4 8)) ((6 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((2 7) (6 0)) ((4 7) (5 0))
    ((5 0) (4 8)) ((6 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 754)
  (parent 612)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (8 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1))
    ((5 5) (0 4)) ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8))
    ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (8 0)) ((5 7) (6 0))
    ((6 0) (5 8)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 755)
  (parent 613)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 0) (2 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((5 7) (6 0)) ((6 0) (5 8))
    ((7 0) (2 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 756)
  (parent 613)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 2) (0 1)) ((4 5) (0 4))
    ((4 9) (3 0)) ((5 0) (2 8)) ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0)) ((5 0) (2 8))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 757)
  (parent 614)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 7) (8 0)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 2) (0 1)) ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((2 7) (8 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 2 proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 758)
  (parent 615)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1))
    ((5 5) (0 4)) ((5 7) (8 0)) ((5 9) (4 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((5 7) (8 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 5 proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 759)
  (parent 615)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (2 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 760)
  (parent 615)
  (unrealized (9 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 9) (3 0))
    ((5 0) (2 8)) ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((5 0) (2 8)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 761)
  (parent 616)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 7) (9 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)) ((9 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((2 7) (9 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 2 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 762)
  (parent 617)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 7) (9 0)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)) ((9 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((5 7) (9 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 5 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 763)
  (parent 617)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0))
    ((9 0) (2 8)) ((10 7) (9 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)) ((9 0) (2 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 764)
  (parent 617)
  (unrealized (10 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((0 5) (2 4)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 0) (2 8)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 7) (4 0)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 765)
  (parent 618)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 7) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((3 7) (5 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 766)
  (parent 619)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((1 0) (7 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 1) (3 4)) ((6 0) (3 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (7 0)) ((4 0) (3 0)) ((6 0) (3 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 767)
  (parent 620)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (7 0))
    ((5 1) (3 4)) ((6 0) (3 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((4 0) (7 0)) ((6 0) (3 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 768)
  (parent 621)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 0) (3 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((6 0) (3 8)) ((7 7) (6 0))
    ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 769)
  (parent 622)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (5 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 2) (0 1)) ((5 5) (0 4)) ((5 7) (6 0))
    ((5 9) (4 0)) ((6 0) (2 8)) ((6 0) (5 8)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((5 7) (6 0)) ((6 0) (2 8))
    ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 770)
  (parent 623)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 7) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1))
    ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 0) (2 8)))
  (leadsto ((1 0) (6 0)) ((2 7) (8 0)) ((3 0) (2 0)) ((6 7) (7 0))
    ((7 0) (6 8)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 2 proxy 8) request-2 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 771)
  (parent 624)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1)) ((6 5) (0 4))
    ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 0) (2 8))
    ((9 7) (8 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((6 7) (7 0)) ((7 0) (6 8))
    ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 772)
  (parent 624)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (2 8)) ((7 0) (6 8))
    ((8 7) (7 0)))
  (leadsto ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((7 0) (2 8))
    ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 7 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 773)
  (parent 625)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (2 8)))
  (leadsto ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 774)
  (parent 625)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (8 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (2 8)) ((7 0) (6 8))
    ((8 7) (7 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((3 0) (8 0)) ((7 0) (2 8))
    ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 7 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 775)
  (parent 626)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (8 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (2 8)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((3 0) (8 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 776)
  (parent 626)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (2 8)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (8 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((7 0) (2 8)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 7 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 777)
  (parent 627)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0))
    ((10 0) (2 8)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (8 0)) ((10 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 778)
  (parent 627)
  (unrealized (10 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((0 5) (2 6)) ((1 0) (2 0)) ((1 0) (4 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8)) ((4 5) (0 4))
    ((4 5) (2 4)) ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization weakened ((0 5) (2 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 779)
  (parent 638)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 6)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((2 5) (3 4)) ((3 2) (0 1)) ((3 7) (4 0))
    ((3 9) (0 6)) ((4 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 780)
  (parent 639)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (5 0)) ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 781)
  (parent 640)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((3 2) (0 1)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0))
    ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 782)
  (parent 641)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 5) (0 4)) ((3 7) (4 0)) ((3 9) (2 4))
    ((4 0) (2 8)) ((4 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (4 0)) ((4 0) (2 8))
    ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 783)
  (parent 642)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((2 2) (0 1))
    ((2 7) (6 0)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 5) (0 4))
    ((4 7) (5 0)) ((4 9) (3 0)) ((5 0) (4 8)) ((6 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((2 7) (6 0)) ((4 7) (5 0))
    ((5 0) (4 8)) ((6 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 784)
  (parent 643)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (8 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 5) (0 4)) ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8))
    ((7 0) (2 8)) ((8 7) (7 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (8 0)) ((5 7) (6 0))
    ((6 0) (5 8)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 785)
  (parent 644)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 0) (2 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((5 7) (6 0)) ((6 0) (5 8))
    ((7 0) (2 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 786)
  (parent 644)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 5) (0 4))
    ((4 9) (3 0)) ((5 0) (2 8)) ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0)) ((5 0) (2 8))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 787)
  (parent 645)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 2) (0 1)) ((2 7) (8 0)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((2 7) (8 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 2 proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 788)
  (parent 646)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 5) (0 4)) ((5 7) (8 0)) ((5 9) (4 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((5 7) (8 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 5 proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 789)
  (parent 646)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (2 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 790)
  (parent 646)
  (unrealized (9 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 5) (0 4)) ((4 9) (3 0))
    ((5 0) (2 8)) ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((5 0) (2 8)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 791)
  (parent 647)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 7) (9 0)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)) ((9 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((2 7) (9 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 2 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 792)
  (parent 648)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 7) (9 0)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)) ((9 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((5 7) (9 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 5 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 793)
  (parent 648)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0))
    ((9 0) (2 8)) ((10 7) (9 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)) ((9 0) (2 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 794)
  (parent 648)
  (unrealized (10 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 4)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (5 0)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 2) (0 1)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 795)
  (parent 649)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((0 5) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 5) (0 4)) ((5 7) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 796)
  (parent 650)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 7) (5 0))
    ((4 9) (0 6)) ((5 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((4 7) (5 0))
    ((5 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 797)
  (parent 651)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (5 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((2 0) (7 0)) ((3 5) (0 4))
    ((4 9) (0 6)) ((5 1) (4 4)) ((6 0) (4 8)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((2 0) (7 0))
    ((6 0) (4 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 798)
  (parent 652)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (5 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 0) (4 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 799)
  (parent 653)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 5) (0 4)) ((4 9) (3 0))
    ((5 0) (2 8)) ((5 0) (4 8)) ((6 2) (0 1)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0)) ((5 0) (2 8))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 800)
  (parent 654)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 7) (8 0)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 2) (0 1))
    ((7 7) (6 0)) ((8 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((2 7) (8 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 2 proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 801)
  (parent 655)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 7) (8 0)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 2) (0 1))
    ((7 7) (6 0)) ((8 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((5 7) (8 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 5 proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 802)
  (parent 655)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)) ((7 2) (0 1)) ((7 7) (6 0))
    ((8 0) (2 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 803)
  (parent 655)
  (unrealized (9 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (5 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 5) (0 4))
    ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (3 8)) ((6 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((5 7) (6 0))
    ((6 0) (3 8)) ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 804)
  (parent 656)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (8 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 0) (2 8))
    ((8 2) (0 1)) ((8 7) (7 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (8 0)) ((5 7) (6 0))
    ((6 0) (5 8)) ((7 0) (2 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 9 proxy 8) request-2 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 805)
  (parent 657)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 7) (8 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (5 0))
    ((7 0) (6 8)) ((8 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((3 7) (8 0))
    ((6 7) (7 0)) ((7 0) (6 8)) ((8 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 3 proxy 8) request-2 (8 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 806)
  (parent 657)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 0) (3 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((6 7) (7 0))
    ((7 0) (6 8)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (8 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 807)
  (parent 657)
  (unrealized (9 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((2 0) (8 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (3 8))
    ((7 0) (6 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0))
    ((7 0) (3 8)) ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 7 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 808)
  (parent 658)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 request-3 answer-1 cookie-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((2 0) (8 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 809)
  (parent 658)
  (unrealized (9 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (3 8)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((7 0) (3 8))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 7 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 810)
  (parent 659)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 request-3 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (8 0)) ((10 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 811)
  (parent 659)
  (unrealized (10 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (2 0)) ((1 0) (7 0))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 0) (3 8)) ((7 2) (0 1)) ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (7 0)) ((4 0) (3 0)) ((6 0) (3 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 812)
  (parent 660)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((0 5) (5 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (7 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 0) (3 8)) ((7 5) (0 4)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((6 0) (3 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 813)
  (parent 661)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 7) (7 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 1) (4 4)) ((7 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 7) (7 0)) ((5 0) (4 0))
    ((7 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 814)
  (parent 662)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (9 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 1) (4 4)) ((7 1) (6 0)) ((8 0) (4 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (9 0)) ((5 0) (4 0))
    ((8 0) (4 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 815)
  (parent 663)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((5 0) (9 0)) ((6 1) (4 4)) ((7 1) (6 0)) ((8 0) (4 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((5 0) (9 0))
    ((8 0) (4 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 10 5 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 816)
  (parent 663)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 1) (4 4)) ((7 1) (6 0)) ((8 0) (4 8)) ((9 7) (8 0))
    ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((8 0) (4 8))
    ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 817)
  (parent 663)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (2 8)) ((7 0) (6 8)) ((8 2) (0 1))
    ((8 7) (7 0)))
  (leadsto ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((7 0) (2 8))
    ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 7 server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 818)
  (parent 664)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)) ((8 2) (0 1)) ((8 7) (7 0))
    ((9 0) (2 8)))
  (leadsto ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (2 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 819)
  (parent 664)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 7) (8 0)) ((7 9) (6 0)) ((8 0) (3 8))
    ((8 0) (7 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((7 7) (8 0))
    ((8 0) (3 8)) ((8 0) (7 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 8 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 820)
  (parent 665)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie request-2 answer-1
      cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 7) (8 0)) ((7 9) (6 0)) ((8 0) (7 8))
    ((9 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((7 7) (8 0))
    ((8 0) (7 8)) ((9 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 821)
  (parent 665)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((2 0) (9 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((2 0) (9 0)) ((4 0) (3 0))
    ((8 0) (7 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 822)
  (parent 666)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (9 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((4 0) (9 0))
    ((8 0) (7 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 823)
  (parent 666)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8)) ((9 7) (8 0))
    ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((8 0) (7 8))
    ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 824)
  (parent 666)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((2 0) (9 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((2 0) (9 0))
    ((4 0) (3 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-2)
      (send
        (cat id-2 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3)))
  (label 825)
  (parent 676)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (9 0)) ((5 5) (0 4))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((4 0) (3 0))
    ((4 0) (9 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-2)
      (send (cat id-2 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-1 (pubk proxy)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3)))
  (label 826)
  (parent 676)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0))
    ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0))
    ((10 0) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-2)
      (send
        (cat id-2 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 827)
  (parent 676)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (9 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (7 0)) ((5 5) (0 4))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (9 0)) ((4 0) (3 0))
    ((4 0) (7 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-2)
      (send
        (cat id-2 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3)))
  (label 828)
  (parent 680)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((4 0) (7 0)) ((4 0) (9 0)) ((5 5) (0 4))
    ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (7 0))
    ((4 0) (9 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-2)
      (send (cat id-2 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-1 (pubk proxy)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3)))
  (label 829)
  (parent 680)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((4 0) (7 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0))
    ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (7 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0))
    ((10 0) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-2)
      (send
        (cat id-2 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1)))))
  (label 830)
  (parent 680)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (10 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8))
    ((10 7) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (10 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8))
    ((10 7) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 11 2 certauth 1)
    (enc proxy-2 (pubk proxy-2) (privk ca-2)) (10 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-2)
      (send
        (cat id-2 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3)))
  (label 831)
  (parent 684)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((4 0) (10 0)) ((5 5) (0 4)) ((5 9) (3 3))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8))
    ((10 7) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (10 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8))
    ((10 7) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 11 4 certauth 1)
    (enc proxy-2 (pubk proxy-2) (privk ca-2)) (10 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-2)
      (send (cat id-2 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-1 (pubk proxy)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3)))
  (label 832)
  (parent 684)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 proxy-1 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((8 0) (10 0)) ((9 0) (3 8))
    ((10 7) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((8 0) (10 0)) ((9 0) (3 8))
    ((10 7) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 11 8 certauth 1)
    (enc proxy-2 (pubk proxy-2) (privk ca-2)) (10 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-1))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-1))) (recv challenge-2)
      (send
        (cat id-2 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3)))
  (label 833)
  (parent 684)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca-0) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((0 5) (3 4)) ((1 0) (3 0)) ((2 0) (5 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 0) (3 8)) ((5 5) (0 4))
    ((5 7) (4 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (5 0)) ((4 0) (3 8)) ((5 7) (4 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 835)
  (parent 685)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (4 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 7) (5 0)) ((4 9) (0 6))
    ((5 0) (4 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (5 0)) ((5 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 836)
  (parent 686)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (4 0)) ((1 0) (7 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 0) (4 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (7 0)) ((3 0) (2 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 837)
  (parent 687)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((3 0) (7 0)) ((4 2) (0 1)) ((4 9) (0 6))
    ((5 1) (4 4)) ((6 0) (4 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (7 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 838)
  (parent 688)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 0) (4 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((6 0) (4 8)) ((7 7) (6 0))
    ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 839)
  (parent 689)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (3 0)) ((2 0) (5 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 5) (0 4)) ((5 7) (6 0))
    ((5 9) (4 0)) ((6 0) (3 8)) ((6 0) (5 8)))
  (leadsto ((1 0) (3 0)) ((2 0) (5 0)) ((5 7) (6 0)) ((6 0) (3 8))
    ((6 0) (5 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 840)
  (parent 690)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 7) (8 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 0) (3 8)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((3 7) (8 0)) ((6 7) (7 0))
    ((7 0) (6 8)) ((8 0) (3 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 3 proxy 8) request-2 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 841)
  (parent 691)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 0) (3 8))
    ((9 7) (8 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((6 7) (7 0)) ((7 0) (6 8))
    ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (8 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 842)
  (parent 691)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (3 8)) ((7 0) (6 8))
    ((8 7) (7 0)))
  (leadsto ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0)) ((7 0) (3 8))
    ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 7 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 843)
  (parent 692)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (3 8)))
  (leadsto ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 844)
  (parent 692)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (3 8)) ((7 0) (6 8))
    ((8 7) (7 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0)) ((7 0) (3 8))
    ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 7 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 845)
  (parent 693)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (3 8)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 846)
  (parent 693)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (3 8)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (8 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((7 0) (3 8)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 7 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 847)
  (parent 694)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0))
    ((10 0) (3 8)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (8 0)) ((10 0) (3 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 848)
  (parent 694)
  (unrealized (10 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (4 0)) ((1 0) (7 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 0) (4 8)) ((7 2) (0 1)) ((7 7) (6 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (7 0)) ((3 0) (2 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 849)
  (parent 695)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((0 5) (5 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (4 0)) ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 0) (4 8)) ((7 5) (0 4)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 850)
  (parent 696)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 7) (7 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (7 0))
    ((7 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 851)
  (parent 697)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((2 0) (9 0)) ((3 5) (0 4)) ((4 0) (3 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 1) (6 0)) ((8 0) (5 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (9 0)) ((4 0) (3 0))
    ((8 0) (5 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 852)
  (parent 698)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (9 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 1) (6 0)) ((8 0) (5 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (9 0))
    ((8 0) (5 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 10 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 853)
  (parent 698)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)) ((8 0) (5 8)) ((9 7) (8 0))
    ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((8 0) (5 8))
    ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 854)
  (parent 698)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (3 8)) ((7 0) (6 8)) ((8 2) (0 1))
    ((8 7) (7 0)))
  (leadsto ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0)) ((7 0) (3 8))
    ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 7 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 855)
  (parent 699)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)) ((8 2) (0 1)) ((8 7) (7 0))
    ((9 0) (3 8)))
  (leadsto ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 856)
  (parent 699)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 7) (8 0)) ((7 9) (6 0)) ((8 0) (4 8))
    ((8 0) (7 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)) ((7 7) (8 0))
    ((8 0) (4 8)) ((8 0) (7 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 8 server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 857)
  (parent 700)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie request-2 answer-1
      cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 7) (8 0)) ((7 9) (6 0)) ((8 0) (7 8))
    ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)) ((7 7) (8 0))
    ((8 0) (7 8)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 858)
  (parent 700)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((2 0) (9 0)) ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((2 0) (9 0)) ((3 0) (7 0))
    ((8 0) (7 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 859)
  (parent 701)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (7 0)) ((3 0) (9 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)) ((3 0) (9 0))
    ((8 0) (7 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 3 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 860)
  (parent 701)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8)) ((9 7) (8 0))
    ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)) ((8 0) (7 8))
    ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 861)
  (parent 701)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (5 0)) ((1 0) (7 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 0) (4 8)) ((7 2) (0 1)) ((7 7) (6 0)))
  (leadsto ((1 0) (7 0)) ((3 0) (2 0)) ((3 0) (4 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 862)
  (parent 702)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((0 5) (5 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 0) (4 0)) ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 0) (4 8)) ((7 5) (0 4)) ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (7 0)) ((6 0) (4 8))
    ((7 7) (6 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 863)
  (parent 703)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 7) (7 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 7) (7 0))
    ((7 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 864)
  (parent 704)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (9 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 1) (6 0)) ((8 0) (5 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (9 0)) ((4 0) (3 0)) ((4 0) (5 0))
    ((8 0) (5 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 865)
  (parent 705)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((4 0) (9 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 1) (6 0)) ((8 0) (5 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((4 0) (9 0))
    ((8 0) (5 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 10 4 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 866)
  (parent 705)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 1) (6 0)) ((8 0) (5 8)) ((9 7) (8 0))
    ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((8 0) (5 8))
    ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 867)
  (parent 705)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (8 0)) ((2 0) (3 0)) ((2 0) (6 0))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (3 8)) ((7 0) (6 8)) ((8 2) (0 1))
    ((8 7) (7 0)))
  (leadsto ((1 0) (8 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((7 0) (3 8))
    ((7 0) (6 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 9 7 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 868)
  (parent 706)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 request-3 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (8 0)) ((2 0) (3 0)) ((2 0) (6 0))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)) ((8 2) (0 1)) ((8 7) (7 0))
    ((9 0) (3 8)))
  (leadsto ((1 0) (8 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 869)
  (parent 706)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 7) (8 0)) ((7 9) (6 0)) ((8 0) (4 8))
    ((8 0) (7 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (7 0)) ((7 7) (8 0))
    ((8 0) (4 8)) ((8 0) (7 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 9 8 server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 870)
  (parent 707)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie request-2 answer-1
      cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 7) (8 0)) ((7 9) (6 0)) ((8 0) (7 8))
    ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (7 0)) ((7 7) (8 0))
    ((8 0) (7 8)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0))))
  (label 871)
  (parent 707)
  (unrealized (9 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (9 0))
    ((3 0) (4 0)) ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (9 0)) ((3 0) (4 0)) ((3 0) (7 0))
    ((8 0) (7 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 872)
  (parent 708)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (4 0))
    ((3 0) (7 0)) ((3 0) (9 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8))
    ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (7 0)) ((3 0) (9 0))
    ((8 0) (7 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 3 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 873)
  (parent 708)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8)) ((9 7) (8 0))
    ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (7 0)) ((8 0) (7 8))
    ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 874)
  (parent 708)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca ca-0 proxy ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (7 0)) ((1 0) (9 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 1) (4 4))
    ((7 1) (6 0)) ((8 0) (4 8)) ((9 2) (0 1)) ((9 7) (8 0)))
  (leadsto ((1 0) (9 0)) ((3 0) (2 0)) ((5 0) (4 0)) ((8 0) (4 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca-1))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 1 10 proxy 8) request-1
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 875)
  (parent 713)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data) (ca ca-0 proxy ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (9 1)) ((0 2) (4 3)) ((0 2) (9 3))
    ((0 3) (9 4)) ((0 5) (7 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 0) (9 0)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 1) (4 4))
    ((7 1) (6 0)) ((8 0) (4 8)) ((9 5) (0 4)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (9 0)) ((5 0) (4 0)) ((8 0) (4 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 3 10 proxy 8) request-0
    (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 876)
  (parent 713)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca ca-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (8 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 7) (9 0)) ((5 9) (0 6))
    ((6 0) (5 0)) ((7 1) (5 4)) ((8 1) (7 0)) ((9 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((5 7) (9 0)) ((6 0) (5 0))
    ((9 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (displaced 10 5 proxy 8) request-1
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-0 (cat answer-0 cookie))))
  (label 877)
  (parent 713)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 ca-1 proxy-0 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (deflistener (hash request challenge id))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (8 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6)) ((6 0) (5 0))
    ((7 1) (5 4)) ((8 1) (7 0)) ((9 0) (5 8)) ((10 7) (9 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((6 0) (5 0)) ((9 0) (5 8))
    ((10 7) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation state-passing-test (added-strand proxy 8) request-1 (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((recv (hash request challenge id))
      (send (hash request challenge id)))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-2))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 878)
  (parent 713)
  (unrealized (10 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie request-0 iv-0 answer-0 challenge
      id secret request-1 syskey-0 answer-1 cookie-0 challenge-0 id-0
      secret-0 request-2 data) (ca ca-0 proxy ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 0) (9 0)) ((2 0) (7 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 1) (3 4)) ((6 1) (5 0)) ((7 5) (0 4))
    ((7 9) (6 0)) ((8 0) (7 8)) ((9 2) (0 1)) ((9 7) (8 0)))
  (leadsto ((1 0) (9 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((8 0) (7 8))
    ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 10 proxy 8) request-2
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0 (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 879)
  (parent 722)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 data) (ca ca-0 proxy ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (8 1)) ((0 2) (4 3)) ((0 2) (8 3))
    ((0 3) (8 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (8 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 1) (4 4)) ((7 1) (6 0))
    ((8 5) (0 4)) ((8 7) (9 0)) ((8 9) (7 0)) ((9 0) (8 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (8 0)) ((5 0) (4 0)) ((8 7) (9 0))
    ((9 0) (8 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 8 proxy 8) request-2
    (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 880)
  (parent 722)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer cookie challenge id request-0 iv-0
      answer-0 challenge-0 id-0 secret request-1 syskey-0 answer-1
      cookie-0 challenge-1 id-1 secret-0 request-2 data)
    (ca ca-0 proxy ca-1 proxy-0 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-1) (cookie cookie-0)
    (syskey syskey-0) (proxy proxy) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-2))
  (precedes ((0 0) (4 1)) ((0 0) (8 1)) ((0 2) (4 3)) ((0 2) (8 3))
    ((0 3) (8 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (8 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 1) (4 4)) ((7 1) (6 0))
    ((8 5) (0 4)) ((8 9) (7 0)) ((9 0) (8 8)) ((10 7) (9 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (8 0)) ((5 0) (4 0)) ((9 0) (8 8))
    ((10 7) (9 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-1))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 secret
          (enc cookie-0
            (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 881)
  (parent 722)
  (unrealized (4 8) (10 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((1 0) (9 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 2) (0 1)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (7 0)) ((1 0) (9 0)) ((2 0) (5 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 882)
  (parent 725)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((2 0) (5 0)) ((2 0) (9 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 2) (0 1)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (7 0)) ((2 0) (5 0)) ((2 0) (9 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 883)
  (parent 725)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((4 0) (9 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 2) (0 1)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (7 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (9 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 4 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-1 (pubk proxy)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 884)
  (parent 725)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8)) ((7 2) (0 1))
    ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (leadsto ((1 0) (7 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-2)))))
  (label 885)
  (parent 725)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (9 0)) ((3 0) (6 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (7 0))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (9 0)) ((3 0) (6 0)) ((5 0) (4 0))
    ((6 7) (7 0)) ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 886)
  (parent 728)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (9 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (7 0))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (9 0)) ((5 0) (4 0))
    ((6 7) (7 0)) ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 3 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 887)
  (parent 728)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((5 0) (9 0)) ((6 5) (0 4)) ((6 7) (7 0))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((5 0) (9 0))
    ((6 7) (7 0)) ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 5 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 888)
  (parent 728)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((6 7) (7 0))
    ((7 0) (6 8)) ((8 0) (4 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-2)) (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-2)))))
  (label 889)
  (parent 728)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (7 0)) ((1 0) (9 0)) ((2 0) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (3 8)) ((9 2) (0 1)) ((9 7) (8 0)))
  (leadsto ((1 0) (7 0)) ((1 0) (9 0)) ((2 0) (5 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 10 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 890)
  (parent 730)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0))
    ((4 7) (9 0)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0)) ((4 7) (9 0))
    ((5 0) (4 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 4 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 891)
  (parent 730)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (9 0))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0)) ((5 0) (4 0))
    ((6 7) (9 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 6 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 892)
  (parent 730)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (ca proxy ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)) ((10 7) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((3 0) (6 0)) ((5 0) (4 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)) ((10 7) (9 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-2)
      (send
        (cat id-2 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3)))
  (label 893)
  (parent 730)
  (unrealized (10 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (9 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (3 8)) ((9 2) (0 1)) ((9 7) (8 0)))
  (leadsto ((1 0) (9 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((4 0) (3 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 10 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 894)
  (parent 732)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0))
    ((4 7) (9 0)) ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0)) ((4 7) (9 0))
    ((5 0) (4 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 4 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 895)
  (parent 732)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (9 0))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0)) ((5 0) (4 0))
    ((6 7) (9 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 6 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 896)
  (parent 732)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (ca proxy ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)) ((10 7) (9 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((3 0) (8 0)) ((5 0) (4 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)) ((10 7) (9 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-2)
      (send
        (cat id-2 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3)))
  (label 897)
  (parent 732)
  (unrealized (10 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (9 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((4 0) (7 0)) ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (3 8)) ((9 2) (0 1)) ((9 7) (8 0)))
  (leadsto ((1 0) (9 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (7 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy-0) (privk ca-1))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 10 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 898)
  (parent 734)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-0) (ca ca-1) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 7) (9 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((5 0) (8 0)) ((6 5) (0 4))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((4 7) (9 0)) ((5 0) (4 0))
    ((5 0) (8 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 4 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 899)
  (parent 734)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((5 0) (8 0)) ((6 5) (0 4)) ((6 7) (9 0))
    ((6 9) (4 3)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((5 0) (8 0))
    ((6 7) (9 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 6 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 900)
  (parent 734)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (ca proxy ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((5 0) (8 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)) ((10 7) (9 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((5 0) (8 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (4 8)) ((10 7) (9 0)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-2)
      (send
        (cat id-2 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3)))
  (label 901)
  (parent 734)
  (unrealized (10 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-1) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-1) (ca ca-2))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (5 3)) ((0 3) (5 4))
    ((1 0) (10 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 5) (0 4)) ((5 9) (3 3)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)) ((9 0) (3 8)) ((10 2) (0 1)) ((10 7) (9 0)))
  (leadsto ((1 0) (10 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (3 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy-1) (privk ca-2))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 11 proxy 8) request-3
    (10 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (send (enc secret (pubk proxy-1)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-2))))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-0))))
      (recv (enc secret (pubk proxy-1)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-1 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 902)
  (parent 736)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge) (secret secret) (id id) (syskey syskey)
        (proxy proxy-1) (ca ca-2) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 7) (10 0))
    ((4 9) (0 6)) ((5 0) (4 0)) ((6 5) (0 4)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((4 7) (10 0)) ((5 0) (4 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 11 4 proxy 8) request-3
    (10 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-2))))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 903)
  (parent 736)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 proxy-1 ca-2 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy-0)
    (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-1) (ca ca-2))
  (defstrand certauth 1 (proxy proxy-1) (ca ca-2))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (6 3)) ((0 3) (6 4))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 0) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 5) (0 4)) ((6 7) (10 0)) ((6 9) (4 3))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((3 0) (6 0)) ((5 0) (4 0)) ((6 7) (10 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 11 6 proxy 8) request-3
    (10 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca)))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-1 (pubk proxy-1) (privk ca-2))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-1)
          (enc proxy-1 (pubk proxy-1) (privk ca-2))))
      (recv (enc secret-0 (pubk proxy-1)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-1 (pubk proxy-1) (privk ca-2))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 904)
  (parent 736)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((challenge challenge-0) (secret secret) (id id-0) (syskey syskey)
        (proxy proxy-0) (ca ca) (request request) (iv iv)
        (answer answer) (cookie cookie-0))))
  (origs (challenge-0 (0 0)) (secret (0 2))))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((0 5) (2 8))
    ((1 0) (2 0)) ((2 2) (0 1)) ((2 7) (3 0)) ((2 9) (0 6))
    ((3 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((2 7) (3 0)) ((3 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (3 0)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 906)
  (parent 737)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((0 5) (2 8))
    ((1 0) (2 0)) ((1 0) (4 0)) ((2 2) (0 1)) ((2 9) (0 6))
    ((3 0) (2 8)) ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (2 7)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 907)
  (parent 738)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((0 5) (2 8))
    ((1 0) (2 0)) ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8))
    ((4 7) (3 0)) ((5 0) (4 0)))
  (leadsto ((1 0) (2 0)) ((3 0) (2 8)) ((4 7) (3 0)) ((5 0) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (2 7)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 908)
  (parent 739)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((0 5) (2 8))
    ((1 0) (2 0)) ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 8))
    ((4 2) (0 1)) ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (2 7)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 909)
  (parent 740)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((0 5) (4 0))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (4 0))
    ((3 9) (0 6)) ((4 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (3 7)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 910)
  (parent 741)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((0 5) (3 7))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0))
    ((3 9) (0 6)) ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (3 6)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 911)
  (parent 742)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((0 5) (3 7))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0))
    ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (3 6)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 912)
  (parent 743)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer request-0 iv-0 answer-0 cookie
      challenge id-0 secret request-1 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 2) (2 3)) ((0 3) (2 4)) ((0 5) (2 7))
    ((1 0) (5 0)) ((2 9) (0 6)) ((3 0) (2 0)) ((4 0) (2 8))
    ((5 2) (0 1)) ((5 7) (4 0)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (2 6)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge id-0)))
      (send (enc challenge (hash secret challenge id-0)))
      (recv request-1) (init request-1)))
  (label 913)
  (parent 744)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((0 5) (3 7))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 7) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((3 7) (5 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (3 6)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 914)
  (parent 745)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((0 5) (3 6))
    ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (6 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 915)
  (parent 746)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((0 5) (3 6))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((4 0) (6 0)) ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1)))
  (label 916)
  (parent 747)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (id syskey request iv answer challenge id-0 request-0 iv-0 answer-0
      cookie challenge-0 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge id) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge id) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 2) (3 3)) ((0 3) (3 4)) ((0 5) (3 6))
    ((1 2) (0 1)) ((2 0) (1 0)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 0) (3 8)) ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig id request)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send id)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request id id)))
      (recv (enc id (hash request id id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request id id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv id)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request id id)))
      (send (enc id (hash request id id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request id id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-0 id-1)))
      (send (enc challenge-0 (hash secret challenge-0 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 917)
  (parent 748)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((0 5) (2 6)) ((1 0) (2 0))
    ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 8)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization weakened ((4 5) (2 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 918)
  (parent 749)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((0 5) (3 6)) ((1 0) (2 0))
    ((1 0) (3 0)) ((2 2) (0 1)) ((2 5) (0 4)) ((3 7) (4 0))
    ((3 9) (0 6)) ((4 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization weakened ((2 5) (3 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 919)
  (parent 750)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 6)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (5 0)) ((2 2) (0 1)) ((2 5) (0 4)) ((2 5) (3 4))
    ((3 9) (0 6)) ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 920)
  (parent 751)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 6)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((2 5) (3 4)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0))
    ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 921)
  (parent 752)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0)) ((2 9) (0 6))
    ((3 2) (0 1)) ((3 5) (0 4)) ((3 7) (4 0)) ((4 0) (2 4))
    ((4 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (4 0)) ((4 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1)) ((tran request-1 (cat answer-0 cookie))))
  (label 922)
  (parent 753)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0)) ((2 7) (5 0))
    ((2 9) (0 6)) ((3 2) (0 1)) ((3 5) (0 4)) ((3 7) (4 0))
    ((3 9) (2 4)) ((4 0) (3 8)) ((5 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((2 7) (5 0)) ((3 7) (4 0))
    ((4 0) (3 8)) ((5 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 923)
  (parent 754)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (7 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 2) (0 1)) ((4 5) (0 4))
    ((4 7) (5 0)) ((4 9) (3 0)) ((5 0) (4 8)) ((6 0) (2 8))
    ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (7 0)) ((4 7) (5 0))
    ((5 0) (4 8)) ((6 0) (2 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 924)
  (parent 755)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 7) (5 0))
    ((4 9) (3 0)) ((5 0) (4 8)) ((6 0) (2 8)) ((7 7) (6 0))
    ((8 0) (7 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((4 7) (5 0)) ((5 0) (4 8))
    ((6 0) (2 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 925)
  (parent 756)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0))
    ((2 9) (0 6)) ((3 2) (0 1)) ((3 5) (0 4)) ((3 9) (2 4))
    ((4 0) (2 8)) ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0)) ((4 0) (2 8))
    ((4 0) (3 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 926)
  (parent 757)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0))
    ((2 7) (7 0)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 2) (0 1))
    ((4 5) (0 4)) ((4 9) (3 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0)) ((2 7) (7 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 927)
  (parent 758)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 2) (0 1)) ((4 5) (0 4))
    ((4 7) (7 0)) ((4 9) (3 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0)) ((4 7) (7 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 928)
  (parent 759)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((1 0) (9 0)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 2) (0 1)) ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((1 0) (9 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-1 (pubk proxy)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 929)
  (parent 760)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (2 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 930)
  (parent 760)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0)) ((2 9) (0 6))
    ((3 2) (0 1)) ((3 5) (0 4)) ((3 9) (2 4)) ((4 0) (2 8))
    ((4 0) (3 8)) ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((4 0) (2 8)) ((4 0) (3 8))
    ((5 7) (4 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 931)
  (parent 761)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((2 7) (8 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 2) (0 1)) ((4 5) (0 4))
    ((4 9) (3 0)) ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (6 0))
    ((8 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((2 7) (8 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 932)
  (parent 762)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 2) (0 1)) ((4 5) (0 4)) ((4 7) (8 0))
    ((4 9) (3 0)) ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (6 0))
    ((8 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((4 7) (8 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 933)
  (parent 763)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (10 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)) ((9 0) (2 8)) ((10 7) (9 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (10 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (2 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 11 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (10 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-1 (pubk proxy)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 934)
  (parent 764)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 1) (2 4)) ((4 1) (3 0)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0))
    ((8 0) (10 0)) ((9 0) (2 8)) ((10 7) (9 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)) ((8 0) (10 0)) ((9 0) (2 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 11 8 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (10 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 935)
  (parent 764)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((0 5) (2 6)) ((1 0) (5 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 0) (2 8)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 5) (2 4)) ((5 7) (4 0)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((4 0) (2 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation generalization weakened ((0 5) (2 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 937)
  (parent 765)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 6)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((2 5) (3 4)) ((3 7) (5 0)) ((3 9) (0 6))
    ((4 0) (3 0)) ((5 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((3 7) (5 0)) ((4 0) (3 0)) ((5 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 938)
  (parent 766)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 4)) ((1 0) (2 0)) ((1 0) (6 0))
    ((2 2) (0 1)) ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0))
    ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 939)
  (parent 767)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (6 0))
    ((5 0) (3 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((4 0) (6 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 940)
  (parent 768)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 4)) ((1 0) (2 0)) ((2 2) (0 1))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (2 0)) ((4 0) (3 0)) ((5 0) (3 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 941)
  (parent 769)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (4 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 2) (0 1)) ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (2 4))
    ((5 0) (2 8)) ((5 0) (4 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (5 0)) ((5 0) (2 8))
    ((5 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 942)
  (parent 770)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (5 0)) ((2 7) (7 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 0) (2 8)))
  (leadsto ((1 0) (5 0)) ((2 7) (7 0)) ((3 0) (2 0)) ((5 7) (6 0))
    ((6 0) (5 8)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 943)
  (parent 771)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((1 0) (9 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1))
    ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 0) (2 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (6 0)) ((1 0) (9 0)) ((3 0) (2 0)) ((6 7) (7 0))
    ((7 0) (6 8)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 944)
  (parent 772)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (9 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1))
    ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 0) (2 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((3 0) (9 0)) ((6 7) (7 0))
    ((7 0) (6 8)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 3 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 945)
  (parent 772)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1)) ((6 5) (0 4))
    ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 0) (2 8))
    ((9 7) (8 0)) ((10 0) (9 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((6 7) (7 0)) ((7 0) (6 8))
    ((8 0) (2 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 946)
  (parent 772)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (5 0)) ((1 0) (7 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (2 8)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (5 0)) ((1 0) (7 0)) ((3 0) (2 0)) ((6 0) (2 8))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 947)
  (parent 773)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 7) (9 0))
    ((2 9) (0 6)) ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0))
    ((6 2) (0 1)) ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (2 8)))
  (leadsto ((1 0) (6 0)) ((1 0) (8 0)) ((2 7) (9 0)) ((3 0) (2 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 2 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 948)
  (parent 774)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1))
    ((6 5) (0 4)) ((6 7) (9 0)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (2 8)))
  (leadsto ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((6 7) (9 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 6 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 949)
  (parent 774)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (2 8)) ((10 7) (9 0)))
  (leadsto ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (2 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 950)
  (parent 774)
  (unrealized (10 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (5 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (7 0)) ((4 1) (2 4)) ((5 2) (0 1)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (2 8)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((3 0) (7 0)) ((6 0) (2 8))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 951)
  (parent 775)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 7) (9 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((3 0) (8 0)) ((4 1) (2 4)) ((5 1) (4 0))
    ((6 2) (0 1)) ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (2 8)))
  (leadsto ((1 0) (6 0)) ((2 7) (9 0)) ((3 0) (2 0)) ((3 0) (8 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 2 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 952)
  (parent 776)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (8 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1))
    ((6 5) (0 4)) ((6 7) (9 0)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (2 8)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((3 0) (8 0)) ((6 7) (9 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 6 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 953)
  (parent 776)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((3 0) (8 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (2 8)) ((10 7) (9 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((3 0) (8 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (2 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 954)
  (parent 776)
  (unrealized (10 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (5 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 2) (0 1)) ((5 5) (0 4)) ((5 9) (4 0))
    ((6 0) (2 8)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((1 0) (5 0)) ((3 0) (2 0)) ((6 0) (2 8)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 955)
  (parent 777)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 7) (10 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (8 0)) ((10 0) (2 8)))
  (leadsto ((1 0) (6 0)) ((2 7) (10 0)) ((3 0) (2 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 11 2 proxy 8) request-3
    (10 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 956)
  (parent 778)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((2 9) (0 6)) ((3 0) (2 0))
    ((4 1) (2 4)) ((5 1) (4 0)) ((6 2) (0 1)) ((6 5) (0 4))
    ((6 7) (10 0)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (8 0)) ((10 0) (2 8)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((6 7) (10 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 11 6 proxy 8) request-3
    (10 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 957)
  (parent 778)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 3) (4 4)) ((0 5) (2 6)) ((1 0) (2 0))
    ((1 0) (4 0)) ((2 2) (0 1)) ((2 9) (0 6)) ((3 0) (2 8))
    ((4 2) (2 4)) ((4 5) (0 4)) ((4 7) (3 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((3 0) (2 8)) ((4 7) (3 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization weakened ((4 5) (2 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 959)
  (parent 779)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 3) (3 4)) ((0 5) (3 6)) ((1 0) (2 0))
    ((1 0) (3 0)) ((2 2) (3 4)) ((2 5) (0 4)) ((3 2) (0 1))
    ((3 7) (4 0)) ((3 9) (0 6)) ((4 0) (3 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (4 0)) ((4 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization weakened ((2 5) (3 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 960)
  (parent 780)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 6)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (5 0)) ((2 5) (0 4)) ((2 5) (3 4)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 961)
  (parent 781)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 6)) ((1 0) (2 0)) ((1 0) (3 0))
    ((2 5) (0 4)) ((2 5) (3 4)) ((3 2) (0 1)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((4 0) (3 8)) ((5 7) (4 0))
    ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 962)
  (parent 782)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 5) (0 4)) ((3 7) (4 0)) ((4 0) (2 4))
    ((4 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((3 7) (4 0)) ((4 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 8))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1)) ((tran request-1 (cat answer-0 cookie))))
  (label 963)
  (parent 783)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0)) ((2 2) (0 1))
    ((2 7) (5 0)) ((2 9) (0 6)) ((3 5) (0 4)) ((3 7) (4 0))
    ((3 9) (2 4)) ((4 0) (3 8)) ((5 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((2 7) (5 0)) ((3 7) (4 0))
    ((4 0) (3 8)) ((5 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 964)
  (parent 784)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (7 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 5) (0 4))
    ((4 7) (5 0)) ((4 9) (3 0)) ((5 0) (4 8)) ((6 0) (2 8))
    ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (7 0)) ((4 7) (5 0))
    ((5 0) (4 8)) ((6 0) (2 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 965)
  (parent 785)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 5) (0 4)) ((4 7) (5 0))
    ((4 9) (3 0)) ((5 0) (4 8)) ((6 0) (2 8)) ((7 7) (6 0))
    ((8 0) (7 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((4 7) (5 0)) ((5 0) (4 8))
    ((6 0) (2 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 966)
  (parent 786)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 5) (0 4)) ((3 9) (2 4))
    ((4 0) (2 8)) ((4 0) (3 8)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0)) ((4 0) (2 8))
    ((4 0) (3 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 967)
  (parent 787)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0))
    ((2 2) (0 1)) ((2 7) (7 0)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 5) (0 4)) ((4 9) (3 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0)) ((2 7) (7 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 968)
  (parent 788)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 5) (0 4))
    ((4 7) (7 0)) ((4 9) (3 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0)) ((4 7) (7 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 969)
  (parent 789)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((1 0) (9 0)) ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((1 0) (9 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-1 (pubk proxy)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 970)
  (parent 790)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (2 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 971)
  (parent 790)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 5) (0 4)) ((3 9) (2 4)) ((4 0) (2 8))
    ((4 0) (3 8)) ((5 7) (4 0)) ((6 0) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((4 0) (2 8)) ((4 0) (3 8))
    ((5 7) (4 0)) ((6 0) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 972)
  (parent 791)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((2 2) (0 1))
    ((2 7) (8 0)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 5) (0 4))
    ((4 9) (3 0)) ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (6 0))
    ((8 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((2 7) (8 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 973)
  (parent 792)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 5) (0 4)) ((4 7) (8 0))
    ((4 9) (3 0)) ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (6 0))
    ((8 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((4 7) (8 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)) ((8 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 974)
  (parent 793)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (10 0))
    ((2 2) (0 1)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)) ((9 0) (2 8)) ((10 7) (9 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (10 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (2 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 11 1 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (10 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-1 (pubk proxy)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 975)
  (parent 794)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((2 2) (0 1))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0))
    ((8 0) (10 0)) ((9 0) (2 8)) ((10 7) (9 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)) ((8 0) (10 0)) ((9 0) (2 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 11 8 certauth 1)
    (enc proxy-1 (pubk proxy-1) (privk ca-1)) (10 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 976)
  (parent 794)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 6)) ((1 0) (2 0)) ((1 0) (3 0))
    ((1 0) (5 0)) ((2 5) (0 4)) ((2 5) (3 4)) ((3 9) (0 6))
    ((4 0) (3 8)) ((5 2) (0 1)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 978)
  (parent 795)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((0 5) (3 6)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (5 0)) ((3 9) (0 6)) ((4 0) (3 8))
    ((5 5) (0 4)) ((5 5) (3 4)) ((5 7) (4 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((4 0) (3 8))
    ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 979)
  (parent 796)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (4 6)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((3 5) (4 4))
    ((4 7) (5 0)) ((4 9) (0 6)) ((5 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((4 7) (5 0))
    ((5 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization weakened ((0 5) (4 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 980)
  (parent 797)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((2 0) (6 0)) ((3 5) (0 4))
    ((4 9) (0 6)) ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((2 0) (6 0))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 981)
  (parent 798)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (4 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 982)
  (parent 799)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (3 4)) ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0))
    ((2 9) (0 6)) ((3 5) (0 4)) ((3 9) (2 4)) ((4 0) (2 8))
    ((4 0) (3 8)) ((5 2) (0 1)) ((5 7) (4 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (3 0)) ((1 0) (5 0)) ((4 0) (2 8))
    ((4 0) (3 8)) ((5 7) (4 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 983)
  (parent 800)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0))
    ((2 7) (7 0)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 5) (0 4))
    ((4 9) (3 0)) ((5 0) (4 8)) ((6 2) (0 1)) ((6 7) (5 0))
    ((7 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0)) ((2 7) (7 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 984)
  (parent 801)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 5) (0 4)) ((4 7) (7 0))
    ((4 9) (3 0)) ((5 0) (4 8)) ((6 2) (0 1)) ((6 7) (5 0))
    ((7 0) (2 8)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (6 0)) ((4 7) (7 0))
    ((5 0) (4 8)) ((6 7) (5 0)) ((7 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 985)
  (parent 802)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((1 0) (9 0)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 2) (0 1))
    ((7 7) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((1 0) (9 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-1 (pubk proxy)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 986)
  (parent 803)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)) ((7 2) (0 1)) ((7 7) (6 0))
    ((8 0) (2 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 987)
  (parent 803)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie data)
    (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (4 0)) ((3 9) (0 6)) ((4 5) (0 4)) ((4 7) (5 0))
    ((4 9) (3 4)) ((5 0) (3 8)) ((5 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (4 0)) ((4 7) (5 0))
    ((5 0) (3 8)) ((5 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 988)
  (parent 804)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (7 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 5) (0 4)) ((4 7) (5 0))
    ((4 9) (3 0)) ((5 0) (4 8)) ((6 0) (2 8)) ((7 2) (0 1))
    ((7 7) (6 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (4 0)) ((1 0) (7 0)) ((4 7) (5 0))
    ((5 0) (4 8)) ((6 0) (2 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation generalization deleted (3 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 989)
  (parent 805)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (5 0)) ((3 7) (7 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 5) (0 4)) ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8))
    ((7 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((3 7) (7 0))
    ((5 7) (6 0)) ((6 0) (5 8)) ((7 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 990)
  (parent 806)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((2 0) (9 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (5 0))
    ((7 0) (6 8)) ((8 0) (3 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((2 0) (9 0))
    ((6 7) (7 0)) ((7 0) (6 8)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 991)
  (parent 807)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 0) (3 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((6 7) (7 0))
    ((7 0) (6 8)) ((8 0) (3 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-0)) (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 992)
  (parent 807)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (5 0)) ((2 0) (7 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (3 8)) ((6 0) (5 8))
    ((7 7) (6 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((6 0) (3 8)) ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 993)
  (parent 808)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0))
    ((1 0) (9 0)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0))
    ((5 5) (0 4)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (2 8)) ((9 2) (0 1)) ((9 7) (8 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (7 0)) ((1 0) (9 0))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 10 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-1 (pubk proxy)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 994)
  (parent 809)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((2 0) (8 0)) ((3 7) (9 0)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4)) ((6 9) (5 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0))
    ((3 7) (9 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 3 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 995)
  (parent 809)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data) (proxy ca name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((2 0) (8 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 5) (0 4)) ((6 7) (9 0)) ((6 9) (5 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0))
    ((6 7) (9 0)) ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 6 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 996)
  (parent 809)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 challenge-2 id-2 secret-1
      request-3 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-2) (id id-2) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((2 0) (8 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (3 8)) ((10 7) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (3 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-2)
      (send
        (cat id-2 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-2 (hash secret-1 challenge-2 id-2)))
      (send (enc challenge-2 (hash secret-1 challenge-2 id-2)))
      (recv request-3) (init request-3)))
  (label 997)
  (parent 809)
  (unrealized (10 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (5 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (3 8)) ((6 0) (5 8)) ((7 7) (6 0))
    ((8 0) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (5 0)) ((6 0) (3 8))
    ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0)))))
  (label 998)
  (parent 810)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy-0) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (10 0))
    ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0))
    ((9 0) (2 8)) ((10 2) (0 1)) ((10 7) (9 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (5 0)) ((1 0) (10 0)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)) ((9 0) (2 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy-0) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 11 proxy 8) request-3
    (10 0))
  (traces
    ((send challenge)
      (recv
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (send (enc secret (pubk proxy-0)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 999)
  (parent 811)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 7) (10 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((3 7) (10 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 11 3 proxy 8) request-3
    (10 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 1000)
  (parent 811)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 answer-1 cookie-0 data)
    (proxy ca proxy-0 ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-0))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 7) (10 0)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (6 0)) ((6 7) (10 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 11 6 proxy 8) request-3
    (10 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-0))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 1001)
  (parent 811)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (3 1)) ((0 2) (2 3)) ((0 2) (3 3))
    ((0 3) (2 4)) ((0 5) (3 4)) ((1 0) (2 0)) ((1 0) (6 0))
    ((2 5) (0 4)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 2) (0 1)) ((6 7) (5 0)))
  (leadsto ((1 0) (2 0)) ((1 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 1003)
  (parent 812)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((0 5) (3 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (6 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 5) (0 4)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (6 0)) ((4 0) (3 0)) ((5 0) (3 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 1004)
  (parent 813)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 7) (6 0)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((4 7) (6 0)) ((5 0) (4 0))
    ((6 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 1005)
  (parent 814)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((2 0) (8 0)) ((3 5) (0 4)) ((4 9) (0 6))
    ((5 0) (4 0)) ((6 1) (4 4)) ((7 0) (4 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((2 0) (8 0)) ((5 0) (4 0))
    ((7 0) (4 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 1006)
  (parent 815)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((5 0) (8 0)) ((6 1) (4 4)) ((7 0) (4 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((5 0) (8 0))
    ((7 0) (4 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 1007)
  (parent 816)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 5) (0 4)) ((4 9) (0 6)) ((5 0) (4 0))
    ((6 1) (4 4)) ((7 0) (4 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (3 0)) ((5 0) (4 0)) ((7 0) (4 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 1008)
  (parent 817)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (5 1)) ((0 2) (2 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (5 0)) ((1 0) (7 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 5) (0 4)) ((5 9) (4 0))
    ((6 0) (2 8)) ((6 0) (5 8)) ((7 2) (0 1)) ((7 7) (6 0)))
  (leadsto ((1 0) (5 0)) ((1 0) (7 0)) ((3 0) (2 0)) ((6 0) (2 8))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 1009)
  (parent 818)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 7) (9 0))
    ((2 9) (0 6)) ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 2) (0 1))
    ((8 7) (7 0)) ((9 0) (2 8)))
  (leadsto ((1 0) (6 0)) ((1 0) (8 0)) ((2 7) (9 0)) ((3 0) (2 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 2 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 1010)
  (parent 819)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 7) (9 0)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 2) (0 1))
    ((8 7) (7 0)) ((9 0) (2 8)))
  (leadsto ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((6 7) (9 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (2 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 6 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 1011)
  (parent 819)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((1 0) (8 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)) ((8 2) (0 1)) ((8 7) (7 0))
    ((9 0) (2 8)) ((10 7) (9 0)))
  (leadsto ((1 0) (6 0)) ((1 0) (8 0)) ((3 0) (2 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (2 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 1012)
  (parent 819)
  (unrealized (10 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (6 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4)) ((6 5) (0 4))
    ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (3 8)) ((7 0) (6 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (6 0)) ((4 0) (3 0)) ((6 7) (7 0))
    ((7 0) (3 8)) ((7 0) (6 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 1013)
  (parent 820)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (6 1)) ((0 2) (2 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (6 0)) ((1 0) (9 0)) ((2 9) (0 6))
    ((3 0) (2 0)) ((4 1) (2 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 0) (2 8))
    ((9 2) (0 1)) ((9 7) (8 0)))
  (leadsto ((1 0) (6 0)) ((1 0) (9 0)) ((3 0) (2 0)) ((6 7) (7 0))
    ((7 0) (6 8)) ((8 0) (2 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 10 proxy 8) request-2
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 1014)
  (parent 821)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 7) (9 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 7) (8 0)) ((7 9) (6 0))
    ((8 0) (7 8)) ((9 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((3 7) (9 0)) ((4 0) (3 0))
    ((7 7) (8 0)) ((8 0) (7 8)) ((9 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 3 proxy 8) request-2
    (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 1015)
  (parent 821)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 7) (8 0)) ((7 9) (6 0)) ((8 0) (7 8))
    ((9 0) (3 8)) ((10 7) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((7 7) (8 0))
    ((8 0) (7 8)) ((9 0) (3 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (9 0))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 1016)
  (parent 821)
  (unrealized (10 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((2 0) (9 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (3 8))
    ((8 0) (7 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((2 0) (9 0)) ((4 0) (3 0))
    ((8 0) (3 8)) ((8 0) (7 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 8 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 1017)
  (parent 822)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 request-3 answer-1 cookie-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((2 0) (9 0)) ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8))
    ((9 7) (8 0)) ((10 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((2 0) (9 0)) ((4 0) (3 0))
    ((8 0) (7 8)) ((9 7) (8 0)) ((10 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 1018)
  (parent 822)
  (unrealized (10 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (9 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (3 8))
    ((8 0) (7 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((4 0) (9 0))
    ((8 0) (3 8)) ((8 0) (7 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 8 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 1019)
  (parent 823)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 request-3 answer-1 cookie-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((4 0) (9 0)) ((5 1) (3 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8))
    ((9 7) (8 0)) ((10 0) (3 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((4 0) (9 0))
    ((8 0) (7 8)) ((9 7) (8 0)) ((10 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 1020)
  (parent 823)
  (unrealized (10 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (7 1)) ((0 2) (3 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (7 0))
    ((3 9) (0 6)) ((4 0) (3 0)) ((5 1) (3 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (3 8)) ((8 0) (7 8))
    ((9 7) (8 0)) ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (7 0)) ((4 0) (3 0)) ((8 0) (3 8))
    ((8 0) (7 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 11 8 server 1)
    (cat answer-1 cookie-0) (3 8))
  (traces
    ((send challenge-0)
      (recv
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send
        (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0)))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 1021)
  (parent 824)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer request iv-0 answer-0 cookie challenge id secret
      request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge) (id id) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((0 5) (3 6)) ((1 0) (3 0)) ((2 0) (5 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 0) (3 8)) ((5 5) (0 4))
    ((5 5) (3 4)) ((5 7) (4 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (5 0)) ((4 0) (3 8)) ((5 7) (4 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation generalization weakened ((0 5) (3 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request)
      (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0)))
  (label 1023)
  (parent 835)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (4 6)) ((1 0) (4 0)) ((2 5) (0 4))
    ((2 5) (4 4)) ((3 0) (2 0)) ((4 2) (0 1)) ((4 7) (5 0))
    ((4 9) (0 6)) ((5 0) (4 8)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((4 7) (5 0)) ((5 0) (4 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation generalization weakened ((0 5) (4 4)))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 1024)
  (parent 836)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (4 4)) ((1 0) (4 0)) ((1 0) (6 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 1025)
  (parent 837)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (4 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((3 0) (6 0)) ((4 2) (0 1)) ((4 9) (0 6))
    ((5 0) (4 8)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 1026)
  (parent 838)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (4 4)) ((1 0) (4 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((4 2) (0 1)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 7) (5 0)) ((7 0) (6 0)))
  (leadsto ((1 0) (4 0)) ((3 0) (2 0)) ((5 0) (4 8)) ((6 7) (5 0))
    ((7 0) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 1027)
  (parent 839)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (4 1)) ((0 2) (3 3)) ((0 2) (4 3))
    ((0 3) (4 4)) ((1 0) (3 0)) ((2 0) (4 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 5) (0 4)) ((4 7) (5 0)) ((4 9) (3 4))
    ((5 0) (3 8)) ((5 0) (4 8)))
  (leadsto ((1 0) (3 0)) ((2 0) (4 0)) ((4 7) (5 0)) ((5 0) (3 8))
    ((5 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 1028)
  (parent 840)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (3 0)) ((2 0) (5 0)) ((3 2) (0 1))
    ((3 7) (7 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 5) (0 4))
    ((5 7) (6 0)) ((5 9) (4 0)) ((6 0) (5 8)) ((7 0) (3 8)))
  (leadsto ((1 0) (3 0)) ((2 0) (5 0)) ((3 7) (7 0)) ((5 7) (6 0))
    ((6 0) (5 8)) ((7 0) (3 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 1029)
  (parent 841)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((1 0) (9 0)) ((2 0) (6 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 0) (3 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (3 0)) ((1 0) (9 0)) ((2 0) (6 0)) ((6 7) (7 0))
    ((7 0) (6 8)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 1 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 1030)
  (parent 842)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((2 0) (9 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 0) (3 8)) ((9 7) (8 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((2 0) (9 0)) ((6 7) (7 0))
    ((7 0) (6 8)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 2 certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 1031)
  (parent 842)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 0) (3 8))
    ((9 7) (8 0)) ((10 0) (9 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((6 7) (7 0)) ((7 0) (6 8))
    ((8 0) (3 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand certauth 1)
    (enc proxy-0 (pubk proxy-0) (privk ca-1)) (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 1032)
  (parent 842)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (3 0)) ((1 0) (7 0)) ((2 0) (5 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (3 8)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (3 0)) ((1 0) (7 0)) ((2 0) (5 0)) ((6 0) (3 8))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 1033)
  (parent 843)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0))
    ((3 2) (0 1)) ((3 7) (9 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (3 8)))
  (leadsto ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0)) ((3 7) (9 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 3 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 1034)
  (parent 844)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 7) (9 0)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (3 8)))
  (leadsto ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0)) ((6 7) (9 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 6 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 1035)
  (parent 844)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (3 8)) ((10 7) (9 0)))
  (leadsto ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (3 8)) ((10 7) (9 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 1036)
  (parent 844)
  (unrealized (10 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (3 0)) ((2 0) (5 0)) ((2 0) (7 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 5) (0 4))
    ((5 9) (4 0)) ((6 0) (3 8)) ((6 0) (5 8)) ((7 7) (6 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (5 0)) ((2 0) (7 0)) ((6 0) (3 8))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 1037)
  (parent 845)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0))
    ((3 2) (0 1)) ((3 7) (9 0)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)) ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (3 8)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0)) ((3 7) (9 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 3 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 1038)
  (parent 846)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 7) (9 0)) ((6 9) (5 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (3 8)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0)) ((6 7) (9 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 6 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 1039)
  (parent 846)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0))
    ((3 2) (0 1)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (3 8)) ((10 7) (9 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((2 0) (8 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (3 8)) ((10 7) (9 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 1040)
  (parent 846)
  (unrealized (10 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (3 0)) ((2 0) (5 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 5) (0 4)) ((5 9) (4 0))
    ((6 0) (3 8)) ((6 0) (5 8)) ((7 7) (6 0)) ((8 0) (7 0)))
  (leadsto ((1 0) (3 0)) ((2 0) (5 0)) ((6 0) (3 8)) ((6 0) (5 8))
    ((7 7) (6 0)) ((8 0) (7 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 1041)
  (parent 847)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 7) (10 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (8 0)) ((10 0) (3 8)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((3 7) (10 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (3 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 11 3 proxy 8) request-3
    (10 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 1042)
  (parent 848)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((2 0) (6 0)) ((3 2) (0 1))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 7) (10 0)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 7) (7 0))
    ((9 0) (8 0)) ((10 0) (3 8)))
  (leadsto ((1 0) (3 0)) ((2 0) (6 0)) ((6 7) (10 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (8 0)) ((10 0) (3 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 11 6 proxy 8) request-3
    (10 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1))))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 1043)
  (parent 848)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (4 4)) ((1 0) (4 0)) ((1 0) (6 0))
    ((2 5) (0 4)) ((3 0) (2 0)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)))
  (leadsto ((1 0) (4 0)) ((1 0) (6 0)) ((3 0) (2 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 1045)
  (parent 849)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (4 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((0 5) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (4 0)) ((3 0) (6 0)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 5) (0 4)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 1046)
  (parent 850)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 7) (6 0))
    ((5 9) (0 6)) ((6 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((5 7) (6 0))
    ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 1047)
  (parent 851)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((2 0) (8 0)) ((3 5) (0 4)) ((4 0) (3 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((2 0) (8 0)) ((4 0) (3 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 1048)
  (parent 852)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (8 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((4 0) (8 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 1049)
  (parent 853)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (5 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 0) (5 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (5 0)) ((4 0) (3 0)) ((7 0) (5 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret (pubk proxy-0)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 1050)
  (parent 854)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (5 4)) ((1 0) (3 0)) ((1 0) (7 0)) ((2 0) (5 0))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 5) (0 4)) ((5 9) (4 0))
    ((6 0) (3 8)) ((6 0) (5 8)) ((7 2) (0 1)) ((7 7) (6 0)))
  (leadsto ((1 0) (3 0)) ((1 0) (7 0)) ((2 0) (5 0)) ((6 0) (3 8))
    ((6 0) (5 8)) ((7 7) (6 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation generalization deleted (4 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge id))))))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 1051)
  (parent 855)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0))
    ((3 7) (9 0)) ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0))
    ((6 5) (0 4)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 2) (0 1))
    ((8 7) (7 0)) ((9 0) (3 8)))
  (leadsto ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0)) ((3 7) (9 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 3 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 1052)
  (parent 856)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 7) (9 0)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 2) (0 1))
    ((8 7) (7 0)) ((9 0) (3 8)))
  (leadsto ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0)) ((6 7) (9 0))
    ((7 0) (6 8)) ((8 7) (7 0)) ((9 0) (3 8)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 10 6 proxy 8) request-3
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-1 (cat answer-1 cookie-0))))
  (label 1053)
  (parent 856)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie challenge-0 id-0 secret-0
      request-2 answer-1 cookie-0 challenge-1 id-1 secret-1 request-3
      data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-1)
    (request request-3) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 9) (5 0)) ((7 0) (6 8)) ((8 2) (0 1)) ((8 7) (7 0))
    ((9 0) (3 8)) ((10 7) (9 0)))
  (leadsto ((1 0) (3 0)) ((1 0) (8 0)) ((2 0) (6 0)) ((7 0) (6 8))
    ((8 7) (7 0)) ((9 0) (3 8)) ((10 7) (9 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (added-strand proxy 8) request-3 (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-1 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-1 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-1 challenge-1 id-1)))
      (recv request-3) (init request-3)))
  (label 1054)
  (parent 856)
  (unrealized (10 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (4 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (6 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 5) (0 4))
    ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (4 8)) ((7 0) (6 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (6 0)) ((6 7) (7 0))
    ((7 0) (4 8)) ((7 0) (6 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 1055)
  (parent 857)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer request-0 iv-0 challenge id secret
      request-1 syskey-0 answer-0 cookie answer-1 cookie-0 challenge-0
      id-0 secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (hash secret challenge id))
  (deflistener (cat secret challenge id))
  (defstrand proxy 10 (challenge challenge) (id id) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (6 1)) ((0 2) (3 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((1 0) (3 0)) ((1 0) (9 0)) ((2 0) (6 0))
    ((3 9) (0 6)) ((4 1) (3 4)) ((5 1) (4 0)) ((6 5) (0 4))
    ((6 7) (7 0)) ((6 9) (5 0)) ((7 0) (6 8)) ((8 0) (3 8))
    ((9 2) (0 1)) ((9 7) (8 0)))
  (leadsto ((1 0) (3 0)) ((1 0) (9 0)) ((2 0) (6 0)) ((6 7) (7 0))
    ((7 0) (6 8)) ((8 0) (3 8)) ((9 7) (8 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge secret)
  (operation state-passing-test (displaced 1 10 proxy 8) request-2
    (9 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc secret (pubk proxy)))
      (send (enc id (hash secret challenge id)))
      (recv (enc challenge (hash secret challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-0)
      (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge id))))))
    ((recv (hash secret challenge id))
      (send (hash secret challenge id)))
    ((recv (cat secret challenge id)) (send (cat secret challenge id)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id (hash secret challenge id)))
      (send (enc challenge (hash secret challenge id))) (recv request-1)
      (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-0 (hash secret-0 challenge-0 id-0)))
      (send (enc challenge-0 (hash secret-0 challenge-0 id-0)))
      (recv request-2) (init request-2)))
  (label 1056)
  (parent 858)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (7 0)) ((4 7) (9 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 7) (8 0)) ((7 9) (6 0))
    ((8 0) (7 8)) ((9 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)) ((4 7) (9 0))
    ((7 7) (8 0)) ((8 0) (7 8)) ((9 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 4 proxy 8) request-2
    (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-0 (cat answer-1 cookie-0))))
  (label 1057)
  (parent 858)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie answer-1 cookie-0
      challenge-1 id-1 secret-0 request-2 data)
    (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie-0))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 7) (8 0)) ((7 9) (6 0)) ((8 0) (7 8))
    ((9 0) (4 8)) ((10 7) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)) ((7 7) (8 0))
    ((8 0) (7 8)) ((9 0) (4 8)) ((10 7) (9 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand proxy 8) request-2 (9 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((tran request-2 (cat answer-1 cookie-0)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 1058)
  (parent 858)
  (unrealized (10 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((2 0) (9 0)) ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (4 8))
    ((8 0) (7 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((2 0) (9 0)) ((3 0) (7 0))
    ((8 0) (4 8)) ((8 0) (7 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 8 server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 1059)
  (parent 859)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 request-3 answer-1 cookie-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((2 0) (9 0)) ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8))
    ((9 7) (8 0)) ((10 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((2 0) (9 0)) ((3 0) (7 0))
    ((8 0) (7 8)) ((9 7) (8 0)) ((10 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 1060)
  (parent 859)
  (unrealized (10 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (7 0)) ((3 0) (9 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (4 8))
    ((8 0) (7 8)) ((9 7) (8 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)) ((3 0) (9 0))
    ((8 0) (4 8)) ((8 0) (7 8)) ((9 7) (8 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 10 8 server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2)))
  (label 1061)
  (parent 860)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 request-3 answer-1 cookie-0 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-1) (cookie cookie-0)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-3) (answer answer-1)
    (cookie cookie-0))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (7 0)) ((3 0) (9 0)) ((4 9) (0 6)) ((5 1) (4 4))
    ((6 1) (5 0)) ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (7 8))
    ((9 7) (8 0)) ((10 0) (4 8)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)) ((3 0) (9 0))
    ((8 0) (7 8)) ((9 7) (8 0)) ((10 0) (4 8)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (added-strand server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-1 cookie-0))
      (send
        (cat answer-1 iv-0
          (enc cookie-0 (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret-0 (pubk proxy)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((tran request-3 (cat answer-1 cookie-0))))
  (label 1062)
  (parent 860)
  (unrealized (10 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey request iv answer challenge id request-0 iv-0 challenge-0
      id-0 secret request-1 syskey-0 answer-0 cookie challenge-1 id-1
      secret-0 request-2 data) (ca proxy ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (deflistener (hash secret challenge-0 id-0))
  (deflistener (cat secret challenge-0 id-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (iv secret) (answer answer-0) (cookie cookie)
    (syskey syskey-0) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret-0)
    (request request-2) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (4 1)) ((0 0) (7 1)) ((0 2) (4 3)) ((0 2) (7 3))
    ((0 3) (7 4)) ((1 2) (0 1)) ((2 0) (1 0)) ((2 0) (4 0))
    ((3 0) (7 0)) ((4 9) (0 6)) ((5 1) (4 4)) ((6 1) (5 0))
    ((7 5) (0 4)) ((7 9) (6 0)) ((8 0) (4 8)) ((8 0) (7 8))
    ((9 7) (8 0)) ((10 0) (9 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (7 0)) ((8 0) (4 8))
    ((8 0) (7 8)) ((9 7) (8 0)) ((10 0) (9 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation state-passing-test (displaced 11 8 server 1)
    (cat answer-1 cookie-0) (4 8))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((recv (hash secret challenge-0 id-0))
      (send (hash secret challenge-0 id-0)))
    ((recv (cat secret challenge-0 id-0))
      (send (cat secret challenge-0 id-0)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 secret
          (enc cookie (hash syskey-0 (hash secret challenge-0 id-0))))))
    ((tran request-2 (cat answer-0 cookie)))
    ((obsv (enc proxy-0 (pubk proxy-0) (privk ca-1))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy-0)
          (enc proxy-0 (pubk proxy-0) (privk ca-1))))
      (recv (enc secret-0 (pubk proxy-0)))
      (recv (enc id-1 (hash secret-0 challenge-1 id-1)))
      (send (enc challenge-1 (hash secret-0 challenge-1 id-1)))
      (recv request-2) (init request-2))
    ((init (enc proxy-0 (pubk proxy-0) (privk ca-1)))))
  (label 1063)
  (parent 861)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer request-0 iv-0 answer-0
      cookie challenge-0 id-0 secret request-1 data)
    (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (2 1)) ((0 0) (4 1)) ((0 2) (2 3)) ((0 2) (4 3))
    ((0 3) (2 4)) ((0 5) (4 4)) ((1 0) (6 0)) ((2 5) (0 4))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 2) (0 1)) ((6 7) (5 0)))
  (leadsto ((1 0) (6 0)) ((3 0) (2 0)) ((3 0) (4 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk proxy) (privk ca-0))
  (uniq-orig challenge request)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-1) (init request-1)))
  (label 1065)
  (parent 862)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (syskey iv answer challenge id request iv-0 answer-0 cookie
      challenge-0 id-0 secret request-0 data) (ca proxy ca-0 name))
  (defstrand client 7 (challenge challenge-0) (id id-0) (secret secret)
    (request secret) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge) (id id) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge-0) (id id-0) (secret secret)
    (request request) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-0) (id id-0) (secret secret)
    (request request-0) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (4 1)) ((0 0) (6 1)) ((0 2) (4 3)) ((0 2) (6 3))
    ((0 3) (6 4)) ((0 5) (4 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 0) (4 0)) ((3 0) (6 0)) ((4 9) (0 6)) ((5 0) (4 8))
    ((6 5) (0 4)) ((6 7) (5 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (4 0)) ((3 0) (6 0)) ((5 0) (4 8))
    ((6 7) (5 0)))
  (non-orig syskey (privk ca) (privk proxy))
  (uniq-orig challenge-0 secret)
  (operation generalization deleted (5 0))
  (traces
    ((send challenge-0)
      (recv (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc secret (pubk proxy)))
      (send (enc id-0 (hash secret challenge-0 id-0)))
      (recv (enc challenge-0 (hash secret challenge-0 id-0)))
      (send secret)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request) (init request) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash secret challenge-0 id-0))))))
    ((tran request-0 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-0 (hash secret challenge-0 id-0)))
      (send (enc challenge-0 (hash secret challenge-0 id-0)))
      (recv request-0) (init request-0)))
  (label 1066)
  (parent 863)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie data) (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (5 4)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 7) (6 0))
    ((5 9) (0 6)) ((6 0) (5 8)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 7) (6 0))
    ((6 0) (5 8)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((tran request-0 (cat answer-0 cookie))))
  (label 1067)
  (parent 864)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((2 0) (8 0)) ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((2 0) (8 0)) ((4 0) (3 0)) ((4 0) (5 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-1)
      (send (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 1068)
  (parent 865)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy) (ca ca-0))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((4 0) (8 0))
    ((5 9) (0 6)) ((6 1) (5 4)) ((7 0) (5 8)) ((8 7) (7 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((4 0) (8 0))
    ((7 0) (5 8)) ((8 7) (7 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send
        (cat answer-0 iv-0
          (enc cookie (hash syskey (hash request challenge id))))))
    ((recv (cat request challenge id))
      (send (cat request challenge id)))
    ((tran request-1 (cat answer-0 cookie)))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge-1)
      (send
        (cat id-1 (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc secret (pubk proxy)))
      (recv (enc id-1 (hash secret challenge-1 id-1)))
      (send (enc challenge-1 (hash secret challenge-1 id-1)))
      (recv request-1) (init request-1)))
  (label 1069)
  (parent 866)
  (unrealized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton sbp
  (vars
    (challenge id syskey request iv answer challenge-0 id-0 request-0
      iv-0 answer-0 cookie challenge-1 id-1 secret request-1 data)
    (proxy ca ca-0 proxy-0 ca-1 name))
  (defstrand client 7 (challenge challenge) (id id) (secret request)
    (request request) (iv iv) (answer answer) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca))
  (defstrand proxy 3 (challenge challenge-0) (id id-0) (proxy proxy)
    (ca ca))
  (defstrand certauth 1 (proxy proxy) (ca ca))
  (defstrand proxy 6 (challenge challenge) (id id) (secret request)
    (proxy proxy) (ca ca-0))
  (defstrand certauth 1 (proxy proxy) (ca ca-0))
  (defstrand proxy 10 (challenge challenge) (id id) (secret request)
    (request request-0) (iv iv-0) (answer answer-0) (cookie cookie)
    (syskey syskey) (proxy proxy) (ca ca-0))
  (deflistener (cat request challenge id))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 8 (challenge challenge-1) (id id-1) (secret secret)
    (request request-1) (proxy proxy-0) (ca ca-1))
  (defstrand certauth 1 (proxy proxy-0) (ca ca-1))
  (precedes ((0 0) (3 1)) ((0 0) (5 1)) ((0 2) (3 3)) ((0 2) (5 3))
    ((0 3) (3 4)) ((0 5) (6 0)) ((1 2) (0 1)) ((2 0) (1 0))
    ((3 5) (0 4)) ((4 0) (3 0)) ((4 0) (5 0)) ((5 9) (0 6))
    ((6 1) (5 4)) ((7 0) (5 8)) ((8 7) (7 0)) ((9 0) (8 0)))
  (leadsto ((2 0) (1 0)) ((4 0) (3 0)) ((4 0) (5 0)) ((7 0) (5 8))
    ((8 7) (7 0)) ((9 0) (8 0)))
  (non-orig syskey (privk proxy) (privk ca))
  (uniq-orig challenge request)
  (operation generalization deleted (6 0))
  (traces
    ((send challenge)
      (recv (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca))))
      (send (enc request (pubk proxy)))
      (send (enc id (hash request challenge id)))
      (recv (enc challenge (hash request challenge id))) (send request)
      (recv
        (cat answer iv
          (enc cookie (hash syskey (hash request challenge id))))))
    ((obsv (enc proxy (pubk proxy) (privk ca))) (recv challenge-0)
      (send
        (cat id-0 (pubk proxy) (enc proxy (pubk proxy) (privk ca)))))
    ((init (enc proxy (pubk proxy) (privk ca))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id))))
    ((init (enc proxy (pubk proxy) (privk ca-0))))
    ((obsv (enc proxy (pubk proxy) (privk ca-0))) (recv challenge)
      (send (cat id (pubk proxy) (enc proxy (pubk proxy) (privk ca-0))))
      (recv (enc request (pubk proxy)))
      (recv (enc id (hash request challenge id)))
      (send (enc challenge (hash request challenge id)))
      (recv request-0) (init request-0) (o