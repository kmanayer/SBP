(comment "CPSA 3.6.6")
(comment "Extracted shapes")

(herald "Session Binding Protocol (SBP)")

(comment "CPSA 3.6.6")

(comment "All input read from sbp.lsp")

(defprotocol sbp basic
  (defrole client
    (vars
      (request request2 answer answer2 cookie syskey tlskey tlskey2
        tlskey3 data))
    (trace (init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey3))))))
  (defrole proxy
    (vars
      (request2 answer answer2 cookie syskey tlskey tlskey2 tlskey3
        data))
    (trace (obsv (cat answer cookie))
      (send (cat answer (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey2))))
      (init (cat request2 cookie)) (obsv (cat answer2 cookie))
      (send (cat answer2 (enc cookie (hash syskey tlskey3))))))
  (defrole server
    (vars (request request2 answer answer2 cookie data))
    (trace (tran request (cat answer cookie))
      (tran (cat request2 cookie) answer2))))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 tlskey3 request request2 answer answer2
      cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey3))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey3)
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey3))))))
  (label 0)
  (unrealized (0 1) (0 3))
  (origs)
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 answer-0
      cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey2))
  (defstrand proxy 2 (answer answer-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 0) (1 0)))
  (leadsto ((0 0) (2 0)) ((2 0) (1 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 3 0 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey2)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request (cat answer-0 cookie))))
  (label 75)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey2) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 answer-0
      cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey))
  (defstrand proxy 2 (answer answer-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 0) (1 0)))
  (leadsto ((0 0) (2 0)) ((2 0) (1 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 3 1 proxy 2)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request (cat answer-0 cookie))))
  (label 79)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 answer-0
      cookie request-0 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey2))
  (defstrand proxy 2 (answer answer-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand client 1 (request request-0))
  (precedes ((1 1) (0 1)) ((2 0) (1 0)) ((3 0) (2 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 4 0 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey2)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request-0 (cat answer-0 cookie))) ((init request-0)))
  (label 82)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey2) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 answer-0
      cookie request-0 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey))
  (defstrand proxy 2 (answer answer-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand client 1 (request request-0))
  (precedes ((1 1) (0 1)) ((2 0) (1 0)) ((3 0) (2 0)))
  (leadsto ((2 0) (1 0)) ((3 0) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 4 1 proxy 2)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request-0 (cat answer-0 cookie))) ((init request-0)))
  (label 87)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 answer-1 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey2))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand proxy 2 (answer answer-1) (cookie cookie) (syskey syskey)
    (tlskey tlskey-0))
  (defstrand server 1 (request request) (answer answer-1)
    (cookie cookie))
  (precedes ((0 0) (3 0)) ((1 2) (0 1)) ((2 1) (1 1)) ((3 0) (2 0)))
  (leadsto ((0 0) (3 0)) ((3 0) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 4 0 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey2)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat answer-1 cookie))
      (send (cat answer-1 (enc cookie (hash syskey tlskey-0)))))
    ((tran request (cat answer-1 cookie))))
  (label 147)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey2) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 answer-1 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand proxy 2 (answer answer-1) (cookie cookie) (syskey syskey)
    (tlskey tlskey-0))
  (defstrand server 1 (request request) (answer answer-1)
    (cookie cookie))
  (precedes ((0 0) (3 0)) ((1 2) (0 1)) ((2 1) (1 1)) ((3 0) (2 0)))
  (leadsto ((0 0) (3 0)) ((3 0) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 4 1 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat answer-1 cookie))
      (send (cat answer-1 (enc cookie (hash syskey tlskey-0)))))
    ((tran request (cat answer-1 cookie))))
  (label 148)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 answer-1 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey-0))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand proxy 2 (answer answer-1) (cookie cookie) (syskey syskey)
    (tlskey tlskey-0))
  (defstrand server 1 (request request) (answer answer-1)
    (cookie cookie))
  (precedes ((0 0) (3 0)) ((1 2) (0 1)) ((2 1) (1 1)) ((3 0) (2 0)))
  (leadsto ((0 0) (3 0)) ((3 0) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey-0)
  (operation encryption-test (displaced 4 2 proxy 2)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey-0)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat answer-1 cookie))
      (send (cat answer-1 (enc cookie (hash syskey tlskey-0)))))
    ((tran request (cat answer-1 cookie))))
  (label 152)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey-0) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 answer-1 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey2))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand proxy 2 (answer answer-1) (cookie cookie) (syskey syskey)
    (tlskey tlskey-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie))
  (precedes ((1 0) (3 0)) ((1 2) (0 1)) ((2 1) (1 1)) ((3 0) (2 0)))
  (leadsto ((1 0) (3 0)) ((3 0) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 4 0 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey2)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat answer-1 cookie))
      (send (cat answer-1 (enc cookie (hash syskey tlskey-0)))))
    ((tran request-0 (cat answer-1 cookie))))
  (label 155)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey2) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 answer-1 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand proxy 2 (answer answer-1) (cookie cookie) (syskey syskey)
    (tlskey tlskey-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie))
  (precedes ((1 0) (3 0)) ((1 2) (0 1)) ((2 1) (1 1)) ((3 0) (2 0)))
  (leadsto ((1 0) (3 0)) ((3 0) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 4 1 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat answer-1 cookie))
      (send (cat answer-1 (enc cookie (hash syskey tlskey-0)))))
    ((tran request-0 (cat answer-1 cookie))))
  (label 156)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 answer-1 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey-0))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand proxy 2 (answer answer-1) (cookie cookie) (syskey syskey)
    (tlskey tlskey-0))
  (defstrand server 1 (request request-0) (answer answer-1)
    (cookie cookie))
  (precedes ((1 0) (3 0)) ((1 2) (0 1)) ((2 1) (1 1)) ((3 0) (2 0)))
  (leadsto ((1 0) (3 0)) ((3 0) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey-0)
  (operation encryption-test (displaced 4 2 proxy 2)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey-0)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat answer-1 cookie))
      (send (cat answer-1 (enc cookie (hash syskey tlskey-0)))))
    ((tran request-0 (cat answer-1 cookie))))
  (label 160)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey-0) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 answer-1 cookie request-1 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey2))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand proxy 2 (answer answer-1) (cookie cookie) (syskey syskey)
    (tlskey tlskey-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie))
  (defstrand client 1 (request request-1))
  (precedes ((1 2) (0 1)) ((2 1) (1 1)) ((3 0) (2 0)) ((4 0) (3 0)))
  (leadsto ((3 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 5 0 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey2)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat answer-1 cookie))
      (send (cat answer-1 (enc cookie (hash syskey tlskey-0)))))
    ((tran request-1 (cat answer-1 cookie))) ((init request-1)))
  (label 163)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey2) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 answer-1 cookie request-1 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand proxy 2 (answer answer-1) (cookie cookie) (syskey syskey)
    (tlskey tlskey-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie))
  (defstrand client 1 (request request-1))
  (precedes ((1 2) (0 1)) ((2 1) (1 1)) ((3 0) (2 0)) ((4 0) (3 0)))
  (leadsto ((3 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 5 1 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat answer-1 cookie))
      (send (cat answer-1 (enc cookie (hash syskey tlskey-0)))))
    ((tran request-1 (cat answer-1 cookie))) ((init request-1)))
  (label 164)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 answer-1 cookie request-1 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey-0))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand proxy 2 (answer answer-1) (cookie cookie) (syskey syskey)
    (tlskey tlskey-0))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie))
  (defstrand client 1 (request request-1))
  (precedes ((1 2) (0 1)) ((2 1) (1 1)) ((3 0) (2 0)) ((4 0) (3 0)))
  (leadsto ((3 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey-0)
  (operation encryption-test (displaced 5 2 proxy 2)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey-0)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat answer-1 cookie))
      (send (cat answer-1 (enc cookie (hash syskey tlskey-0)))))
    ((tran request-1 (cat answer-1 cookie))) ((init request-1)))
  (label 169)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey-0) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request2-0
      syskey-0 tlskey-0 tlskey2-0 answer-0 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey2))
  (defstrand proxy 2 (answer request2-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 4 (request2 request2-0) (answer answer-0)
    (cookie cookie) (syskey syskey-0) (tlskey tlskey-0)
    (tlskey2 tlskey2-0))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 3) (1 0)) ((3 0) (2 0)))
  (leadsto ((0 0) (3 0)) ((2 3) (1 0)) ((3 0) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 4 0 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey2)))))
    ((obsv (cat request2-0 cookie))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-0 (enc cookie (hash syskey-0 tlskey2-0))))
      (init (cat request2-0 cookie)))
    ((tran request (cat answer-0 cookie))))
  (label 249)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey2) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request2-0
      syskey-0 tlskey-0 tlskey2-0 answer-0 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey))
  (defstrand proxy 2 (answer request2-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 4 (request2 request2-0) (answer answer-0)
    (cookie cookie) (syskey syskey-0) (tlskey tlskey-0)
    (tlskey2 tlskey2-0))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 3) (1 0)) ((3 0) (2 0)))
  (leadsto ((0 0) (3 0)) ((2 3) (1 0)) ((3 0) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 4 1 proxy 2)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat request2-0 cookie))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-0 (enc cookie (hash syskey-0 tlskey2-0))))
      (init (cat request2-0 cookie)))
    ((tran request (cat answer-0 cookie))))
  (label 254)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request2-0
      syskey-0 tlskey-0 tlskey2-0 answer-0 cookie request-0 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey2))
  (defstrand proxy 2 (answer request2-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 4 (request2 request2-0) (answer answer-0)
    (cookie cookie) (syskey syskey-0) (tlskey tlskey-0)
    (tlskey2 tlskey2-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand client 1 (request request-0))
  (precedes ((1 1) (0 1)) ((2 3) (1 0)) ((3 0) (2 0)) ((4 0) (3 0)))
  (leadsto ((2 3) (1 0)) ((3 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 5 0 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey2)))))
    ((obsv (cat request2-0 cookie))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-0 (enc cookie (hash syskey-0 tlskey2-0))))
      (init (cat request2-0 cookie)))
    ((tran request-0 (cat answer-0 cookie))) ((init request-0)))
  (label 258)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey2) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request2-0
      syskey-0 tlskey-0 tlskey2-0 answer-0 cookie request-0 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey))
  (defstrand proxy 2 (answer request2-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 4 (request2 request2-0) (answer answer-0)
    (cookie cookie) (syskey syskey-0) (tlskey tlskey-0)
    (tlskey2 tlskey2-0))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand client 1 (request request-0))
  (precedes ((1 1) (0 1)) ((2 3) (1 0)) ((3 0) (2 0)) ((4 0) (3 0)))
  (leadsto ((2 3) (1 0)) ((3 0) (2 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 5 1 proxy 2)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat request2-0 cookie))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-0 (enc cookie (hash syskey-0 tlskey2-0))))
      (init (cat request2-0 cookie)))
    ((tran request-0 (cat answer-0 cookie))) ((init request-0)))
  (label 264)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 tlskey3 request request2 answer answer2
      answer-0 cookie request-0 request2-0 answer-1 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey3))
  (defstrand proxy 2 (answer answer-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey2)
    (tlskey2 tlskey3))
  (precedes ((0 0) (2 0)) ((0 2) (3 1)) ((1 1) (0 1)) ((2 0) (1 0))
    ((3 2) (0 3)))
  (leadsto ((0 0) (2 0)) ((2 0) (1 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey3)
  (operation encryption-test (displaced 4 0 client 3)
    (enc cookie (hash syskey tlskey-0)) (3 1))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey3)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request (cat answer-0 cookie)))
    ((init request-0)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey2))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey3))))))
  (label 271)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey3) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 tlskey3 request request2 answer answer2
      answer-0 cookie request-0 request2-0 answer-1 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey3))
  (defstrand proxy 2 (answer answer-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey)
    (tlskey2 tlskey3))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((1 1) (3 1)) ((2 0) (1 0))
    ((3 2) (0 3)))
  (leadsto ((0 0) (2 0)) ((2 0) (1 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey3)
  (operation encryption-test (displaced 4 1 proxy 2)
    (enc cookie (hash syskey tlskey-0)) (3 1))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey3)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request (cat answer-0 cookie)))
    ((init request-0)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey3))))))
  (label 275)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey3) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 tlskey3 request request2 answer answer2
      answer-0 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey3))
  (defstrand proxy 2 (answer answer-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (answer answer-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey3))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 0) (1 0)) ((2 0) (3 0))
    ((3 1) (0 3)))
  (leadsto ((0 0) (2 0)) ((2 0) (1 0)) ((2 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey3)
  (operation state-passing-test (displaced 4 2 server 1)
    (cat answer-1 cookie) (3 0))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey3)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request (cat answer-0 cookie)))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey3))))))
  (label 290)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey3) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 tlskey3 request request2 answer answer2
      answer-0 cookie request-0 request2-0 answer-1 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey3))
  (defstrand proxy 2 (answer answer-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey2)
    (tlskey2 tlskey3))
  (precedes ((0 2) (3 1)) ((1 1) (0 1)) ((2 0) (1 0)) ((3 0) (2 0))
    ((3 2) (0 3)))
  (leadsto ((2 0) (1 0)) ((3 0) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey3)
  (operation encryption-test (displaced 4 0 client 3)
    (enc cookie (hash syskey tlskey-0)) (3 1))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey3)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request-0 (cat answer-0 cookie)))
    ((init request-0)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey2))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey3))))))
  (label 292)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey3) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 tlskey3 request request2 answer answer2
      answer-0 cookie request-0 request2-0 answer-1 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey3))
  (defstrand proxy 2 (answer answer-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey)
    (tlskey2 tlskey3))
  (precedes ((1 1) (0 1)) ((1 1) (3 1)) ((2 0) (1 0)) ((3 0) (2 0))
    ((3 2) (0 3)))
  (leadsto ((2 0) (1 0)) ((3 0) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey3)
  (operation encryption-test (displaced 4 1 proxy 2)
    (enc cookie (hash syskey tlskey-0)) (3 1))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey3)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request-0 (cat answer-0 cookie)))
    ((init request-0)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey3))))))
  (label 296)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey3) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 tlskey3 request request2 answer answer2
      answer-0 cookie request-0 request-1 request2-0 answer-1 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey3))
  (defstrand proxy 2 (answer answer-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand client 1 (request request-0))
  (defstrand client 3 (request request-1) (request2 request2-0)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey2)
    (tlskey2 tlskey3))
  (precedes ((0 2) (4 1)) ((1 1) (0 1)) ((2 0) (1 0)) ((3 0) (2 0))
    ((4 2) (0 3)))
  (leadsto ((2 0) (1 0)) ((3 0) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey3)
  (operation encryption-test (displaced 5 0 client 3)
    (enc cookie (hash syskey tlskey-0)) (4 1))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey3)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request-0 (cat answer-0 cookie))) ((init request-0))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey2))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey3))))))
  (label 299)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey3) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 tlskey3 request request2 answer answer2
      answer-0 cookie request-0 request-1 request2-0 answer-1 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey3))
  (defstrand proxy 2 (answer answer-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand client 1 (request request-0))
  (defstrand client 3 (request request-1) (request2 request2-0)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey)
    (tlskey2 tlskey3))
  (precedes ((1 1) (0 1)) ((1 1) (4 1)) ((2 0) (1 0)) ((3 0) (2 0))
    ((4 2) (0 3)))
  (leadsto ((2 0) (1 0)) ((3 0) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey3)
  (operation encryption-test (displaced 5 1 proxy 2)
    (enc cookie (hash syskey tlskey-0)) (4 1))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey3)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request-0 (cat answer-0 cookie))) ((init request-0))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey3))))))
  (label 304)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey3) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 tlskey3 request request2 answer answer2
      answer-0 request-0 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey3))
  (defstrand proxy 2 (answer answer-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-0) (answer answer-0)
    (cookie cookie))
  (defstrand client 1 (request request-0))
  (defstrand proxy 2 (answer answer-0) (cookie cookie) (syskey syskey)
    (tlskey tlskey3))
  (precedes ((1 1) (0 1)) ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (2 0))
    ((4 1) (0 3)))
  (leadsto ((2 0) (1 0)) ((2 0) (4 0)) ((3 0) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey3)
  (operation state-passing-test (displaced 5 2 server 1)
    (cat answer-1 cookie) (4 0))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey3)))))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request-0 (cat answer-0 cookie))) ((init request-0))
    ((obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey3))))))
  (label 320)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey3) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey2))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request) (answer answer-2)
    (cookie cookie))
  (precedes ((0 0) (4 0)) ((1 2) (0 1)) ((2 2) (1 1)) ((3 1) (2 1))
    ((4 0) (3 0)))
  (leadsto ((0 0) (4 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 5 0 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey2)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request (cat answer-2 cookie))))
  (label 395)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey2) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request) (answer answer-2)
    (cookie cookie))
  (precedes ((0 0) (4 0)) ((1 2) (0 1)) ((2 2) (1 1)) ((3 1) (2 1))
    ((4 0) (3 0)))
  (leadsto ((0 0) (4 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 5 1 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request (cat answer-2 cookie))))
  (label 396)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey-0))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request) (answer answer-2)
    (cookie cookie))
  (precedes ((0 0) (4 0)) ((1 2) (0 1)) ((2 2) (1 1)) ((3 1) (2 1))
    ((4 0) (3 0)))
  (leadsto ((0 0) (4 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey-0)
  (operation encryption-test (displaced 5 2 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey-0)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request (cat answer-2 cookie))))
  (label 397)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey-0) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey-1))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request) (answer answer-2)
    (cookie cookie))
  (precedes ((0 0) (4 0)) ((1 2) (0 1)) ((2 2) (1 1)) ((3 1) (2 1))
    ((4 0) (3 0)))
  (leadsto ((0 0) (4 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey-1)
  (operation encryption-test (displaced 5 3 proxy 2)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey-1)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request (cat answer-2 cookie))))
  (label 401)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey-1) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey2))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie))
  (precedes ((1 0) (4 0)) ((1 2) (0 1)) ((2 2) (1 1)) ((3 1) (2 1))
    ((4 0) (3 0)))
  (leadsto ((1 0) (4 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 5 0 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey2)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request-0 (cat answer-2 cookie))))
  (label 404)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey2) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie))
  (precedes ((1 0) (4 0)) ((1 2) (0 1)) ((2 2) (1 1)) ((3 1) (2 1))
    ((4 0) (3 0)))
  (leadsto ((1 0) (4 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 5 1 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request-0 (cat answer-2 cookie))))
  (label 405)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey-0))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie))
  (precedes ((1 0) (4 0)) ((1 2) (0 1)) ((2 2) (1 1)) ((3 1) (2 1))
    ((4 0) (3 0)))
  (leadsto ((1 0) (4 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey-0)
  (operation encryption-test (displaced 5 2 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey-0)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request-0 (cat answer-2 cookie))))
  (label 406)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey-0) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey-1))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-0) (answer answer-2)
    (cookie cookie))
  (precedes ((1 0) (4 0)) ((1 2) (0 1)) ((2 2) (1 1)) ((3 1) (2 1))
    ((4 0) (3 0)))
  (leadsto ((1 0) (4 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey-1)
  (operation encryption-test (displaced 5 3 proxy 2)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey-1)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request-0 (cat answer-2 cookie))))
  (label 410)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey-1) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey2))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie))
  (precedes ((1 2) (0 1)) ((2 0) (4 0)) ((2 2) (1 1)) ((3 1) (2 1))
    ((4 0) (3 0)))
  (leadsto ((2 0) (4 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 5 0 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey2)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request-1 (cat answer-2 cookie))))
  (label 413)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey2) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie))
  (precedes ((1 2) (0 1)) ((2 0) (4 0)) ((2 2) (1 1)) ((3 1) (2 1))
    ((4 0) (3 0)))
  (leadsto ((2 0) (4 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 5 1 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request-1 (cat answer-2 cookie))))
  (label 414)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey-0))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie))
  (precedes ((1 2) (0 1)) ((2 0) (4 0)) ((2 2) (1 1)) ((3 1) (2 1))
    ((4 0) (3 0)))
  (leadsto ((2 0) (4 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey-0)
  (operation encryption-test (displaced 5 2 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey-0)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request-1 (cat answer-2 cookie))))
  (label 415)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey-0) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey-1))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-1) (answer answer-2)
    (cookie cookie))
  (precedes ((1 2) (0 1)) ((2 0) (4 0)) ((2 2) (1 1)) ((3 1) (2 1))
    ((4 0) (3 0)))
  (leadsto ((2 0) (4 0)) ((4 0) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey-1)
  (operation encryption-test (displaced 5 3 proxy 2)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey-1)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request-1 (cat answer-2 cookie))))
  (label 419)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey-1) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie request-2 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey2))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie))
  (defstrand client 1 (request request-2))
  (precedes ((1 2) (0 1)) ((2 2) (1 1)) ((3 1) (2 1)) ((4 0) (3 0))
    ((5 0) (4 0)))
  (leadsto ((4 0) (3 0)) ((5 0) (4 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 6 0 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey2)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request-2 (cat answer-2 cookie))) ((init request-2)))
  (label 422)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey2) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie request-2 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie))
  (defstrand client 1 (request request-2))
  (precedes ((1 2) (0 1)) ((2 2) (1 1)) ((3 1) (2 1)) ((4 0) (3 0))
    ((5 0) (4 0)))
  (leadsto ((4 0) (3 0)) ((5 0) (4 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2)
  (operation encryption-test (displaced 6 1 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request-2 (cat answer-2 cookie))) ((init request-2)))
  (label 423)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie request-2 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey-0))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie))
  (defstrand client 1 (request request-2))
  (precedes ((1 2) (0 1)) ((2 2) (1 1)) ((3 1) (2 1)) ((4 0) (3 0))
    ((5 0) (4 0)))
  (leadsto ((4 0) (3 0)) ((5 0) (4 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey-0)
  (operation encryption-test (displaced 6 2 client 3)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey-0)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request-2 (cat answer-2 cookie))) ((init request-2)))
  (label 424)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey-0) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey tlskey2 request request2 answer answer2 request-0
      request2-0 answer-0 tlskey-0 request-1 request2-1 answer-1
      tlskey-1 answer-2 cookie request-2 data))
  (defstrand client 4 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey) (tlskey2 tlskey2) (tlskey3 tlskey-1))
  (defstrand client 3 (request request-0) (request2 request2-0)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey-0)
    (tlskey2 tlskey))
  (defstrand client 3 (request request-1) (request2 request2-1)
    (answer answer-1) (cookie cookie) (syskey syskey) (tlskey tlskey-1)
    (tlskey2 tlskey-0))
  (defstrand proxy 2 (answer answer-2) (cookie cookie) (syskey syskey)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-2) (answer answer-2)
    (cookie cookie))
  (defstrand client 1 (request request-2))
  (precedes ((1 2) (0 1)) ((2 2) (1 1)) ((3 1) (2 1)) ((4 0) (3 0))
    ((5 0) (4 0)))
  (leadsto ((4 0) (3 0)) ((5 0) (4 0)))
  (non-orig syskey)
  (pen-non-orig tlskey tlskey2 tlskey-1)
  (operation encryption-test (displaced 6 3 proxy 2)
    (enc cookie (hash syskey tlskey3)) (0 3))
  (traces
    ((init request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey2))))
      (recv (cat answer2 (enc cookie (hash syskey tlskey-1)))))
    ((init request-0)
      (recv (cat answer-0 (enc cookie (hash syskey tlskey-0))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey)))))
    ((init request-1)
      (recv (cat answer-1 (enc cookie (hash syskey tlskey-1))))
      (send (cat request2-1 (enc cookie (hash syskey tlskey-0)))))
    ((obsv (cat answer-2 cookie))
      (send (cat answer-2 (enc cookie (hash syskey tlskey-1)))))
    ((tran request-2 (cat answer-2 cookie))) ((init request-2)))
  (label 429)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((syskey syskey) (tlskey tlskey) (tlskey2 tlskey2)
        (tlskey3 tlskey-1) (request request) (request2 request2)
        (answer answer) (answer2 answer2) (cookie cookie))))
  (origs))

(comment "Step limit exceeded--aborting run")
