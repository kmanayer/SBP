(comment "CPSA 3.6.6")
(comment "Extracted shapes")

(herald "Session Binding Protocol (SBP)")

(comment "CPSA 3.6.6")

(comment "All input read from sbp.lsp")

(defprotocol sbp basic
  (defrole client
    (vars (request request2 answer answer2 cookie syskey tlskey data))
    (trace (send request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2 (enc cookie (hash syskey tlskey))))
      (recv answer2)))
  (defrole proxy
    (vars (request request2 answer answer2 cookie syskey tlskey data))
    (trace (recv request) (init request) (obsv (cat answer cookie))
      (send (cat answer (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2) (send answer2)))
  (defrole server
    (vars (request request2 answer answer2 cookie data))
    (trace (tran request (cat answer cookie))
      (tran (cat request2 cookie) answer2))))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 answer answer2 cookie request-0
      request2-0 answer-0 answer2-0 cookie-0 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer-0) (answer2 answer2-0) (cookie cookie-0)
    (syskey syskey) (tlskey tlskey))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (traces
    ((recv request) (init request) (obsv (cat answer cookie))
      (send (cat answer (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2) (send answer2))
    ((send request-0)
      (recv (cat answer-0 (enc cookie-0 (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie-0 (hash syskey tlskey))))
      (recv answer2-0)))
  (label 0)
  (unrealized (0 2) (0 6) (1 1))
  (origs)
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 cookie request-1 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 request-1) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-1))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((2 0) (0 2)) ((3 1) (0 6)))
  (leadsto ((0 1) (2 0)) ((2 0) (0 2)) ((3 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-1 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-1) (send request-1))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request (cat answer-0 cookie)))
    ((recv request-1) (init request-1)))
  (label 29)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 request-1)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 cookie request-1 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 request) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-1))
  (precedes ((0 3) (1 1)) ((2 0) (0 2)) ((3 1) (2 0)))
  (leadsto ((0 1) (0 6)) ((2 0) (0 2)) ((3 1) (2 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 0 proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request) (send request))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request-1 (cat answer-0 cookie)))
    ((recv request-1) (init request-1)))
  (label 32)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 request)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 cookie request-1 request-2 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 request-2) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-1))
  (defstrand proxy 2 (request request-2))
  (precedes ((0 3) (1 1)) ((2 0) (0 2)) ((3 1) (2 0)) ((4 1) (0 6)))
  (leadsto ((2 0) (0 2)) ((3 1) (2 0)) ((4 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-2) (send request-2))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request-1 (cat answer-0 cookie)))
    ((recv request-1) (init request-1))
    ((recv request-2) (init request-2)))
  (label 33)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 request-2)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 answer-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-1) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (precedes ((0 1) (3 0)) ((0 3) (1 1)) ((2 1) (0 6)) ((2 5) (0 2))
    ((3 0) (2 2)))
  (leadsto ((0 1) (3 0)) ((2 1) (0 6)) ((2 5) (0 2)) ((3 0) (2 2)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 2 proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-1) (send request-1))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((tran request (cat answer-0 cookie))))
  (label 79)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-1)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 answer-0 cookie request-2
      data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-2) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-2))
  (precedes ((0 1) (3 0)) ((0 3) (1 1)) ((2 5) (0 2)) ((3 0) (2 2))
    ((4 1) (0 6)))
  (leadsto ((0 1) (3 0)) ((2 5) (0 2)) ((3 0) (2 2)) ((4 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-2) (send request-2))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((tran request (cat answer-0 cookie)))
    ((recv request-2) (init request-2)))
  (label 80)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-2)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 answer-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 3) (1 1)) ((2 1) (3 0)) ((2 5) (0 2)) ((3 0) (2 2)))
  (leadsto ((0 1) (0 6)) ((2 1) (3 0)) ((2 5) (0 2)) ((3 0) (2 2)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 0 proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request) (send request))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((tran request-1 (cat answer-0 cookie))))
  (label 83)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 answer-0 cookie request-2
      data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-2) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-2))
  (precedes ((0 3) (1 1)) ((2 1) (3 0)) ((2 5) (0 2)) ((3 0) (2 2))
    ((4 1) (0 6)))
  (leadsto ((2 1) (3 0)) ((2 5) (0 2)) ((3 0) (2 2)) ((4 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-2) (send request-2))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((tran request-1 (cat answer-0 cookie)))
    ((recv request-2) (init request-2)))
  (label 84)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-2)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 answer-0 cookie request-2
      data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-2))
  (precedes ((0 3) (1 1)) ((2 5) (0 2)) ((3 0) (2 2)) ((4 1) (3 0)))
  (leadsto ((0 1) (0 6)) ((2 5) (0 2)) ((3 0) (2 2)) ((4 1) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 0 proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request) (send request))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((tran request-2 (cat answer-0 cookie)))
    ((recv request-2) (init request-2)))
  (label 87)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 answer-0 cookie request-2
      data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-1) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-2))
  (precedes ((0 3) (1 1)) ((2 1) (0 6)) ((2 5) (0 2)) ((3 0) (2 2))
    ((4 1) (3 0)))
  (leadsto ((2 1) (0 6)) ((2 5) (0 2)) ((3 0) (2 2)) ((4 1) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 2 proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-1) (send request-1))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((tran request-2 (cat answer-0 cookie)))
    ((recv request-2) (init request-2)))
  (label 88)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-1)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 answer-0 cookie request-2
      request-3 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-3) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-2))
  (defstrand proxy 2 (request request-3))
  (precedes ((0 3) (1 1)) ((2 5) (0 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (0 6)))
  (leadsto ((2 5) (0 2)) ((3 0) (2 2)) ((4 1) (3 0)) ((5 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-3) (send request-3))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((tran request-2 (cat answer-0 cookie)))
    ((recv request-2) (init request-2))
    ((recv request-3) (init request-3)))
  (label 89)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-3)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request2 request request2-0 answer answer2 request-0
      answer-0 answer2-0 cookie data))
  (defstrand proxy 8 (request request-0) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 2 (request request-0) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((0 5) (2 1)) ((2 0) (0 2))
    ((2 1) (0 6)))
  (leadsto ((0 1) (2 0)) ((0 5) (2 1)) ((2 0) (0 2)) ((2 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 3 0 proxy 6)
    (cat request2-1 cookie) (2 1))
  (traces
    ((recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((tran request-0 (cat answer-0 cookie))
      (tran (cat request2 cookie) answer2-0)))
  (label 96)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request-0)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request2 request request2-0 answer answer2 request-0
      answer-0 answer2-0 cookie data))
  (defstrand proxy 8 (request request-0) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 2 (request request-0) (request2 answer-0)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (precedes ((0 1) (2 0)) ((0 2) (2 1)) ((0 3) (1 1)) ((2 0) (0 2))
    ((2 1) (0 6)))
  (leadsto ((0 1) (2 0)) ((2 0) (0 2)) ((2 0) (2 1)) ((2 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 3 2 server 1)
    (cat answer-1 cookie) (2 1))
  (traces
    ((recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((tran request-0 (cat answer-0 cookie))
      (tran (cat answer-0 cookie) answer2-0)))
  (label 98)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request-0)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 answer-0 answer2-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 2 (request request-1))
  (defstrand server 2 (request request-1) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (precedes ((0 3) (1 1)) ((0 5) (3 1)) ((2 1) (3 0)) ((3 0) (0 2))
    ((3 1) (0 6)))
  (leadsto ((0 5) (3 1)) ((2 1) (3 0)) ((3 0) (0 2)) ((3 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 0 proxy 6)
    (cat request2-1 cookie) (3 1))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((recv request-1) (init request-1))
    ((tran request-1 (cat answer-0 cookie))
      (tran (cat request2 cookie) answer2-0)))
  (label 103)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 answer-0 answer2-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 2 (request request-1))
  (defstrand server 2 (request request-1) (request2 answer-0)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (precedes ((0 2) (3 1)) ((0 3) (1 1)) ((2 1) (3 0)) ((3 0) (0 2))
    ((3 1) (0 6)))
  (leadsto ((2 1) (3 0)) ((3 0) (0 2)) ((3 0) (3 1)) ((3 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 3 server 1)
    (cat answer-1 cookie) (3 1))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((recv request-1) (init request-1))
    ((tran request-1 (cat answer-0 cookie))
      (tran (cat answer-0 cookie) answer2-0)))
  (label 106)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (request request2 request-0 request2-0 answer answer2 request-1
      request2-1 answer-0 cookie syskey tlskey data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-1) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey))
  (precedes ((0 1) (2 0)) ((2 0) (3 2)) ((3 1) (0 6)) ((3 3) (1 1))
    ((3 5) (0 2)))
  (leadsto ((0 1) (2 0)) ((2 0) (3 2)) ((3 1) (0 6)) ((3 5) (0 2)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 3 proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-1) (send request-1))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request (cat answer-0 cookie)))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2-1 (enc cookie (hash syskey tlskey))))
      (init (cat request2-1 cookie))))
  (label 190)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-1)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (request request2 request-0 request2-0 answer answer2 request-1
      request2-1 answer-0 cookie syskey tlskey request-2 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-2) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey))
  (defstrand proxy 2 (request request-2))
  (precedes ((0 1) (2 0)) ((2 0) (3 2)) ((3 3) (1 1)) ((3 5) (0 2))
    ((4 1) (0 6)))
  (leadsto ((0 1) (2 0)) ((2 0) (3 2)) ((3 5) (0 2)) ((4 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-2) (send request-2))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request (cat answer-0 cookie)))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2-1 (enc cookie (hash syskey tlskey))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2)))
  (label 191)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-2)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 answer-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 request-1) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 4 (request request-1) (answer answer-0)
    (cookie cookie) (syskey syskey) (tlskey tlskey))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (precedes ((0 1) (3 0)) ((2 1) (0 6)) ((2 3) (1 1)) ((3 0) (0 2))
    ((3 0) (2 2)))
  (leadsto ((0 1) (3 0)) ((2 1) (0 6)) ((3 0) (0 2)) ((3 0) (2 2)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 2 proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-1) (send request-1))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request (cat answer-0 cookie))))
  (label 198)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 request-1)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 answer-0 cookie request-2 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 request-2) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 4 (request request-1) (answer answer-0)
    (cookie cookie) (syskey syskey) (tlskey tlskey))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-2))
  (precedes ((0 1) (3 0)) ((2 3) (1 1)) ((3 0) (0 2)) ((3 0) (2 2))
    ((4 1) (0 6)))
  (leadsto ((0 1) (3 0)) ((3 0) (0 2)) ((3 0) (2 2)) ((4 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-2) (send request-2))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request (cat answer-0 cookie)))
    ((recv request-2) (init request-2)))
  (label 199)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 request-2)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (request request2 request-0 request2-0 answer answer2 request-1
      request2-1 answer-0 cookie syskey tlskey data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey))
  (precedes ((2 0) (3 2)) ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (0 2)))
  (leadsto ((0 1) (0 6)) ((2 0) (3 2)) ((3 1) (2 0)) ((3 5) (0 2)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 0 proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request) (send request))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request-1 (cat answer-0 cookie)))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2-1 (enc cookie (hash syskey tlskey))))
      (init (cat request2-1 cookie))))
  (label 206)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (request request2 request-0 request2-0 answer answer2 request-1
      request2-1 answer-0 cookie syskey tlskey request-2 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-2) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey))
  (defstrand proxy 2 (request request-2))
  (precedes ((2 0) (3 2)) ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (0 2))
    ((4 1) (0 6)))
  (leadsto ((2 0) (3 2)) ((3 1) (2 0)) ((3 5) (0 2)) ((4 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-2) (send request-2))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request-1 (cat answer-0 cookie)))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2-1 (enc cookie (hash syskey tlskey))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2)))
  (label 207)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-2)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 answer-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 request) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 4 (request request-1) (answer answer-0)
    (cookie cookie) (syskey syskey) (tlskey tlskey))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((2 1) (3 0)) ((2 3) (1 1)) ((3 0) (0 2)) ((3 0) (2 2)))
  (leadsto ((0 1) (0 6)) ((2 1) (3 0)) ((3 0) (0 2)) ((3 0) (2 2)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 0 proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request) (send request))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request-1 (cat answer-0 cookie))))
  (label 214)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 request)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 answer-0 cookie request-2 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 request-2) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 4 (request request-1) (answer answer-0)
    (cookie cookie) (syskey syskey) (tlskey tlskey))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-2))
  (precedes ((2 1) (3 0)) ((2 3) (1 1)) ((3 0) (0 2)) ((3 0) (2 2))
    ((4 1) (0 6)))
  (leadsto ((2 1) (3 0)) ((3 0) (0 2)) ((3 0) (2 2)) ((4 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-2) (send request-2))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request-1 (cat answer-0 cookie)))
    ((recv request-2) (init request-2)))
  (label 215)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 request-2)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (request request2 request-0 request2-0 answer answer2 request-1
      request-2 request2-1 answer-0 cookie syskey tlskey data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-1))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey))
  (precedes ((2 0) (4 2)) ((3 1) (2 0)) ((4 3) (1 1)) ((4 5) (0 2)))
  (leadsto ((0 1) (0 6)) ((2 0) (4 2)) ((3 1) (2 0)) ((4 5) (0 2)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 0 proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request) (send request))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request-1 (cat answer-0 cookie)))
    ((recv request-1) (init request-1))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2-1 (enc cookie (hash syskey tlskey))))
      (init (cat request2-1 cookie))))
  (label 222)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (request request2 request-0 request2-0 answer answer2 request-1
      request-2 request2-1 answer-0 cookie syskey tlskey data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-2) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-1))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey))
  (precedes ((2 0) (4 2)) ((3 1) (2 0)) ((4 1) (0 6)) ((4 3) (1 1))
    ((4 5) (0 2)))
  (leadsto ((2 0) (4 2)) ((3 1) (2 0)) ((4 1) (0 6)) ((4 5) (0 2)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 4 proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-2) (send request-2))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request-1 (cat answer-0 cookie)))
    ((recv request-1) (init request-1))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2-1 (enc cookie (hash syskey tlskey))))
      (init (cat request2-1 cookie))))
  (label 223)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-2)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (request request2 request-0 request2-0 answer answer2 request-1
      request-2 request2-1 answer-0 cookie syskey tlskey request-3
      data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-3) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-1))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey) (tlskey tlskey))
  (defstrand proxy 2 (request request-3))
  (precedes ((2 0) (4 2)) ((3 1) (2 0)) ((4 3) (1 1)) ((4 5) (0 2))
    ((5 1) (0 6)))
  (leadsto ((2 0) (4 2)) ((3 1) (2 0)) ((4 5) (0 2)) ((5 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-3) (send request-3))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request-1 (cat answer-0 cookie)))
    ((recv request-1) (init request-1))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2-1 (enc cookie (hash syskey tlskey))))
      (init (cat request2-1 cookie)))
    ((recv request-3) (init request-3)))
  (label 224)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-3)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 answer-0 cookie request-2 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 request) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 4 (request request-1) (answer answer-0)
    (cookie cookie) (syskey syskey) (tlskey tlskey))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-2))
  (precedes ((2 3) (1 1)) ((3 0) (0 2)) ((3 0) (2 2)) ((4 1) (3 0)))
  (leadsto ((0 1) (0 6)) ((3 0) (0 2)) ((3 0) (2 2)) ((4 1) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 0 proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request) (send request))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request-2 (cat answer-0 cookie)))
    ((recv request-2) (init request-2)))
  (label 236)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 request)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 answer-0 cookie request-2 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 request-1) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 4 (request request-1) (answer answer-0)
    (cookie cookie) (syskey syskey) (tlskey tlskey))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-2))
  (precedes ((2 1) (0 6)) ((2 3) (1 1)) ((3 0) (0 2)) ((3 0) (2 2))
    ((4 1) (3 0)))
  (leadsto ((2 1) (0 6)) ((3 0) (0 2)) ((3 0) (2 2)) ((4 1) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 2 proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-1) (send request-1))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request-2 (cat answer-0 cookie)))
    ((recv request-2) (init request-2)))
  (label 237)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 request-1)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 answer-0 cookie request-2 request-3 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 request-3) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 4 (request request-1) (answer answer-0)
    (cookie cookie) (syskey syskey) (tlskey tlskey))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-2))
  (defstrand proxy 2 (request request-3))
  (precedes ((2 3) (1 1)) ((3 0) (0 2)) ((3 0) (2 2)) ((4 1) (3 0))
    ((5 1) (0 6)))
  (leadsto ((3 0) (0 2)) ((3 0) (2 2)) ((4 1) (3 0)) ((5 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-3) (send request-3))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey)))))
    ((tran request-2 (cat answer-0 cookie)))
    ((recv request-2) (init request-2))
    ((recv request-3) (init request-3)))
  (label 238)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 request-3)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 request2-2
      syskey-1 tlskey-1 answer-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-1) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 6 (request request-2) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (tlskey tlskey-1))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (precedes ((0 1) (4 0)) ((0 3) (1 1)) ((2 1) (0 6)) ((2 5) (0 2))
    ((3 5) (2 2)) ((4 0) (3 2)))
  (leadsto ((0 1) (4 0)) ((2 1) (0 6)) ((2 5) (0 2)) ((3 5) (2 2))
    ((4 0) (3 2)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 2 proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-1) (send request-1))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat request2-2 cookie))
      (send (cat request2-2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-1 tlskey-1))))
      (recv (cat request2-2 (enc cookie (hash syskey-1 tlskey-1))))
      (init (cat request2-2 cookie)))
    ((tran request (cat answer-0 cookie))))
  (label 271)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-1)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 request2-2
      syskey-1 tlskey-1 answer-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-2) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 6 (request request-2) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (tlskey tlskey-1))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (precedes ((0 1) (4 0)) ((0 3) (1 1)) ((2 5) (0 2)) ((3 1) (0 6))
    ((3 5) (2 2)) ((4 0) (3 2)))
  (leadsto ((0 1) (4 0)) ((2 5) (0 2)) ((3 1) (0 6)) ((3 5) (2 2))
    ((4 0) (3 2)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 3 proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-2) (send request-2))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat request2-2 cookie))
      (send (cat request2-2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-1 tlskey-1))))
      (recv (cat request2-2 (enc cookie (hash syskey-1 tlskey-1))))
      (init (cat request2-2 cookie)))
    ((tran request (cat answer-0 cookie))))
  (label 272)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-2)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 request2-2
      syskey-1 tlskey-1 answer-0 cookie request-3 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-3) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 6 (request request-2) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (tlskey tlskey-1))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-3))
  (precedes ((0 1) (4 0)) ((0 3) (1 1)) ((2 5) (0 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (0 6)))
  (leadsto ((0 1) (4 0)) ((2 5) (0 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-3) (send request-3))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat request2-2 cookie))
      (send (cat request2-2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-1 tlskey-1))))
      (recv (cat request2-2 (enc cookie (hash syskey-1 tlskey-1))))
      (init (cat request2-2 cookie)))
    ((tran request (cat answer-0 cookie)))
    ((recv request-3) (init request-3)))
  (label 273)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-3)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 request2-2
      syskey-1 tlskey-1 answer-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 6 (request request-2) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 3) (1 1)) ((2 1) (4 0)) ((2 5) (0 2)) ((3 5) (2 2))
    ((4 0) (3 2)))
  (leadsto ((0 1) (0 6)) ((2 1) (4 0)) ((2 5) (0 2)) ((3 5) (2 2))
    ((4 0) (3 2)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 0 proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request) (send request))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat request2-2 cookie))
      (send (cat request2-2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-1 tlskey-1))))
      (recv (cat request2-2 (enc cookie (hash syskey-1 tlskey-1))))
      (init (cat request2-2 cookie)))
    ((tran request-1 (cat answer-0 cookie))))
  (label 276)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 request2-2
      syskey-1 tlskey-1 answer-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-2) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 6 (request request-2) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (precedes ((0 3) (1 1)) ((2 1) (4 0)) ((2 5) (0 2)) ((3 1) (0 6))
    ((3 5) (2 2)) ((4 0) (3 2)))
  (leadsto ((2 1) (4 0)) ((2 5) (0 2)) ((3 1) (0 6)) ((3 5) (2 2))
    ((4 0) (3 2)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 3 proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-2) (send request-2))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat request2-2 cookie))
      (send (cat request2-2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-1 tlskey-1))))
      (recv (cat request2-2 (enc cookie (hash syskey-1 tlskey-1))))
      (init (cat request2-2 cookie)))
    ((tran request-1 (cat answer-0 cookie))))
  (label 277)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-2)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 request2-2
      syskey-1 tlskey-1 answer-0 cookie request-3 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-3) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 6 (request request-2) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-3))
  (precedes ((0 3) (1 1)) ((2 1) (4 0)) ((2 5) (0 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (0 6)))
  (leadsto ((2 1) (4 0)) ((2 5) (0 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-3) (send request-3))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat request2-2 cookie))
      (send (cat request2-2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-1 tlskey-1))))
      (recv (cat request2-2 (enc cookie (hash syskey-1 tlskey-1))))
      (init (cat request2-2 cookie)))
    ((tran request-1 (cat answer-0 cookie)))
    ((recv request-3) (init request-3)))
  (label 278)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-3)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 request2-2
      syskey-1 tlskey-1 answer-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 6 (request request-2) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (precedes ((0 3) (1 1)) ((2 5) (0 2)) ((3 1) (4 0)) ((3 5) (2 2))
    ((4 0) (3 2)))
  (leadsto ((0 1) (0 6)) ((2 5) (0 2)) ((3 1) (4 0)) ((3 5) (2 2))
    ((4 0) (3 2)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 0 proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request) (send request))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat request2-2 cookie))
      (send (cat request2-2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-1 tlskey-1))))
      (recv (cat request2-2 (enc cookie (hash syskey-1 tlskey-1))))
      (init (cat request2-2 cookie)))
    ((tran request-2 (cat answer-0 cookie))))
  (label 281)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 request2-2
      syskey-1 tlskey-1 answer-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-1) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 6 (request request-2) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (precedes ((0 3) (1 1)) ((2 1) (0 6)) ((2 5) (0 2)) ((3 1) (4 0))
    ((3 5) (2 2)) ((4 0) (3 2)))
  (leadsto ((2 1) (0 6)) ((2 5) (0 2)) ((3 1) (4 0)) ((3 5) (2 2))
    ((4 0) (3 2)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 2 proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-1) (send request-1))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat request2-2 cookie))
      (send (cat request2-2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-1 tlskey-1))))
      (recv (cat request2-2 (enc cookie (hash syskey-1 tlskey-1))))
      (init (cat request2-2 cookie)))
    ((tran request-2 (cat answer-0 cookie))))
  (label 282)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-1)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 request2-2
      syskey-1 tlskey-1 answer-0 cookie request-3 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-3) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 6 (request request-2) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-2) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-3))
  (precedes ((0 3) (1 1)) ((2 5) (0 2)) ((3 1) (4 0)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (0 6)))
  (leadsto ((2 5) (0 2)) ((3 1) (4 0)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-3 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-3) (send request-3))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat request2-2 cookie))
      (send (cat request2-2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-1 tlskey-1))))
      (recv (cat request2-2 (enc cookie (hash syskey-1 tlskey-1))))
      (init (cat request2-2 cookie)))
    ((tran request-2 (cat answer-0 cookie)))
    ((recv request-3) (init request-3)))
  (label 283)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-3)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 request2-2
      syskey-1 tlskey-1 answer-0 cookie request-3 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 6 (request request-2) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-3) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-3))
  (precedes ((0 3) (1 1)) ((2 5) (0 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)))
  (leadsto ((0 1) (0 6)) ((2 5) (0 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 6 0 proxy 2) request-4 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request) (send request))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat request2-2 cookie))
      (send (cat request2-2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-1 tlskey-1))))
      (recv (cat request2-2 (enc cookie (hash syskey-1 tlskey-1))))
      (init (cat request2-2 cookie)))
    ((tran request-3 (cat answer-0 cookie)))
    ((recv request-3) (init request-3)))
  (label 286)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 request2-2
      syskey-1 tlskey-1 answer-0 cookie request-3 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-1) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 6 (request request-2) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-3) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-3))
  (precedes ((0 3) (1 1)) ((2 1) (0 6)) ((2 5) (0 2)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)))
  (leadsto ((2 1) (0 6)) ((2 5) (0 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 6 2 proxy 2) request-4 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-1) (send request-1))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat request2-2 cookie))
      (send (cat request2-2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-1 tlskey-1))))
      (recv (cat request2-2 (enc cookie (hash syskey-1 tlskey-1))))
      (init (cat request2-2 cookie)))
    ((tran request-3 (cat answer-0 cookie)))
    ((recv request-3) (init request-3)))
  (label 287)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-1)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 request2-2
      syskey-1 tlskey-1 answer-0 cookie request-3 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-2) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 6 (request request-2) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-3) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-3))
  (precedes ((0 3) (1 1)) ((2 5) (0 2)) ((3 1) (0 6)) ((3 5) (2 2))
    ((4 0) (3 2)) ((5 1) (4 0)))
  (leadsto ((2 5) (0 2)) ((3 1) (0 6)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 6 3 proxy 2) request-4 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-2) (send request-2))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat request2-2 cookie))
      (send (cat request2-2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-1 tlskey-1))))
      (recv (cat request2-2 (enc cookie (hash syskey-1 tlskey-1))))
      (init (cat request2-2 cookie)))
    ((tran request-3 (cat answer-0 cookie)))
    ((recv request-3) (init request-3)))
  (label 288)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-2)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 request2-2
      syskey-1 tlskey-1 answer-0 cookie request-3 request-4 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 request-4) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer request2-2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 6 (request request-2) (request2 request2-2)
    (answer answer-0) (cookie cookie) (syskey syskey-1)
    (tlskey tlskey-1))
  (defstrand server 1 (request request-3) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-3))
  (defstrand proxy 2 (request request-4))
  (precedes ((0 3) (1 1)) ((2 5) (0 2)) ((3 5) (2 2)) ((4 0) (3 2))
    ((5 1) (4 0)) ((6 1) (0 6)))
  (leadsto ((2 5) (0 2)) ((3 5) (2 2)) ((4 0) (3 2)) ((5 1) (4 0))
    ((6 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-4 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-4) (send request-4))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat request2-2 cookie))
      (send (cat request2-2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-1 tlskey-1))))
      (recv (cat request2-2 (enc cookie (hash syskey-1 tlskey-1))))
      (init (cat request2-2 cookie)))
    ((tran request-3 (cat answer-0 cookie)))
    ((recv request-3) (init request-3))
    ((recv request-4) (init request-4)))
  (label 289)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 request-4)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request2 request request2-0 answer answer2 request-0
      request2-1 syskey-0 tlskey-0 request-1 answer-0 answer2-0 cookie
      data))
  (defstrand proxy 8 (request request-1) (request2 request2)
    (answer request2-1) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-0) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand server 2 (request request-1) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (precedes ((0 1) (3 0)) ((0 3) (1 1)) ((0 5) (3 1)) ((2 5) (0 2))
    ((3 0) (2 2)) ((3 1) (0 6)))
  (leadsto ((0 1) (3 0)) ((0 5) (3 1)) ((2 5) (0 2)) ((3 0) (2 2))
    ((3 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 0 proxy 6)
    (cat request2-2 cookie) (3 1))
  (traces
    ((recv request-1) (init request-1) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((tran request-1 (cat answer-0 cookie))
      (tran (cat request2 cookie) answer2-0)))
  (label 297)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request-1)
        (request2 request2) (answer request2-1) (answer2 answer2-0)
        (cookie cookie) (request-0 request) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request2 request request2-0 answer answer2 request-0
      request2-1 syskey-0 tlskey-0 request-1 answer-0 answer2-0 cookie
      data))
  (defstrand proxy 8 (request request-1) (request2 request2)
    (answer request2-1) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-0) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand server 2 (request request-1) (request2 request2-1)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (precedes ((0 1) (3 0)) ((0 2) (3 1)) ((0 3) (1 1)) ((2 5) (0 2))
    ((2 5) (3 1)) ((3 0) (2 2)) ((3 1) (0 6)))
  (leadsto ((0 1) (3 0)) ((2 5) (0 2)) ((2 5) (3 1)) ((3 0) (2 2))
    ((3 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 2 proxy 6)
    (cat request2-2 cookie) (3 1))
  (traces
    ((recv request-1) (init request-1) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((tran request-1 (cat answer-0 cookie))
      (tran (cat request2-1 cookie) answer2-0)))
  (label 298)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request-1)
        (request2 request2) (answer request2-1) (answer2 answer2-0)
        (cookie cookie) (request-0 request) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request2 request request2-0 answer answer2 request-0
      request2-1 syskey-0 tlskey-0 request-1 answer-0 answer2-0 cookie
      data))
  (defstrand proxy 8 (request request-1) (request2 request2)
    (answer request2-1) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-0) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand server 2 (request request-1) (request2 answer-0)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (precedes ((0 1) (3 0)) ((0 3) (1 1)) ((2 2) (3 1)) ((2 5) (0 2))
    ((3 0) (2 2)) ((3 1) (0 6)))
  (leadsto ((0 1) (3 0)) ((2 5) (0 2)) ((3 0) (2 2)) ((3 0) (3 1))
    ((3 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 3 server 1)
    (cat answer-1 cookie) (3 1))
  (traces
    ((recv request-1) (init request-1) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((tran request-1 (cat answer-0 cookie))
      (tran (cat answer-0 cookie) answer2-0)))
  (label 300)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request-1)
        (request2 request2) (answer request2-1) (answer2 answer2-0)
        (cookie cookie) (request-0 request) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request2-1 syskey-0 tlskey-0 request-1 answer-0 answer2-0 cookie
      data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand server 2 (request request-1) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (precedes ((0 3) (1 1)) ((0 5) (3 1)) ((2 1) (3 0)) ((2 5) (0 2))
    ((3 0) (2 2)) ((3 1) (0 6)))
  (leadsto ((0 5) (3 1)) ((2 1) (3 0)) ((2 5) (0 2)) ((3 0) (2 2))
    ((3 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 0 proxy 6)
    (cat request2-2 cookie) (3 1))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((tran request-1 (cat answer-0 cookie))
      (tran (cat request2 cookie) answer2-0)))
  (label 306)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request2-1 syskey-0 tlskey-0 request-1 answer-0 answer2-0 cookie
      data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand server 2 (request request-1) (request2 request2-1)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (precedes ((0 2) (3 1)) ((0 3) (1 1)) ((2 1) (3 0)) ((2 5) (0 2))
    ((2 5) (3 1)) ((3 0) (2 2)) ((3 1) (0 6)))
  (leadsto ((2 1) (3 0)) ((2 5) (0 2)) ((2 5) (3 1)) ((3 0) (2 2))
    ((3 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 2 proxy 6)
    (cat request2-2 cookie) (3 1))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((tran request-1 (cat answer-0 cookie))
      (tran (cat request2-1 cookie) answer2-0)))
  (label 307)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request2-1 syskey-0 tlskey-0 request-1 answer-0 answer2-0 cookie
      data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand server 2 (request request-1) (request2 answer-0)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (precedes ((0 3) (1 1)) ((2 1) (3 0)) ((2 2) (3 1)) ((2 5) (0 2))
    ((3 0) (2 2)) ((3 1) (0 6)))
  (leadsto ((2 1) (3 0)) ((2 5) (0 2)) ((3 0) (2 2)) ((3 0) (3 1))
    ((3 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 3 server 1)
    (cat answer-1 cookie) (3 1))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((tran request-1 (cat answer-0 cookie))
      (tran (cat answer-0 cookie) answer2-0)))
  (label 309)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 answer-0
      answer2-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 2 (request request-2))
  (defstrand server 2 (request request-2) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (precedes ((0 3) (1 1)) ((0 5) (4 1)) ((2 5) (0 2)) ((3 1) (4 0))
    ((4 0) (2 2)) ((4 1) (0 6)))
  (leadsto ((0 5) (4 1)) ((2 5) (0 2)) ((3 1) (4 0)) ((4 0) (2 2))
    ((4 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 0 proxy 6)
    (cat request2-2 cookie) (4 1))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2))
    ((tran request-2 (cat answer-0 cookie))
      (tran (cat request2 cookie) answer2-0)))
  (label 315)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 answer-0
      answer2-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 2 (request request-2))
  (defstrand server 2 (request request-2) (request2 request2-1)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (precedes ((0 2) (4 1)) ((0 3) (1 1)) ((2 5) (0 2)) ((2 5) (4 1))
    ((3 1) (4 0)) ((4 0) (2 2)) ((4 1) (0 6)))
  (leadsto ((2 5) (0 2)) ((2 5) (4 1)) ((3 1) (4 0)) ((4 0) (2 2))
    ((4 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 2 proxy 6)
    (cat request2-2 cookie) (4 1))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2))
    ((tran request-2 (cat answer-0 cookie))
      (tran (cat request2-1 cookie) answer2-0)))
  (label 316)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 request2-1 syskey-0 tlskey-0 request-2 answer-0
      answer2-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer request2-1) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (defstrand proxy 2 (request request-2))
  (defstrand server 2 (request request-2) (request2 answer-0)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (precedes ((0 3) (1 1)) ((2 2) (4 1)) ((2 5) (0 2)) ((3 1) (4 0))
    ((4 0) (2 2)) ((4 1) (0 6)))
  (leadsto ((2 5) (0 2)) ((3 1) (4 0)) ((4 0) (2 2)) ((4 0) (4 1))
    ((4 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 4 server 1)
    (cat answer-1 cookie) (4 1))
  (traces
    ((recv request) (init request) (obsv (cat request2-1 cookie))
      (send (cat request2-1 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie)))
    ((recv request-2) (init request-2))
    ((tran request-2 (cat answer-0 cookie))
      (tran (cat answer-0 cookie) answer2-0)))
  (label 319)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer request2-1) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request2 request request2-0 answer answer2 request-0
      answer-0 answer2-0 request-1 request2-1 syskey-0 tlskey-0 cookie
      data))
  (defstrand proxy 8 (request request-0) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 2 (request request-0) (request2 request2-1)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer request2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((0 5) (3 2)) ((2 0) (0 2))
    ((2 1) (0 6)) ((3 5) (2 1)))
  (leadsto ((0 1) (2 0)) ((0 5) (3 2)) ((2 0) (0 2)) ((2 1) (0 6))
    ((3 5) (2 1)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 0 proxy 6)
    (cat request2-2 cookie) (3 2))
  (traces
    ((recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((tran request-0 (cat answer-0 cookie))
      (tran (cat request2-1 cookie) answer2-0))
    ((recv request-1) (init request-1) (obsv (cat request2 cookie))
      (send (cat request2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie))))
  (label 340)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request-0)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request2 request request2-0 answer answer2 request-0
      answer-0 answer2-0 request-1 request2-1 syskey-0 tlskey-0 cookie
      data))
  (defstrand proxy 8 (request request-0) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 2 (request request-0) (request2 request2-1)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((2 0) (0 2)) ((2 0) (3 2))
    ((2 1) (0 6)) ((3 5) (2 1)))
  (leadsto ((0 1) (2 0)) ((2 0) (0 2)) ((2 0) (3 2)) ((2 1) (0 6))
    ((3 5) (2 1)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 2 server 1)
    (cat answer-1 cookie) (3 2))
  (traces
    ((recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((tran request-0 (cat answer-0 cookie))
      (tran (cat request2-1 cookie) answer2-0))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie))))
  (label 342)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request-0)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request2 request request2-0 answer answer2 request-0
      answer-0 answer2-0 answer-1 cookie request-1 data))
  (defstrand proxy 8 (request request-0) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 2 (request request-0) (request2 answer-1)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (defstrand server 1 (request request-1) (answer answer-1)
    (cookie cookie))
  (defstrand proxy 2 (request request-1))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((2 0) (0 2)) ((2 1) (0 6))
    ((3 0) (2 1)) ((4 1) (3 0)))
  (leadsto ((0 1) (2 0)) ((2 0) (0 2)) ((2 1) (0 6)) ((3 0) (2 1))
    ((4 1) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-1 (3 0))
  (traces
    ((recv request-0) (init request-0) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((tran request-0 (cat answer-0 cookie))
      (tran (cat answer-1 cookie) answer2-0))
    ((tran request-1 (cat answer-1 cookie)))
    ((recv request-1) (init request-1)))
  (label 344)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request-0)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 cookie answer-1 answer2-0 request-1 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 request2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie))
  (defstrand proxy 2 (request request-1))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((0 5) (3 1)) ((2 0) (0 2))
    ((3 1) (0 6)) ((4 1) (3 0)))
  (leadsto ((0 1) (2 0)) ((0 5) (3 1)) ((2 0) (0 2)) ((3 1) (0 6))
    ((4 1) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 0 proxy 6)
    (cat request2-1 cookie-0) (3 1))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request (cat answer-0 cookie)))
    ((tran request-1 (cat answer-1 cookie))
      (tran (cat request2 cookie) answer2-0))
    ((recv request-1) (init request-1)))
  (label 346)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 cookie answer-1 answer2-0 request-1 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie))
  (defstrand proxy 2 (request request-1))
  (precedes ((0 1) (2 0)) ((0 2) (3 1)) ((0 3) (1 1)) ((2 0) (0 2))
    ((2 0) (3 1)) ((3 1) (0 6)) ((4 1) (3 0)))
  (leadsto ((0 1) (2 0)) ((2 0) (0 2)) ((2 0) (3 1)) ((3 1) (0 6))
    ((4 1) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 2 server 1)
    (cat answer-2 cookie-0) (3 1))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request (cat answer-0 cookie)))
    ((tran request-1 (cat answer-1 cookie))
      (tran (cat answer-0 cookie) answer2-0))
    ((recv request-1) (init request-1)))
  (label 349)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 cookie answer-1 answer2-0 request-1 cookie-0 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((2 0) (0 2)) ((3 1) (0 6))
    ((4 1) (3 0)))
  (leadsto ((0 1) (2 0)) ((2 0) (0 2)) ((3 0) (3 1)) ((3 1) (0 6))
    ((4 1) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 3 server 1)
    (cat answer-2 cookie-0) (3 1))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request (cat answer-0 cookie)))
    ((tran request-1 (cat answer-1 cookie-0))
      (tran (cat answer-1 cookie-0) answer2-0))
    ((recv request-1) (init request-1)))
  (label 350)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 answer2-0 request-1 request2-1 syskey-0 tlskey-0 cookie
      data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 2 (request request-1) (request2 request2-1)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer request2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (precedes ((0 3) (1 1)) ((0 5) (3 2)) ((2 0) (0 2)) ((2 1) (0 6))
    ((3 1) (2 0)) ((3 5) (2 1)))
  (leadsto ((0 5) (3 2)) ((2 0) (0 2)) ((2 1) (0 6)) ((3 1) (2 0))
    ((3 5) (2 1)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 0 proxy 6)
    (cat request2-2 cookie) (3 2))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((tran request-1 (cat answer-0 cookie))
      (tran (cat request2-1 cookie) answer2-0))
    ((recv request-1) (init request-1) (obsv (cat request2 cookie))
      (send (cat request2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie))))
  (label 359)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 answer2-0 request-1 request2-1 syskey-0 tlskey-0 cookie
      data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 2 (request request-1) (request2 request2-1)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (defstrand proxy 6 (request request-1) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (precedes ((0 3) (1 1)) ((2 0) (0 2)) ((2 0) (3 2)) ((2 1) (0 6))
    ((3 1) (2 0)) ((3 5) (2 1)))
  (leadsto ((2 0) (0 2)) ((2 0) (3 2)) ((2 1) (0 6)) ((3 1) (2 0))
    ((3 5) (2 1)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 4 2 server 1)
    (cat answer-1 cookie) (3 2))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2))
    ((tran request-1 (cat answer-0 cookie))
      (tran (cat request2-1 cookie) answer2-0))
    ((recv request-1) (init request-1) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie))))
  (label 361)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 answer-0 answer2-0 request-2 request2-1 syskey-0
      tlskey-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 2 (request request-1))
  (defstrand server 2 (request request-1) (request2 request2-1)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer request2) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (precedes ((0 3) (1 1)) ((0 5) (4 2)) ((2 1) (3 0)) ((3 0) (0 2))
    ((3 1) (0 6)) ((4 5) (3 1)))
  (leadsto ((0 5) (4 2)) ((2 1) (3 0)) ((3 0) (0 2)) ((3 1) (0 6))
    ((4 5) (3 1)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 0 proxy 6)
    (cat request2-2 cookie) (4 2))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((recv request-1) (init request-1))
    ((tran request-1 (cat answer-0 cookie))
      (tran (cat request2-1 cookie) answer2-0))
    ((recv request-2) (init request-2) (obsv (cat request2 cookie))
      (send (cat request2 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie))))
  (label 363)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 answer-0 answer2-0 request-2 request2-1 syskey-0
      tlskey-0 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 2 (request request-1))
  (defstrand server 2 (request request-1) (request2 request2-1)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (defstrand proxy 6 (request request-2) (request2 request2-1)
    (answer answer-0) (cookie cookie) (syskey syskey-0)
    (tlskey tlskey-0))
  (precedes ((0 3) (1 1)) ((2 1) (3 0)) ((3 0) (0 2)) ((3 0) (4 2))
    ((3 1) (0 6)) ((4 5) (3 1)))
  (leadsto ((2 1) (3 0)) ((3 0) (0 2)) ((3 0) (4 2)) ((3 1) (0 6))
    ((4 5) (3 1)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 3 server 1)
    (cat answer-1 cookie) (4 2))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((recv request-1) (init request-1))
    ((tran request-1 (cat answer-0 cookie))
      (tran (cat request2-1 cookie) answer2-0))
    ((recv request-2) (init request-2) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey-0 tlskey-0))))
      (recv (cat request2-1 (enc cookie (hash syskey-0 tlskey-0))))
      (init (cat request2-1 cookie))))
  (label 366)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 answer-0 answer2-0 answer-1 cookie data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 2 (request request-1))
  (defstrand server 2 (request request-1) (request2 answer-1)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (defstrand server 1 (request request) (answer answer-1)
    (cookie cookie))
  (precedes ((0 1) (4 0)) ((0 3) (1 1)) ((2 1) (3 0)) ((3 0) (0 2))
    ((3 1) (0 6)) ((4 0) (3 1)))
  (leadsto ((0 1) (4 0)) ((2 1) (3 0)) ((3 0) (0 2)) ((3 1) (0 6))
    ((4 0) (3 1)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 0 proxy 2) request-2 (4 0))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((recv request-1) (init request-1))
    ((tran request-1 (cat answer-0 cookie))
      (tran (cat answer-1 cookie) answer2-0))
    ((tran request (cat answer-1 cookie))))
  (label 368)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      request-1 answer-0 answer2-0 answer-1 cookie request-2 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand proxy 2 (request request-1))
  (defstrand server 2 (request request-1) (request2 answer-1)
    (answer answer-0) (answer2 answer2-0) (cookie cookie))
  (defstrand server 1 (request request-2) (answer answer-1)
    (cookie cookie))
  (defstrand proxy 2 (request request-2))
  (precedes ((0 3) (1 1)) ((2 1) (3 0)) ((3 0) (0 2)) ((3 1) (0 6))
    ((4 0) (3 1)) ((5 1) (4 0)))
  (leadsto ((2 1) (3 0)) ((3 0) (0 2)) ((3 1) (0 6)) ((4 0) (3 1))
    ((5 1) (4 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (4 0))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((recv request-1) (init request-1))
    ((tran request-1 (cat answer-0 cookie))
      (tran (cat answer-1 cookie) answer2-0))
    ((tran request-2 (cat answer-1 cookie)))
    ((recv request-2) (init request-2)))
  (label 369)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 cookie request-1 answer-1 answer2-0 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-1))
  (defstrand server 2 (request request) (request2 request2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie))
  (precedes ((0 1) (4 0)) ((0 3) (1 1)) ((0 5) (4 1)) ((2 0) (0 2))
    ((3 1) (2 0)) ((4 1) (0 6)))
  (leadsto ((0 1) (4 0)) ((0 5) (4 1)) ((2 0) (0 2)) ((3 1) (2 0))
    ((4 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 0 proxy 6)
    (cat request2-1 cookie-0) (4 1))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request-1 (cat answer-0 cookie)))
    ((recv request-1) (init request-1))
    ((tran request (cat answer-1 cookie))
      (tran (cat request2 cookie) answer2-0)))
  (label 371)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 cookie request-1 answer-1 answer2-0 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-1))
  (defstrand server 2 (request request) (request2 answer-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie))
  (precedes ((0 1) (4 0)) ((0 2) (4 1)) ((0 3) (1 1)) ((2 0) (0 2))
    ((2 0) (4 1)) ((3 1) (2 0)) ((4 1) (0 6)))
  (leadsto ((0 1) (4 0)) ((2 0) (0 2)) ((2 0) (4 1)) ((3 1) (2 0))
    ((4 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 2 server 1)
    (cat answer-2 cookie-0) (4 1))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request-1 (cat answer-0 cookie)))
    ((recv request-1) (init request-1))
    ((tran request (cat answer-1 cookie))
      (tran (cat answer-0 cookie) answer2-0)))
  (label 374)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 cookie request-1 answer-1 answer2-0 cookie-0 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-1))
  (defstrand server 2 (request request) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (precedes ((0 1) (4 0)) ((0 3) (1 1)) ((2 0) (0 2)) ((3 1) (2 0))
    ((4 1) (0 6)))
  (leadsto ((0 1) (4 0)) ((2 0) (0 2)) ((3 1) (2 0)) ((4 0) (4 1))
    ((4 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 4 server 1)
    (cat answer-2 cookie-0) (4 1))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request-1 (cat answer-0 cookie)))
    ((recv request-1) (init request-1))
    ((tran request (cat answer-1 cookie-0))
      (tran (cat answer-1 cookie-0) answer2-0)))
  (label 375)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 cookie request-1 answer-1 answer2-0 request-2 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-1))
  (defstrand server 2 (request request-2) (request2 request2)
    (answer answer-1) (answer2 answer2-0) (cookie cookie))
  (defstrand proxy 2 (request request-2))
  (precedes ((0 3) (1 1)) ((0 5) (4 1)) ((2 0) (0 2)) ((3 1) (2 0))
    ((4 1) (0 6)) ((5 1) (4 0)))
  (leadsto ((0 5) (4 1)) ((2 0) (0 2)) ((3 1) (2 0)) ((4 1) (0 6))
    ((5 1) (4 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 6 0 proxy 6)
    (cat request2-1 cookie-0) (4 1))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request-1 (cat answer-0 cookie)))
    ((recv request-1) (init request-1))
    ((tran request-2 (cat answer-1 cookie))
      (tran (cat request2 cookie) answer2-0))
    ((recv request-2) (init request-2)))
  (label 377)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 cookie request-1 answer-1 answer2-0 request-2 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-1))
  (defstrand server 2 (request request-2) (request2 answer-0)
    (answer answer-1) (answer2 answer2-0) (cookie cookie))
  (defstrand proxy 2 (request request-2))
  (precedes ((0 2) (4 1)) ((0 3) (1 1)) ((2 0) (0 2)) ((2 0) (4 1))
    ((3 1) (2 0)) ((4 1) (0 6)) ((5 1) (4 0)))
  (leadsto ((2 0) (0 2)) ((2 0) (4 1)) ((3 1) (2 0)) ((4 1) (0 6))
    ((5 1) (4 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 6 2 server 1)
    (cat answer-2 cookie-0) (4 1))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request-1 (cat answer-0 cookie)))
    ((recv request-1) (init request-1))
    ((tran request-2 (cat answer-1 cookie))
      (tran (cat answer-0 cookie) answer2-0))
    ((recv request-2) (init request-2)))
  (label 381)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 cookie request-1 answer-1 answer2-0 request-2 cookie-0
      data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 answer2-0) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request request-1) (answer answer-0)
    (cookie cookie))
  (defstrand proxy 2 (request request-1))
  (defstrand server 2 (request request-2) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-2))
  (precedes ((0 3) (1 1)) ((2 0) (0 2)) ((3 1) (2 0)) ((4 1) (0 6))
    ((5 1) (4 0)))
  (leadsto ((2 0) (0 2)) ((3 1) (2 0)) ((4 0) (4 1)) ((4 1) (0 6))
    ((5 1) (4 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 6 4 server 1)
    (cat answer-2 cookie-0) (4 1))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv answer2-0) (send answer2-0))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran request-1 (cat answer-0 cookie)))
    ((recv request-1) (init request-1))
    ((tran request-2 (cat answer-1 cookie-0))
      (tran (cat answer-1 cookie-0) answer2-0))
    ((recv request-2) (init request-2)))
  (label 382)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 answer2-0)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 cookie answer-1 answer2-0 cookie-0 request-1 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 request-1) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1))
  (precedes ((0 1) (3 0)) ((0 3) (1 1)) ((2 0) (0 2)) ((3 1) (2 0))
    ((4 1) (0 6)))
  (leadsto ((0 1) (3 0)) ((2 0) (0 2)) ((3 0) (3 1)) ((3 1) (2 0))
    ((4 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-1 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-1) (send request-1))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran answer2-0 (cat answer-0 cookie)))
    ((tran request (cat answer-1 cookie-0))
      (tran (cat answer-1 cookie-0) answer2-0))
    ((recv request-1) (init request-1)))
  (label 396)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 request-1)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 cookie answer-1 answer2-0 request-1 cookie-0 data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 request) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1))
  (precedes ((0 3) (1 1)) ((2 0) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (leadsto ((0 1) (0 6)) ((2 0) (0 2)) ((3 0) (3 1)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (displaced 5 0 proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request) (send request))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran answer2-0 (cat answer-0 cookie)))
    ((tran request-1 (cat answer-1 cookie-0))
      (tran (cat answer-1 cookie-0) answer2-0))
    ((recv request-1) (init request-1)))
  (label 408)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 request)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(defskeleton sbp
  (vars
    (syskey tlskey request request2 request-0 request2-0 answer answer2
      answer-0 cookie answer-1 answer2-0 request-1 cookie-0 request-2
      data))
  (defstrand proxy 8 (request request) (request2 request2)
    (answer answer-0) (answer2 request-2) (cookie cookie)
    (syskey syskey) (tlskey tlskey))
  (defstrand client 4 (request request-0) (request2 request2-0)
    (answer answer) (answer2 answer2) (cookie cookie) (syskey syskey)
    (tlskey tlskey))
  (defstrand server 1 (request answer2-0) (answer answer-0)
    (cookie cookie))
  (defstrand server 2 (request request-1) (request2 answer-1)
    (answer answer-1) (answer2 answer2-0) (cookie cookie-0))
  (defstrand proxy 2 (request request-1))
  (defstrand proxy 2 (request request-2))
  (precedes ((0 3) (1 1)) ((2 0) (0 2)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (0 6)))
  (leadsto ((2 0) (0 2)) ((3 0) (3 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (0 6)))
  (non-orig syskey)
  (pen-non-orig tlskey)
  (operation state-passing-test (added-strand proxy 2) request-2 (0 6))
  (traces
    ((recv request) (init request) (obsv (cat answer-0 cookie))
      (send (cat answer-0 (enc cookie (hash syskey tlskey))))
      (recv (cat request2 (enc cookie (hash syskey tlskey))))
      (init (cat request2 cookie)) (obsv request-2) (send request-2))
    ((send request-0)
      (recv (cat answer (enc cookie (hash syskey tlskey))))
      (send (cat request2-0 (enc cookie (hash syskey tlskey))))
      (recv answer2)) ((tran answer2-0 (cat answer-0 cookie)))
    ((tran request-1 (cat answer-1 cookie-0))
      (tran (cat answer-1 cookie-0) answer2-0))
    ((recv request-1) (init request-1))
    ((recv request-2) (init request-2)))
  (label 409)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((syskey syskey) (tlskey tlskey) (request request)
        (request2 request2) (answer answer-0) (answer2 request-2)
        (cookie cookie) (request-0 request-0) (request2-0 request2-0)
        (answer-0 answer) (answer2-0 answer2) (cookie-0 cookie))))
  (origs))

(comment "Step limit exceeded--aborting run")
