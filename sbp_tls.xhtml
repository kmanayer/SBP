<?xml version="1.0"?>
<!-- CPSA 3.6.6 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Session Binding Protocol (SBP)</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(herald &quot;Session Binding Protocol (SBP)&quot;)
(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;All input read from sbp_tls.lsp&quot;)</pre>

<p id="t0">Tree 0.</p>

<div>
 <svg
  class='diagram' width='429.360pt' height='154.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 429.360 154.920' font-size='12.000'>
  <text
   x='139.800' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  <line
   x1='89.880' y1='114.960' x2='139.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k2&quot;, &quot;_self&quot;)'>2</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='26.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='339.480' y1='39.960' x2='389.400' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k8&quot;, &quot;_self&quot;)'>8</text>
  <line
   x1='289.560' y1='39.960' x2='339.480' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k7&quot;, &quot;_self&quot;)'>7</text>
  <line
   x1='239.640' y1='39.960' x2='289.560' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='189.720' y1='39.960' x2='239.640' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k5&quot;, &quot;_self&quot;)'>5</text>
  <line
   x1='139.800' y1='39.960' x2='189.720' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  <line
   x1='89.880' y1='39.960' x2='139.800' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k1&quot;, &quot;_self&quot;)'>1</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol sbp basic
  (defrole client
    (vars (cc id s cred request answer data) (p name) (enc_cookie mesg))
    (trace (send cc) (recv id) (send (enc s (pubk p)))
      (send (enc id (hash s cc id))) (recv (enc cc (hash s cc id)))
      (send (enc &quot;login-request&quot; cred (hash s cc id)))
      (recv (enc &quot;login-success&quot; enc_cookie (hash s cc id)))
      (send (enc &quot;request&quot; request enc_cookie (hash s cc id)))
      (recv (enc &quot;answer&quot; answer (hash s cc id))))
    (uniq-gen cc s))
  (defrole proxy
    (vars (cc id s cred cookie request answer sskey data) (p name))
    (trace (recv cc) (send id) (recv (enc s (pubk p)))
      (send (enc id (hash s cc id))) (recv (enc cc (hash s cc id)))
      (recv (enc &quot;login-request&quot; cred (hash s cc id)))
      (send
        (enc &quot;login-success&quot; (enc cookie (hash sskey (hash s cc id)))
          (hash s cc id)))
      (recv
        (enc &quot;request&quot; request (enc cookie (hash sskey (hash s cc id)))
          (hash s cc id)))
      (send
        (enc &quot;answer&quot; answer (enc cookie (hash sskey (hash s cc id)))
          (hash s cc id))))
    (non-orig sskey (privk p))
    (uniq-orig answer)
    (uniq-gen id cookie)))</pre>

<p id="k0">Item <a href="#t0">0</a>, Children: <a href="#k1">1</a> <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>(enc &quot;answer&quot; answer (hash s cc id))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; request enc_cookie (hash s cc id))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-success&quot; enc_cookie (hash s cc id))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc &quot;login-request&quot; cred (hash s cc id))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc cc (hash s cc id))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash s cc id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc s (pubk p))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cc</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((enc_cookie enc_cookie) (cc cc) (id id) (s s) (cred cred) (request request) (answer answer) (p p))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>sbp 0</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (enc_cookie mesg) (answer cc id s cred request data) (p name))
  (defstrand client 9 (enc_cookie enc_cookie) (cc cc) (id id) (s s)
    (cred cred) (request request) (answer answer) (p p))
  (non-orig (privk p))
  (uniq-gen cc s)
  (label 0)
  (unrealized (0 4) (0 6) (0 8))
  (origs)
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k1">Item <a href="#t0">1</a>, Parent: <a href="#k0">0</a>, Child: <a href="#k3">3</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>(enc &quot;answer&quot; answer (hash s id id))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; request enc_cookie (hash s id id))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-success&quot; enc_cookie (hash s id id))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc &quot;login-request&quot; cred (hash s id id))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash s id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash s id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc s (pubk p))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((enc_cookie enc_cookie) (cc id) (id id) (s s) (cred cred) (request request) (answer answer) (p p))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>sbp 1</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (enc_cookie mesg) (answer id s cred request data) (p name))
  (defstrand client 9 (enc_cookie enc_cookie) (cc id) (id id) (s s)
    (cred cred) (request request) (answer answer) (p p))
  (non-orig (privk p))
  (uniq-gen id s)
  (operation encryption-test (displaced 1 0 client 4)
    (enc id (hash s id id)) (0 4))
  (label 1)
  (parent 0)
  (unrealized (0 6) (0 8))
  (origs)
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k2">Item <a href="#t0">2</a>, Parent: <a href="#k0">0</a>, Child: <a href="#k4">4</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.340 375.660 44.759 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash s cc id)</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(hash s cc id)</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc &quot;answer&quot; answer (hash s cc id))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; request enc_cookie (hash s cc id))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-success&quot; enc_cookie (hash s cc id))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc &quot;login-request&quot; cred (hash s cc id))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc cc (hash s cc id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash s cc id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc s (pubk p))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cc</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((enc_cookie enc_cookie) (cc cc) (id id) (s s) (cred cred) (request request) (answer answer) (p p))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>sbp 2</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (enc_cookie mesg) (answer cc id s cred request data) (p name))
  (defstrand client 9 (enc_cookie enc_cookie) (cc cc) (id id) (s s)
    (cred cred) (request request) (answer answer) (p p))
  (deflistener (hash s cc id))
  (precedes ((0 2) (1 0)) ((1 1) (0 4)))
  (non-orig (privk p))
  (uniq-gen cc s)
  (operation encryption-test (added-listener (hash s cc id))
    (enc cc (hash s cc id)) (0 4))
  (label 2)
  (parent 0)
  (unrealized (1 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k3">Item <a href="#t0">3</a>, Parent: <a href="#k1">1</a>, Child: <a href="#k5">5</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash s id id)</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(hash s id id)</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc &quot;answer&quot; answer (hash s id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; request enc_cookie (hash s id id))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-success&quot; enc_cookie (hash s id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc &quot;login-request&quot; cred (hash s id id))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash s id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash s id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc s (pubk p))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((enc_cookie enc_cookie) (cc id) (id id) (s s) (cred cred) (request request) (answer answer) (p p))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>sbp 3</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (enc_cookie mesg) (answer id s cred request data) (p name))
  (defstrand client 9 (enc_cookie enc_cookie) (cc id) (id id) (s s)
    (cred cred) (request request) (answer answer) (p p))
  (deflistener (hash s id id))
  (precedes ((0 2) (1 0)) ((1 1) (0 6)))
  (non-orig (privk p))
  (uniq-gen id s)
  (operation encryption-test (added-listener (hash s id id))
    (enc &quot;login-success&quot; enc_cookie (hash s id id)) (0 6))
  (label 3)
  (parent 1)
  (unrealized (1 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k4">Item <a href="#t0">4</a>, Parent: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat s cc id)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat s cc id)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash s cc id)</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(hash s cc id)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc &quot;answer&quot; answer (hash s cc id))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; request enc_cookie (hash s cc id))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-success&quot; enc_cookie (hash s cc id))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc &quot;login-request&quot; cred (hash s cc id))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc cc (hash s cc id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash s cc id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc s (pubk p))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cc</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((enc_cookie enc_cookie) (cc cc) (id id) (s s) (cred cred) (request request) (answer answer) (p p))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>sbp 4</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (enc_cookie mesg) (answer cc id s cred request data) (p name))
  (defstrand client 9 (enc_cookie enc_cookie) (cc cc) (id id) (s s)
    (cred cred) (request request) (answer answer) (p p))
  (deflistener (hash s cc id))
  (deflistener (cat s cc id))
  (precedes ((0 2) (2 0)) ((1 1) (0 4)) ((2 1) (1 0)))
  (non-orig (privk p))
  (uniq-gen cc s)
  (operation encryption-test (added-listener (cat s cc id))
    (hash s cc id) (1 0))
  (label 4)
  (parent 2)
  (unrealized (2 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k5">Item <a href="#t0">5</a>, Parent: <a href="#k3">3</a>, Child: <a href="#k6">6</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='339.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat s id id)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat s id id)</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.604 487.464 43.287 559.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash s id id)</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g><title>(hash s id id)</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc &quot;answer&quot; answer (hash s id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; request enc_cookie (hash s id id))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-success&quot; enc_cookie (hash s id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(enc &quot;login-request&quot; cred (hash s id id))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash s id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash s id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc s (pubk p))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((enc_cookie enc_cookie) (cc id) (id id) (s s) (cred cred) (request request) (answer answer) (p p))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>sbp 5</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (enc_cookie mesg) (answer id s cred request data) (p name))
  (defstrand client 9 (enc_cookie enc_cookie) (cc id) (id id) (s s)
    (cred cred) (request request) (answer answer) (p p))
  (deflistener (hash s id id))
  (deflistener (cat s id id))
  (precedes ((0 2) (2 0)) ((1 1) (0 6)) ((2 1) (1 0)))
  (non-orig (privk p))
  (uniq-gen id s)
  (operation encryption-test (added-listener (cat s id id))
    (hash s id id) (1 0))
  (label 5)
  (parent 3)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k6">Item <a href="#t0">6</a>, Parent: <a href="#k5">5</a>, Child: <a href="#k7">7</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cred id id)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat cred id id)</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash cred id id)</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(hash cred id id)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc &quot;answer&quot; answer (hash cred id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; request enc_cookie (hash cred id id))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-success&quot; enc_cookie (hash cred id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-request&quot; cred (hash cred id id))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash cred id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash cred id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc cred (pubk p))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((enc_cookie enc_cookie) (cc id) (id id) (s cred) (cred cred) (request request) (answer answer) (p p))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>sbp 6</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (enc_cookie mesg) (answer id cred request data) (p name))
  (defstrand client 9 (enc_cookie enc_cookie) (cc id) (id id) (s cred)
    (cred cred) (request request) (answer answer) (p p))
  (deflistener (hash cred id id))
  (deflistener (cat cred id id))
  (precedes ((0 5) (2 0)) ((1 1) (0 6)) ((2 1) (1 0)))
  (non-orig (privk p))
  (uniq-gen id cred)
  (operation nonce-test (displaced 3 0 client 6) s (2 0)
    (enc s (pubk p)))
  (label 6)
  (parent 5)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k7">Item <a href="#t0">7</a>, Parent: <a href="#k6">6</a>, Child: <a href="#k8">8</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 291.524 412.464 243.207 484.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash cred id id)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(hash cred id id)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cred id id)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat cred id id)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash cred id id)</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(hash cred id id)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc &quot;answer&quot; answer (hash cred id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; request enc_cookie (hash cred id id))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-success&quot; enc_cookie (hash cred id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-request&quot; cred (hash cred id id))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash cred id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash cred id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc cred (pubk p))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((enc_cookie enc_cookie) (cc id) (id id) (s cred) (cred cred) (request request) (answer answer) (p p))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>sbp 7</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (enc_cookie mesg) (answer id cred request data) (p name))
  (defstrand client 9 (enc_cookie enc_cookie) (cc id) (id id) (s cred)
    (cred cred) (request request) (answer answer) (p p))
  (deflistener (hash cred id id))
  (deflistener (cat cred id id))
  (deflistener (hash cred id id))
  (precedes ((0 2) (3 0)) ((0 5) (2 0)) ((1 1) (0 6)) ((2 1) (1 0))
    ((3 1) (2 0)))
  (non-orig (privk p))
  (uniq-gen id cred)
  (operation nonce-test (added-listener (hash cred id id)) cred (2 0)
    (enc cred (pubk p)) (enc &quot;login-request&quot; cred (hash cred id id)))
  (label 7)
  (parent 6)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k8">Item <a href="#t0">8</a>, Parent: <a href="#k7">7</a>, Seen Child: <a href="#k6">6</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='564.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cred id id)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat cred id id)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.260 450.660 244.679 486.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash cred id id)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(hash cred id id)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cred id id)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(cat cred id id)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash cred id id)</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(hash cred id id)</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(enc &quot;answer&quot; answer (hash cred id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;request&quot; request enc_cookie (hash cred id id))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-success&quot; enc_cookie (hash cred id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-request&quot; cred (hash cred id id))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g><title>(enc id (hash cred id id))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g><title>(enc id (hash cred id id))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc cred (pubk p))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>id</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>id</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((enc_cookie enc_cookie) (cc id) (id id) (s cred) (cred cred) (request request) (answer answer) (p p))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>sbp 8</text>
  </svg></div>

<pre>(defskeleton sbp
  (vars (enc_cookie mesg) (answer id cred request data) (p name))
  (defstrand client 9 (enc_cookie enc_cookie) (cc id) (id id) (s cred)
    (cred cred) (request request) (answer answer) (p p))
  (deflistener (hash cred id id))
  (deflistener (cat cred id id))
  (deflistener (hash cred id id))
  (deflistener (cat cred id id))
  (precedes ((0 2) (4 0)) ((0 5) (2 0)) ((1 1) (0 6)) ((2 1) (1 0))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (privk p))
  (uniq-gen id cred)
  (operation encryption-test (added-listener (cat cred id id))
    (hash cred id id) (3 0))
  (label 8)
  (parent 7)
  (seen 6)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

</body>
</html>
